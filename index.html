<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Cynote</title>
  <meta name="author" content="张端风">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Cynote"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Cynote</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header">
  <h1>Learn what I touched.</h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">
      <i class="fa fa-heart"></i>
      undefined
</div>    
		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2016-02-15 </div>
			<div class="article-title"><a href="/2016/02/15/C/WordLadder/" >LeetCode127——WordLadder题解</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="u9898_u76EE"><a href="#u9898_u76EE" class="headerlink" title="题目"></a>题目</h3><p>&#160;&#160; &#160; &#160; 春招开始，目前整个实验室都在刷LeetCode，讨论题解好不热闹，我也趁机复习一下。下面见题：<br>
	
	</div>
  <a type="button" href="/2016/02/15/C/WordLadder/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-12-30 </div>
			<div class="article-title"><a href="/2015/12/30/Linux/Gentoo-Troubleshooting/" >A branch of Gentoo troubleshooting</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="1-_emerge_can_u2019t_work__3AChecking_whether_the_C_compiler_works_u2026_no"><a href="#1-_emerge_can_u2019t_work__3AChecking_whether_the_C_compiler_works_u2026_no" class="headerlink" title="1. emerge can’t work :Checking whether the C compiler works… no"></a>1. emerge can’t work :Checking whether the C compiler works… no</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># gcc-config -l</span></span><br><span class="line">root <span class="comment"># gcc-config 1</span></span><br></pre></td></tr></table></figure>
<h3 id="2-_How_to_screenshoot_on_xfce4"><a href="#2-_How_to_screenshoot_on_xfce4" class="headerlink" title="2. How to screenshoot on xfce4"></a>2. How to screenshoot on xfce4</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge xfce4-screenshooter</span></span><br></pre></td></tr></table></figure>
<h3 id="3-_Dual_boot_gentoo_and_windows"><a href="#3-_Dual_boot_gentoo_and_windows" class="headerlink" title="3. Dual boot gentoo and windows"></a>3. Dual boot gentoo and windows</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge os-prober</span></span><br><span class="line">root <span class="comment"># grub2-install /dev/sda</span></span><br><span class="line">root <span class="comment"># grub2-mkconfig -o /boot/grub/grub.cfg</span></span><br></pre></td></tr></table></figure>
<h3 id="4-_Laptop__3A_Powermanager_2C_Volumn_2C_Brightness"><a href="#4-_Laptop__3A_Powermanager_2C_Volumn_2C_Brightness" class="headerlink" title="4. Laptop : Powermanager, Volumn, Brightness"></a>4. Laptop : Powermanager, Volumn, Brightness</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge laptop-mode-tools</span></span><br><span class="line">root <span class="comment"># rc-update add laptop_mode default</span></span><br><span class="line">root <span class="comment"># emerge xfce4-power-manager</span></span><br></pre></td></tr></table></figure>
<h3 id="5-_error_3A_generated/bounds-h_when_emerging_VirtualBox"><a href="#5-_error_3A_generated/bounds-h_when_emerging_VirtualBox" class="headerlink" title="5. error: generated/bounds.h when emerging VirtualBox"></a>5. error: generated/bounds.h when emerging VirtualBox</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># cd /usr/src/linux</span></span><br><span class="line">root <span class="comment"># make modules_prepare</span></span><br></pre></td></tr></table></figure>
<h3 id="6-_Necessary_applications_list"><a href="#6-_Necessary_applications_list" class="headerlink" title="6. Necessary applications list"></a>6. Necessary applications list</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">euse -E vlc networkmanager alsa&#10;emerge --autounmask-write \&#10;x11-misc/slim xf86-video-intel xf86-video-vesa xorg-drivers xorg-x11 \&#10;greybird xfce4-meta xfce4-notifyd xfce4-panel xfce4-terminal xfce4-screenshooter xfce4-battery-plugin xfce4-power-manager xfce4-mixer xfce4-appfinder xfce4-archive-plugin xfce-extra/tumbler thunar-volman\&#10;thunderbird firefox google-chrome dhcp net-misc/networkmanager nm-applet opera\&#10;smplayer alsa-utils rhythmbox adobe-flash media-gfx/mirage\&#10;virtualbox virtualbox-guest-additions wine \&#10;wps-office media-fonts/symbola libreoffice gedit fcitx wqy-zenhei sunpinyin \&#10;compiz fusion-icon emerald compiz-plugins-main compiz-plugins-extra \&#10;htop sudo screenfetch pciutils gentoolkit laptop-mode-tools bumblebee</span><br></pre></td></tr></table></figure>
<h3 id="7-_Chinese_fonts"><a href="#7-_Chinese_fonts" class="headerlink" title="7. Chinese fonts"></a>7. Chinese fonts</h3><p>First, configure the /etc/locale.gen<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">en_US ISO-8859-1&#10;en_US.UTF-8 UTF-8&#10;zh_CN GB18030&#10;zh_CN.GBK GBK&#10;zh_CN.GB2312 GB2312&#10;zh_CN.UTF-8 UTF-8</span><br></pre></td></tr></table></figure></p>
<p>Then, install the Chinese fonts and refresh profile<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge wqy-zenhei #正黑</span></span><br><span class="line">root <span class="comment"># env-update &amp;&amp; source /etc/profile</span></span><br></pre></td></tr></table></figure></p>
<h3 id="8-_Inatll_OS_X_theme"><a href="#8-_Inatll_OS_X_theme" class="headerlink" title="8. Inatll OS X theme"></a>8. Inatll OS X theme</h3><p>First download the Gnome Cupertino file, which is available at gnome-look.org. Then unpackage it and copy it to /usr/share/themes/ rather than user’s home.<br>After installation, open apperence and activate the Gnome-Cupertino theme. But after you activate the theme, the window frame remains the same. To fix this we need <code>dconf</code> - the Configurator system files tools.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge dconf dconf-editor</span></span><br></pre></td></tr></table></figure></p>
<p>After installation, launch the <code>dconf-editor</code>, go to the following address: <strong>org/gnome/desktop/wm/preferences</strong> and in the line theme, change the name of the theme on <code>Gnome-Cupertino</code>.<br>Now the window frames should vary according to the installed and activated the theme <strong>Gnome Cupertino</strong>. If not, open the apperance and reactivate <strong>Gnome Cupertino</strong>.</p>
<h3 id="9-Session_and_StartUp_for_Compiz_can_u2019t_work"><a href="#9-Session_and_StartUp_for_Compiz_can_u2019t_work" class="headerlink" title="9.Session and StartUp for Compiz can’t work"></a>9.Session and StartUp for <strong>Compiz</strong> can’t work</h3><p>Admittedly, <strong>compiz</strong> should be started after X and xfce4 completely initialization. We can delay the startup of compiz for 1s by using <code>sleep 1</code>, otherwise compiz wouldn’t work.<br>Following is the script for compiz startup placed at ~/.start-compiz.sh, which needs to be add to <code>Session and Startup</code> list.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line">sleep <span class="number">1</span></span><br><span class="line">compiz --replace --sm-disable --ignore-desktop-hints ccp &amp;</span><br><span class="line">emerald --replace &amp;</span><br></pre></td></tr></table></figure></p>
<h3 id="10-_alsa_cannot_find_control_device"><a href="#10-_alsa_cannot_find_control_device" class="headerlink" title="10. alsa cannot find control device"></a>10. alsa cannot find control device</h3><p>We need to set codec for alsa<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Device Drivers  ---&#62;&#10;  &#60;*&#62; Sound card support  ---&#62;&#10;    &#60;*&#62;   Advanced Linux Sound Architecture  ---&#62;  &#10;      HD-Audio  ---&#62;&#10;        &#60;*&#62; HD Audio PCI                                                             &#9474; &#9474;  &#10;  &#9474; &#9474;       (64) Pre-allocated buffer size for HD-audio driver                           &#9474; &#9474;  &#10;  &#9474; &#9474;       [*] Build hwdep interface for HD-audio driver                                &#9474; &#9474;  &#10;  &#9474; &#9474;       -*- Allow dynamic codec reconfiguration                                      &#9474; &#9474;  &#10;  &#9474; &#9474;       [*] Support digital beep via input layer                                     &#9474; &#9474;  &#10;  &#9474; &#9474;       (1)   Digital beep registration mode (0=off, 1=on)                           &#9474; &#9474;  &#10;  &#9474; &#9474;       [*] Support jack plugging notification via input layer                       &#9474; &#9474;  &#10;  &#9474; &#9474;       [*] Support initialization patch loading for HD-audio                        &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build Realtek HD-audio codec support                                     &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build Analog Device HD-audio codec support                               &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build IDT/Sigmatel HD-audio codec support                                &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build VIA HD-audio codec support                                         &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build HDMI/DisplayPort HD-audio codec support                            &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build Cirrus Logic codec support                                         &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build Conexant HD-audio codec support                                    &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build Creative CA0110-IBG codec support                                  &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build Creative CA0132 codec support                                      &#9474; &#9474;  &#10;  &#9474; &#9474;       [*]   Support new DSP code for CA0132 codec                                  &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build C-Media HD-audio codec support                                     &#9474; &#9474;  &#10;  &#9474; &#9474;       &#60;*&#62; Build Silicon Labs 3054 HD-modem codec support                           &#9474; &#9474;  &#10;  &#9474; &#9474;       -*- Enable generic HD-audio codec parser                                     &#9474; &#9474;  &#10;  &#9474; &#9474;       (0) Default time-out for HD-audio power-save mode</span><br></pre></td></tr></table></figure></p>
<h3 id="10-_VirtualBox_kernel_is_not_runnint"><a href="#10-_VirtualBox_kernel_is_not_runnint" class="headerlink" title="10. VirtualBox kernel is not runnint"></a>10. VirtualBox kernel is not runnint</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root #modprobe vboxdrv&#10;root #modprobe vboxnetadp&#10;root #modprobe vboxnetflt</span><br></pre></td></tr></table></figure>
<h3 id="11-_Themes_3A_Apperance_Icons_Fonts"><a href="#11-_Themes_3A_Apperance_Icons_Fonts" class="headerlink" title="11. Themes: Apperance Icons Fonts"></a>11. Themes: Apperance Icons Fonts</h3><p>Theme: GreyBird<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge greybird</span></span><br></pre></td></tr></table></figure></p>
<p>Icons: Yosemite Osx xfce, the package of which is in my BaiduCloud. Download it and unpackage it to <code>/usr/share/icons/</code><br>Fonts: URW Gothic L Book</p>
<h3 id="12-Run_command_as_login_shell"><a href="#12-Run_command_as_login_shell" class="headerlink" title="12.Run command as login shell"></a>12.Run command as login shell</h3><p>Preferences -&gt; General<br>Active <code>Run command as login shell</code></p>

	
	</div>
  <a type="button" href="/2015/12/30/Linux/Gentoo-Troubleshooting/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-12-30 </div>
			<div class="article-title"><a href="/2015/12/30/Journals/20151230_log/" ></a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="ThunderBird_u4E2D_u6587_u6392_u7248_u8BBE_u7F6E"><a href="#ThunderBird_u4E2D_u6587_u6392_u7248_u8BBE_u7F6E" class="headerlink" title="ThunderBird中文排版设置"></a>ThunderBird中文排版设置</h3><p>默认的ThunderBird排版设置不适合中文邮件，我们在ThunderBird按照缩进等排好版后发送，接收方看到的确实无缩进，断行错乱的邮件。导致该问题的主要问题是中文字体和发送格式，下面是正确的配置方法。</p>
<p>1.修改发送邮件编码集<br>Edit -&gt; Preferences -&gt; Advanced -&gt; -General -&gt; Config Editor<br>搜索：mailnews.send_default_charset,并修改为UTF-8</p>
<p><img src="/home/cyno/Pictures/Blog/Screenshot_2015-12-30_13-34-07.png" alt="image"></p>
<p>2.字体改成中文，例如文泉雅黑<br>Edit -&gt; Preferences -&gt; Composition -&gt; General<br>Font : WenQuanYiZen Hei Sharp</p>
<p>3.设置排版形式<br>Edit -&gt; Preferences -&gt; Composition -&gt; General -&gt; Send Options<br>Text Format: Send the message in both plain text and HTML</p>
<hr>
<h3 id="u6536_u4FE1_u9891_u7387"><a href="#u6536_u4FE1_u9891_u7387" class="headerlink" title="收信频率"></a>收信频率</h3><ol>
<li>Edit -&gt; Account Settings -&gt; Server Settings<br>Check for new messages every 1 minutes<br>默认是10分钟检查一次，改成1分钟</li>
</ol>
<h3 id="u6700_u5C0F_u5316_u5230_u6258_u76D8"><a href="#u6700_u5C0F_u5316_u5230_u6258_u76D8" class="headerlink" title="最小化到托盘"></a>最小化到托盘</h3><ol>
<li>Tools -&gt; Add-Ons -&gt; Get Add-ons<br>搜索： MinTray,点击下载就好，Mozilla系列的插件全部要翻墙下载，翻墙的设置选项在<br>Edit -&gt; Preferences -&gt; Advanced -&gt; Network<br>里，翻墙方法自理。</li>
</ol>
<hr>
<h3 id="VirtualBox_Host/Guest__u5171_u4EAB_u526A_u5207_u7248"><a href="#VirtualBox_Host/Guest__u5171_u4EAB_u526A_u5207_u7248" class="headerlink" title="VirtualBox Host/Guest 共享剪切版"></a>VirtualBox Host/Guest 共享剪切版</h3><p>常规高级里共享粘贴板已经选中双向，但还是不能复制粘贴，因为没有设置使用主机I/O缓存，方法如下：</p>
<p>1.Machine Setting -&gt; Storage -&gt; Storage Tree<br>点击Controller，右面会出现Attributes属性，勾选<code>Use Host I/0 Cache</code></p>
<p>2.Storage Tree下单击虚拟机的硬盘(即vdi文件),比如<code>win_10.vdi</code>.勾选右面Attributes里<code>Solid-state Drive</code>选项.</p>
<p>3.重启生效</p>

	
	</div>
  <a type="button" href="/2015/12/30/Journals/20151230_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-12-24 </div>
			<div class="article-title"><a href="/2015/12/24/Linux/Introduction_To_Linux/" ></a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		
	
	</div>
  <a type="button" href="/2015/12/24/Linux/Introduction_To_Linux/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-12-10 </div>
			<div class="article-title"><a href="/2015/12/10/Linux/Gentoo_Backup_Strategy/" >Gentoo Backup Strategy</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h4 id="1-Apps"><a href="#1-Apps" class="headerlink" title="1.Apps"></a>1.Apps</h4><p>Some essential applications which I need<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x11-misc/lxdm xf86-video-intel xf86-video-vesa xorg-x11 \</span><br><span class="line">greybird xfce4-meta xfce4-notifyd xfce4-panel xfce4-terminal xfce4-screenshooter xfce4-battery-plugin xfce4-power-manager xfce4-mixer xfce4-appfinder xfce4-archive-plugin xfce-extra/tumbler thunar-volman xfce4-weather-plugin \</span><br><span class="line">thunderbird firefox google-chrome opera \</span><br><span class="line">dhcp net-misc/networkmanager nm-applet \</span><br><span class="line">smplayer alsa-utils adobe-flash media-gfx/mirage \</span><br><span class="line">virtualbox-bin virtualbox-guest-additions \</span><br><span class="line">wps-office media-fonts/symbola libreoffice gvim gedit fcitx wqy-zenhei sunpinyin \</span><br><span class="line">compiz fusion-icon emerald compiz-plugins-main compiz-plugins-extra \</span><br><span class="line">htop sudo screenfetch pciutils gentoolkit laptop-mode-tools \</span><br><span class="line">dev-util/idea-community virtual/jdk \</span><br><span class="line">net-misc/megatools</span><br></pre></td></tr></table></figure></p>
<p>The command to install them all:</p>
<pre><code class="bash">
</code></pre>
<h4 id="2-Desktop_Preference"><a href="#2-Desktop_Preference" class="headerlink" title="2.Desktop Preference"></a>2.Desktop Preference</h4><ul>
<li>2.1 Compiz configuration</li>
<li>2.2 Background</li>
<li>2.3 Theme</li>
<li>2.4 Fonts</li>
</ul>
<h4 id="3-Web_Browser_Preference"><a href="#3-Web_Browser_Preference" class="headerlink" title="3.Web Browser Preference"></a>3.Web Browser Preference</h4><ul>
<li>3.1 BookMarks of Firefox &amp; Chrome</li>
<li>3.2 Ad-block</li>
</ul>
<h4 id="4-Bin_2CDocument_2CData_2CWorkspace_2CTools"><a href="#4-Bin_2CDocument_2CData_2CWorkspace_2CTools" class="headerlink" title="4.Bin,Document,Data,Workspace,Tools"></a>4.Bin,Document,Data,Workspace,Tools</h4><h4 id="5-DevTools_Preference"><a href="#5-DevTools_Preference" class="headerlink" title="5.DevTools Preference"></a>5.DevTools Preference</h4><ul>
<li>5.1 vim</li>
<li>5.2 IDEA</li>
<li>5.3 Shadowsocks</li>
</ul>
<h4 id="6-Blog"><a href="#6-Blog" class="headerlink" title="6.Blog"></a>6.Blog</h4><ul>
<li>6.1 The content sources</li>
<li>6.2 Themes</li>
</ul>
<h4 id="7-Some_specific_developed_tools"><a href="#7-Some_specific_developed_tools" class="headerlink" title="7.Some specific developed tools"></a>7.Some specific developed tools</h4><ul>
<li>7.1 Shadowsocks</li>
<li>7.2 Win10 on the VirtualBox</li>
<li>7.3 Atom editor</li>
<li>7.4 WPS Office</li>
<li>7.5 Hadoop</li>
<li>7.6 suder preference</li>
</ul>

	
	</div>
  <a type="button" href="/2015/12/10/Linux/Gentoo_Backup_Strategy/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-12-09 </div>
			<div class="article-title"><a href="/2015/12/09/Journals/20151209_log/" >Log_2015-12-09 -- Xunlei on Gentoo</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>Xunlei has not provide package for Linux users offically, while it provide a remote download client called <code>xware</code> that is for family router and TV box. This client provided by Xunlei has various version mainly containing ARM and Linux, which we install on Linux.</p>
<ul>
<li><ol>
<li>Download <code>xware</code> package, this is the most stable version.<br><strong>Xware1.0.31_x86_32_glibc.zip</strong></li>
</ol>
</li>
<li><ol>
<li>Unpack it and you will see<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cfg  </span><br><span class="line">lib  </span><br><span class="line">nohup.out  </span><br><span class="line">portal  </span><br><span class="line">Xware1.<span class="number">0.31</span>_x86_32_glibc.zip</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><ol>
<li>Launch it and remember the ID code<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./portal</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><ol>
<li>Open “yuancheng.xunlei.com” at your browser, login in and fill the code in. enjoy it.</li>
</ol>
</li>
</ul>

	
	</div>
  <a type="button" href="/2015/12/09/Journals/20151209_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-12-04 </div>
			<div class="article-title"><a href="/2015/12/04/Journals/20151204_log/" >Log_2015-12-04 -- Java_VF2</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="1-Graph"><a href="#1-Graph" class="headerlink" title="1.Graph"></a>1.Graph</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> wip.VF2.graph;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.Label;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Graph Class, along with some methods to manipulate the graph.</span><br><span class="line"> * <span class="doctag">@author</span> luo123n</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Graph</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String name; <span class="comment">// name of the graph</span></span><br><span class="line">	<span class="keyword">public</span> ArrayList&lt;Node&gt; nodes = <span class="keyword">new</span> ArrayList&lt;Node&gt;(); <span class="comment">// list of all nodes</span></span><br><span class="line">	<span class="keyword">public</span> ArrayList&lt;Edge&gt; edges = <span class="keyword">new</span> ArrayList&lt;Edge&gt;(); <span class="comment">// list of all edges</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span>[][] adjacencyMatrix; <span class="comment">// stores graph structure as adjacency matrix (-1: not adjacent, &gt;=0: the edge label)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> adjacencyMatrixUpdateNeeded = <span class="keyword">true</span>; <span class="comment">// indicates if the adjacency matrix needs an update</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Graph</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> label)</span> </span>&#123;</span><br><span class="line">		nodes.add(<span class="keyword">new</span> Node(<span class="keyword">this</span>, id, label));</span><br><span class="line">		<span class="keyword">this</span>.adjacencyMatrixUpdateNeeded = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(Node source, Node target, <span class="keyword">int</span> label)</span> </span>&#123;</span><br><span class="line">		edges.add(<span class="keyword">new</span> Edge(<span class="keyword">this</span>, source, target, label));</span><br><span class="line">		<span class="keyword">this</span>.adjacencyMatrixUpdateNeeded = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> sourceId, <span class="keyword">int</span> targetId, <span class="keyword">int</span> label)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.addEdge(<span class="keyword">this</span>.nodes.get(sourceId), <span class="keyword">this</span>.nodes.get(targetId), label);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Get the adjacency matrix</span><br><span class="line">	 * Reconstruct it if it needs an update</span><br><span class="line">	 * <span class="doctag">@return</span> Adjacency Matrix</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[][] getAdjacencyMatrix() &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.adjacencyMatrixUpdateNeeded) &#123;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> k = <span class="keyword">this</span>.nodes.size();</span><br><span class="line">			<span class="keyword">this</span>.adjacencyMatrix = <span class="keyword">new</span> <span class="keyword">int</span>[k][k];	<span class="comment">// node size may have changed</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; k ; i++)			<span class="comment">// initialize entries to -1</span></span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; k ; j++)</span><br><span class="line">					<span class="keyword">this</span>.adjacencyMatrix[i][j] = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> (Edge e : <span class="keyword">this</span>.edges) &#123;</span><br><span class="line">				<span class="keyword">this</span>.adjacencyMatrix[e.source.id][e.target.id] = e.label; <span class="comment">// label must bigger than -1</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.adjacencyMatrixUpdateNeeded = <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.adjacencyMatrix;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// prints adjacency matrix to console</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printGraph</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[][] a = <span class="keyword">this</span>.getAdjacencyMatrix();</span><br><span class="line">		<span class="keyword">int</span> k = a.length;</span><br><span class="line"></span><br><span class="line">		System.out.print(<span class="keyword">this</span>.name + <span class="string">" - Nodes: "</span>);</span><br><span class="line">		<span class="keyword">for</span> (Node n : nodes) System.out.print(n.id + <span class="string">" "</span>);</span><br><span class="line">		System.out.println();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; k ; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span> ; j &lt; k ; j++) &#123;</span><br><span class="line">				System.out.print(a[i][j] + <span class="string">" "</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-state"><a href="#2-state" class="headerlink" title="2.state"></a>2.state</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> wip.VF2.core;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> wip.VF2.graph.Edge;</span><br><span class="line"><span class="keyword">import</span> wip.VF2.graph.Graph;</span><br><span class="line"><span class="keyword">import</span> wip.VF2.graph.Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">State</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[] core_1; <span class="comment">// stores for each target graph node to which query graph node it maps ("-1" indicates no mapping)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[] core_2; <span class="comment">// stores for each query graph node to which target graph node it maps ("-1" indicates no mapping)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[] in_1; 	<span class="comment">// stores for each target graph node the depth in the search tree at which it entered "T_1 in" or the mapping ("-1" indicates that the node is not part of the set)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[] in_2; 	<span class="comment">// stores for each query graph node the depth in the search tree at which it entered "T_2 in" or the mapping ("-1" indicates that the node is not part of the set)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[] out_1; <span class="comment">// stores for each target graph node the depth in the search tree at which it entered "T_1 out" or the mapping ("-1" indicates that the node is not part of the set)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[] out_2; <span class="comment">// stores for each query graph node the depth in the search tree at which it entered "T_2 out" or the mapping ("-1" indicates that the node is not part of the set)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> HashSet&lt;Integer&gt; T1in;	<span class="comment">// nodes that not yet in the partial mapping, that are the destination of branches start from target graph</span></span><br><span class="line">	<span class="keyword">public</span> HashSet&lt;Integer&gt; T1out;	<span class="comment">// nodes that not yet in the partial mapping, that are the origin of branches end into target graph</span></span><br><span class="line">	<span class="keyword">public</span> HashSet&lt;Integer&gt; T2in;	<span class="comment">// nodes that not yet in the partial mapping, that are the destination of branches start from query graph</span></span><br><span class="line">	<span class="keyword">public</span> HashSet&lt;Integer&gt; T2out;	<span class="comment">// nodes that not yet in the partial mapping, that are the origin of branches end into query graph</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> HashSet&lt;Integer&gt; unmapped1;	<span class="comment">// unmapped nodes in target graph</span></span><br><span class="line">	<span class="keyword">public</span> HashSet&lt;Integer&gt; unmapped2;	<span class="comment">// unmapped nodes in query graph</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> depth = <span class="number">0</span>; <span class="comment">// current depth of the search tree</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> matched = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Graph targetGraph;</span><br><span class="line">	<span class="keyword">public</span> Graph queryGraph;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Initialize a State</span><br><span class="line">	 * <span class="doctag">@param</span> targetGraph	The big graph</span><br><span class="line">	 * <span class="doctag">@param</span> queryGraph	The small graph</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">State</span><span class="params">(Graph targetGraph, Graph queryGraph)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">this</span>.targetGraph = targetGraph;</span><br><span class="line">		<span class="keyword">this</span>.queryGraph = queryGraph;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> targetSize = targetGraph.nodes.size();</span><br><span class="line">		<span class="keyword">int</span> querySize = queryGraph.nodes.size();</span><br><span class="line"></span><br><span class="line">		T1in = <span class="keyword">new</span> HashSet&lt;Integer&gt;(targetSize * <span class="number">2</span>);</span><br><span class="line">		T1out = <span class="keyword">new</span> HashSet&lt;Integer&gt;(targetSize * <span class="number">2</span>);</span><br><span class="line">		T2in = <span class="keyword">new</span> HashSet&lt;Integer&gt;(querySize * <span class="number">2</span>);</span><br><span class="line">		T2out = <span class="keyword">new</span> HashSet&lt;Integer&gt;(querySize * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">		unmapped1 = <span class="keyword">new</span> HashSet&lt;Integer&gt;(targetSize * <span class="number">2</span>);</span><br><span class="line">		unmapped2 = <span class="keyword">new</span> HashSet&lt;Integer&gt;(querySize * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">		core_1 = <span class="keyword">new</span> <span class="keyword">int</span>[targetSize];</span><br><span class="line">		core_2 = <span class="keyword">new</span> <span class="keyword">int</span>[querySize];</span><br><span class="line"></span><br><span class="line">		in_1 = <span class="keyword">new</span> <span class="keyword">int</span>[targetSize];</span><br><span class="line">		in_2 = <span class="keyword">new</span> <span class="keyword">int</span>[querySize];</span><br><span class="line">		out_1 = <span class="keyword">new</span> <span class="keyword">int</span>[targetSize];</span><br><span class="line">		out_2 = <span class="keyword">new</span> <span class="keyword">int</span>[querySize];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// initialize values ("-1" means no mapping / not contained in the set)</span></span><br><span class="line">		<span class="comment">// initially, all sets are empty and no nodes are mapped</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; targetSize ; i++) &#123;</span><br><span class="line">			core_1[i] = -<span class="number">1</span>;</span><br><span class="line">			in_1[i] = -<span class="number">1</span>;</span><br><span class="line">			out_1[i] = -<span class="number">1</span>;</span><br><span class="line">			unmapped1.add(i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; querySize ; i++) &#123;</span><br><span class="line">			core_2[i] = -<span class="number">1</span>;</span><br><span class="line">			in_2[i] = -<span class="number">1</span>;</span><br><span class="line">			out_2[i] = -<span class="number">1</span>;</span><br><span class="line">			unmapped2.add(i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inM1</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (core_1[nodeId] &gt; -<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inM2</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (core_2[nodeId] &gt; -<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inT1in</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ((core_1[nodeId] == -<span class="number">1</span>) &amp;&amp; (in_1[nodeId] &gt; -<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inT2in</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ((core_2[nodeId] == -<span class="number">1</span>) &amp;&amp; (in_2[nodeId] &gt; -<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inT1out</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ((core_1[nodeId] == -<span class="number">1</span>) &amp;&amp; (out_1[nodeId] &gt; -<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inT2out</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ((core_2[nodeId] == -<span class="number">1</span>) &amp;&amp; (out_2[nodeId] &gt; -<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inT1</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (<span class="keyword">this</span>.inT1in(nodeId) || <span class="keyword">this</span>.inT1out(nodeId));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inT2</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (<span class="keyword">this</span>.inT2in(nodeId) || <span class="keyword">this</span>.inT2out(nodeId));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inN1Tilde</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ((core_1[nodeId] == -<span class="number">1</span>) &amp;&amp; (in_1[nodeId] == -<span class="number">1</span>) &amp;&amp; (out_1[nodeId] == -<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Boolean <span class="title">inN2Tilde</span><span class="params">(<span class="keyword">int</span> nodeId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ((core_2[nodeId] == -<span class="number">1</span>) &amp;&amp; (in_2[nodeId] == -<span class="number">1</span>) &amp;&amp; (out_2[nodeId] == -<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Add a new match (targetIndex, queryIndex) to the state</span><br><span class="line">	 * <span class="doctag">@param</span> targetIndex	Index of the node in target graph</span><br><span class="line">	 * <span class="doctag">@param</span> queryIndex	Index of the node in query graph</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">extendMatch</span><span class="params">(<span class="keyword">int</span> targetIndex, <span class="keyword">int</span> queryIndex)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		core_1[targetIndex] = queryIndex;</span><br><span class="line">		core_2[queryIndex] = targetIndex;</span><br><span class="line">		unmapped1.remove(targetIndex);</span><br><span class="line">		unmapped2.remove(queryIndex);</span><br><span class="line">		T1in.remove(targetIndex);</span><br><span class="line">		T1out.remove(targetIndex);</span><br><span class="line">		T2in.remove(queryIndex);</span><br><span class="line">		T2out.remove(queryIndex);</span><br><span class="line"></span><br><span class="line">		depth++;	<span class="comment">// move down one level in the search tree</span></span><br><span class="line"></span><br><span class="line">		Node targetNode = targetGraph.nodes.get(targetIndex);</span><br><span class="line">		Node queryNode = queryGraph.nodes.get(queryIndex);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.inEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (in_1[e.source.id] == -<span class="number">1</span>)&#123;	<span class="comment">// if the note is not in T1in or mapping</span></span><br><span class="line">				in_1[e.source.id] = depth;</span><br><span class="line">				<span class="keyword">if</span> (!inM1(e.source.id))		<span class="comment">// if not in M1, add into T1in</span></span><br><span class="line">					T1in.add(e.source.id);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.outEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (out_1[e.target.id] == -<span class="number">1</span>)&#123;	<span class="comment">// if the note is not in T1out or mapping</span></span><br><span class="line">				out_1[e.target.id] = depth;</span><br><span class="line">				<span class="keyword">if</span> (!inM1(e.target.id))		<span class="comment">// if not in M1, add into T1out</span></span><br><span class="line">					T1out.add(e.target.id);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.inEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (in_2[e.source.id] == -<span class="number">1</span>)&#123;	<span class="comment">// if the note is not in T2in or mapping</span></span><br><span class="line">				in_2[e.source.id] = depth;</span><br><span class="line">				<span class="keyword">if</span> (!inM2(e.source.id))		<span class="comment">// if not in M1, add into T2in</span></span><br><span class="line">					T2in.add(e.source.id);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.outEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (out_2[e.target.id] == -<span class="number">1</span>)&#123;	<span class="comment">// if the note is not in T2out or mapping</span></span><br><span class="line">				out_2[e.target.id] = depth;</span><br><span class="line">				<span class="keyword">if</span> (!inM2(e.target.id))		<span class="comment">// if not in M1, add into T2out</span></span><br><span class="line">					T2out.add(e.target.id);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Remove the match of (targetNodeIndex, queryNodeIndex) for backtrack</span><br><span class="line">	 * <span class="doctag">@param</span> targetNodeIndex</span><br><span class="line">	 * <span class="doctag">@param</span> queryNodeIndex</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backtrack</span><span class="params">(<span class="keyword">int</span> targetNodeIndex, <span class="keyword">int</span> queryNodeIndex)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		core_1[targetNodeIndex] = -<span class="number">1</span>;</span><br><span class="line">		core_2[queryNodeIndex] = -<span class="number">1</span>;</span><br><span class="line">		unmapped1.add(targetNodeIndex);</span><br><span class="line">		unmapped2.add(queryNodeIndex);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; core_1.length ; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (in_1[i] == depth) &#123;</span><br><span class="line">				in_1[i] = -<span class="number">1</span>;</span><br><span class="line">				T1in.remove(i);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (out_1[i] == depth) &#123;</span><br><span class="line">				out_1[i] = -<span class="number">1</span>;</span><br><span class="line">				T1out.remove(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; core_2.length ; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (in_2[i] == depth) &#123;</span><br><span class="line">				in_2[i] = -<span class="number">1</span>;</span><br><span class="line">				T2in.remove(i);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (out_2[i] == depth) &#123;</span><br><span class="line">				out_2[i] = -<span class="number">1</span>;</span><br><span class="line">				T2out.remove(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// put targetNodeIndex and queryNodeIndex back into Tin and Tout sets if necessary</span></span><br><span class="line">		<span class="keyword">if</span> (inT1in(targetNodeIndex))</span><br><span class="line">			T1in.add(targetNodeIndex);</span><br><span class="line">		<span class="keyword">if</span> (inT1out(targetNodeIndex))</span><br><span class="line">			T1out.add(targetNodeIndex);</span><br><span class="line">		<span class="keyword">if</span> (inT2in(queryNodeIndex))</span><br><span class="line">			T2in.add(queryNodeIndex);</span><br><span class="line">		<span class="keyword">if</span> (inT2out(queryNodeIndex))</span><br><span class="line">			T2out.add(queryNodeIndex);</span><br><span class="line"></span><br><span class="line">		depth--;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Print the current mapping</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printMapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; core_2.length ; i++) &#123;</span><br><span class="line">			System.out.print(<span class="string">"("</span> + core_2[i] + <span class="string">"-"</span> + i + <span class="string">") "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Write state to file</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeMapping</span><span class="params">(PrintWriter writer)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; core_2.length ; i++) &#123;</span><br><span class="line">			writer.write(<span class="string">"("</span> + core_2[i] + <span class="string">"-"</span> + i + <span class="string">") "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		writer.write(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-VF2"><a href="#3-VF2" class="headerlink" title="3.VF2"></a>3.VF2</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> wip.VF2.core;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.omg.CORBA.INTERNAL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> wip.VF2.graph.Edge;</span><br><span class="line"><span class="keyword">import</span> wip.VF2.graph.Graph;</span><br><span class="line"><span class="keyword">import</span> wip.VF2.graph.Node;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Core Class of VF2 Algorithm</span><br><span class="line"> * <span class="doctag">@author</span> luo123n</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VF2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Find matches given a query graph and a set of target graphs</span><br><span class="line">	 * <span class="doctag">@param</span> graphSet		Target graph set</span><br><span class="line">	 * <span class="doctag">@param</span> queryGraph	Query graph</span><br><span class="line">	 * <span class="doctag">@return</span>				The state set containing the mappings</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;State&gt; <span class="title">matchGraphSetWithQuery</span><span class="params">(ArrayList&lt;Graph&gt; graphSet, Graph queryGraph)</span></span>&#123;</span><br><span class="line">		ArrayList&lt;State&gt; stateSet = <span class="keyword">new</span> ArrayList&lt;State&gt;();</span><br><span class="line">		<span class="keyword">for</span> (Graph targetGraph : graphSet)&#123;</span><br><span class="line">			State resState = matchGraphPair(targetGraph, queryGraph);</span><br><span class="line">			<span class="keyword">if</span> (resState.matched)&#123;</span><br><span class="line">				stateSet.add(resState);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> stateSet;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Figure out if the target graph contains query graph</span><br><span class="line">	 * <span class="doctag">@param</span> targetGraph	Big Graph</span><br><span class="line">	 * <span class="doctag">@param</span> queryGraph	Small Graph</span><br><span class="line">	 * <span class="doctag">@param</span> state			The state to store the result mapping</span><br><span class="line">	 * <span class="doctag">@return</span>				Match or not</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> State <span class="title">matchGraphPair</span><span class="params">(Graph targetGraph, Graph queryGraph)</span> </span>&#123;</span><br><span class="line">		State state = <span class="keyword">new</span> State(targetGraph, queryGraph);</span><br><span class="line"></span><br><span class="line">		matchRecursive(state, targetGraph, queryGraph);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> state;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Recursively figure out if the target graph contains query graph</span><br><span class="line">	 * <span class="doctag">@param</span> state			VF2 State</span><br><span class="line">	 * <span class="doctag">@param</span> targetGraph	Big Graph</span><br><span class="line">	 * <span class="doctag">@param</span> queryGraph	Small Graph</span><br><span class="line">	 * <span class="doctag">@return</span>	Match or not</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">matchRecursive</span><span class="params">(State state, Graph targetGraph, Graph queryGraph)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (state.depth == queryGraph.nodes.size())&#123;	<span class="comment">// Found a match</span></span><br><span class="line">			state.matched = <span class="keyword">true</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;	<span class="comment">// Extend the state</span></span><br><span class="line">			ArrayList&lt;Pair&lt;Integer,Integer&gt;&gt; candidatePairs = genCandidatePairs(state, targetGraph, queryGraph);</span><br><span class="line">			<span class="keyword">for</span> (Pair&lt;Integer, Integer&gt; entry : candidatePairs)&#123;</span><br><span class="line">				<span class="keyword">if</span> (checkFeasibility(state, entry.getKey(), entry.getValue()))&#123;</span><br><span class="line">					state.extendMatch(entry.getKey(), entry.getValue()); <span class="comment">// extend mapping</span></span><br><span class="line">					<span class="keyword">if</span> (matchRecursive(state, targetGraph, queryGraph))&#123;	<span class="comment">// Found a match</span></span><br><span class="line">						<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					state.backtrack(entry.getKey(), entry.getValue()); <span class="comment">// remove the match added before</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Generate all candidate pairs given current state</span><br><span class="line">	 * <span class="doctag">@param</span> state			VF2 State</span><br><span class="line">	 * <span class="doctag">@param</span> targetGraph	Big Graph</span><br><span class="line">	 * <span class="doctag">@param</span> queryGraph	Small Graph</span><br><span class="line">	 * <span class="doctag">@return</span>				Candidate Pairs</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> ArrayList&lt;Pair&lt;Integer,Integer&gt;&gt; genCandidatePairs(State state, Graph targetGraph, Graph queryGraph) &#123;</span><br><span class="line">		ArrayList&lt;Pair&lt;Integer,Integer&gt;&gt; pairList = <span class="keyword">new</span> ArrayList&lt;Pair&lt;Integer,Integer&gt;&gt;();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!state.T1out.isEmpty() &amp;&amp; !state.T2out.isEmpty())&#123;</span><br><span class="line">			<span class="comment">// Generate candidates from T1out and T2out if they are not empty</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// Faster Version</span></span><br><span class="line">			<span class="comment">// Since every node should be matched in query graph</span></span><br><span class="line">			<span class="comment">// Therefore we can only extend one node of query graph (with biggest id)</span></span><br><span class="line">			<span class="comment">// instead of generate the whole Cartesian product of the target and query</span></span><br><span class="line">			<span class="keyword">int</span> queryNodeIndex = -<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i : state.T2out) &#123;</span><br><span class="line">				queryNodeIndex = Math.max(i, queryNodeIndex);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i : state.T1out) &#123;</span><br><span class="line">				pairList.add(<span class="keyword">new</span> Pair&lt;Integer,Integer&gt;(i, queryNodeIndex));</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Slow Version</span></span><br><span class="line"><span class="comment">//			for (int i : state.T1out)&#123;</span></span><br><span class="line"><span class="comment">//				for (int j : state.T2out)&#123;</span></span><br><span class="line"><span class="comment">//					pairList.add(new Pair&lt;Integer,Integer&gt;(i, j));</span></span><br><span class="line"><span class="comment">//				&#125;</span></span><br><span class="line"><span class="comment">//			&#125;</span></span><br><span class="line">			<span class="keyword">return</span> pairList;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!state.T1in.isEmpty() &amp;&amp; !state.T2in.isEmpty())&#123;</span><br><span class="line">			<span class="comment">// Generate candidates from T1in and T2in if they are not empty</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// Faster Version</span></span><br><span class="line">			<span class="comment">// Since every node should be matched in query graph</span></span><br><span class="line">			<span class="comment">// Therefore we can only extend one node of query graph (with biggest id)</span></span><br><span class="line">			<span class="comment">// instead of generate the whole Cartesian product of the target and query</span></span><br><span class="line">			<span class="keyword">int</span> queryNodeIndex = -<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i : state.T2in) &#123;</span><br><span class="line">				queryNodeIndex = Math.max(i, queryNodeIndex);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i : state.T1in) &#123;</span><br><span class="line">				pairList.add(<span class="keyword">new</span> Pair&lt;Integer,Integer&gt;(i, queryNodeIndex));</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Slow Version</span></span><br><span class="line"><span class="comment">//			for (int i : state.T1in)&#123;</span></span><br><span class="line"><span class="comment">//				for (int j : state.T2in)&#123;</span></span><br><span class="line"><span class="comment">//					pairList.add(new Pair&lt;Integer,Integer&gt;(i, j));</span></span><br><span class="line"><span class="comment">//				&#125;</span></span><br><span class="line"><span class="comment">//			&#125;</span></span><br><span class="line">			<span class="keyword">return</span> pairList;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// Generate from all unmapped nodes</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// Faster Version</span></span><br><span class="line">			<span class="comment">// Since every node should be matched in query graph</span></span><br><span class="line">			<span class="comment">// Therefore we can only extend one node of query graph (with biggest id)</span></span><br><span class="line">			<span class="comment">// instead of generate the whole Cartesian product of the target and query</span></span><br><span class="line">			<span class="keyword">int</span> queryNodeIndex = -<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i : state.unmapped2) &#123;</span><br><span class="line">				queryNodeIndex = Math.max(i, queryNodeIndex);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i : state.unmapped1) &#123;</span><br><span class="line">				pairList.add(<span class="keyword">new</span> Pair&lt;Integer,Integer&gt;(i, queryNodeIndex));</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Slow Version</span></span><br><span class="line"><span class="comment">//			for (int i : state.unmapped1)&#123;</span></span><br><span class="line"><span class="comment">//				for (int j : state.unmapped2)&#123;</span></span><br><span class="line"><span class="comment">//					pairList.add(new Pair&lt;Integer,Integer&gt;(i, j));</span></span><br><span class="line"><span class="comment">//				&#125;</span></span><br><span class="line"><span class="comment">//			&#125;</span></span><br><span class="line">			<span class="keyword">return</span> pairList;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Check the feasibility of adding this match</span><br><span class="line">	 * <span class="doctag">@param</span> state				VF2 State</span><br><span class="line">	 * <span class="doctag">@param</span> targetNodeIndex	Target Graph Node Index</span><br><span class="line">	 * <span class="doctag">@param</span> queryNodeIndex	Query Graph Node Index</span><br><span class="line">	 * <span class="doctag">@return</span>					Feasible or not</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> Boolean <span class="title">checkFeasibility</span><span class="params">(State state , <span class="keyword">int</span> targetNodeIndex , <span class="keyword">int</span> queryNodeIndex)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// Node Label Rule</span></span><br><span class="line">		<span class="comment">// The two nodes must have the same label</span></span><br><span class="line">		<span class="keyword">if</span> (state.targetGraph.nodes.get(targetNodeIndex).label !=</span><br><span class="line">				state.queryGraph.nodes.get(queryNodeIndex).label)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Predecessor Rule and Successor Rule</span></span><br><span class="line">		<span class="keyword">if</span> (!checkPredAndSucc(state, targetNodeIndex, queryNodeIndex))&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// In Rule and Out Rule</span></span><br><span class="line">		<span class="keyword">if</span> (!checkInAndOut(state, targetNodeIndex, queryNodeIndex))&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// New Rule</span></span><br><span class="line">		<span class="keyword">if</span> (!checkNew(state, targetNodeIndex, queryNodeIndex))&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Check the predecessor rule and successor rule</span><br><span class="line">	 * It ensures the consistency of the partial matching</span><br><span class="line">	 * <span class="doctag">@param</span> state				VF2 State</span><br><span class="line">	 * <span class="doctag">@param</span> targetNodeIndex	Target Graph Node Index</span><br><span class="line">	 * <span class="doctag">@param</span> queryNodeIndex	Query Graph Node Index</span><br><span class="line">	 * <span class="doctag">@return</span>					Feasible or not</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> Boolean <span class="title">checkPredAndSucc</span><span class="params">(State state, <span class="keyword">int</span> targetNodeIndex , <span class="keyword">int</span> queryNodeIndex)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Node targetNode = state.targetGraph.nodes.get(targetNodeIndex);</span><br><span class="line">		Node queryNode = state.queryGraph.nodes.get(queryNodeIndex);</span><br><span class="line">		<span class="keyword">int</span>[][] targetAdjacency = state.targetGraph.getAdjacencyMatrix();</span><br><span class="line">		<span class="keyword">int</span>[][] queryAdjacency = state.queryGraph.getAdjacencyMatrix();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Predecessor Rule</span></span><br><span class="line">		<span class="comment">// For all mapped predecessors of the query node,</span></span><br><span class="line">		<span class="comment">// there must exist corresponding predecessors of target node.</span></span><br><span class="line">		<span class="comment">// Vice Versa</span></span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.inEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (state.core_1[e.source.id] &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (queryAdjacency[state.core_1[e.source.id]][queryNodeIndex] == -<span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// not such edge in target graph</span></span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (queryAdjacency[state.core_1[e.source.id]][queryNodeIndex] != e.label) &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// label doesn't match</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.inEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (state.core_2[e.source.id] &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (targetAdjacency[state.core_2[e.source.id]][targetNodeIndex] == -<span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// not such edge in target graph</span></span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (targetAdjacency[state.core_2[e.source.id]][targetNodeIndex] != e.label)&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// label doesn't match</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Successsor Rule</span></span><br><span class="line">		<span class="comment">// For all mapped successors of the query node,</span></span><br><span class="line">		<span class="comment">// there must exist corresponding successors of the target node</span></span><br><span class="line">		<span class="comment">// Vice Versa</span></span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.outEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (state.core_1[e.target.id] &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (queryAdjacency[queryNodeIndex][state.core_1[e.target.id]] == -<span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// not such edge in target graph</span></span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (queryAdjacency[queryNodeIndex][state.core_1[e.target.id]] != e.label) &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// label doesn't match</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.outEdges) &#123;</span><br><span class="line">			<span class="keyword">if</span> (state.core_2[e.target.id] &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (targetAdjacency[targetNodeIndex][state.core_2[e.target.id]] == -<span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// not such edge in target graph</span></span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> (targetAdjacency[targetNodeIndex][state.core_2[e.target.id]] != e.label) &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;	<span class="comment">// label doesn't match</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Check the in rule and out rule</span><br><span class="line">	 * This prunes the search tree using 1-look-ahead</span><br><span class="line">	 * <span class="doctag">@param</span> state				VF2 State</span><br><span class="line">	 * <span class="doctag">@param</span> targetNodeIndex	Target Graph Node Index</span><br><span class="line">	 * <span class="doctag">@param</span> queryNodeIndex	Query Graph Node Index</span><br><span class="line">	 * <span class="doctag">@return</span>					Feasible or not</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkInAndOut</span><span class="params">(State state, <span class="keyword">int</span> targetNodeIndex , <span class="keyword">int</span> queryNodeIndex)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Node targetNode = state.targetGraph.nodes.get(targetNodeIndex);</span><br><span class="line">		Node queryNode = state.queryGraph.nodes.get(queryNodeIndex);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> targetPredCnt = <span class="number">0</span>, targetSucCnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> queryPredCnt = <span class="number">0</span>, querySucCnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// In Rule</span></span><br><span class="line">		<span class="comment">// The number predecessors/successors of the target node that are in T1in</span></span><br><span class="line">		<span class="comment">// must be larger than or equal to those of the query node that are in T2in</span></span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.inEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT1in(e.source.id))&#123;</span><br><span class="line">				targetPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.outEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT1in(e.target.id))&#123;</span><br><span class="line">				targetSucCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.inEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT2in(e.source.id))&#123;</span><br><span class="line">				queryPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.outEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT2in(e.target.id))&#123;</span><br><span class="line">				queryPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (targetPredCnt &lt; queryPredCnt || targetSucCnt &lt; querySucCnt)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Out Rule</span></span><br><span class="line">		<span class="comment">// The number predecessors/successors of the target node that are in T1out</span></span><br><span class="line">		<span class="comment">// must be larger than or equal to those of the query node that are in T2out</span></span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.inEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT1out(e.source.id))&#123;</span><br><span class="line">				targetPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.outEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT1out(e.target.id))&#123;</span><br><span class="line">				targetSucCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.inEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT2out(e.source.id))&#123;</span><br><span class="line">				queryPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.outEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inT2out(e.target.id))&#123;</span><br><span class="line">				queryPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (targetPredCnt &lt; queryPredCnt || targetSucCnt &lt; querySucCnt)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Check the new rule</span><br><span class="line">	 * This prunes the search tree using 2-look-ahead</span><br><span class="line">	 * <span class="doctag">@param</span> state				VF2 State</span><br><span class="line">	 * <span class="doctag">@param</span> targetNodeIndex	Target Graph Node Index</span><br><span class="line">	 * <span class="doctag">@param</span> queryNodeIndex	Query Graph Node Index</span><br><span class="line">	 * <span class="doctag">@return</span>					Feasible or not</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">checkNew</span><span class="params">(State state, <span class="keyword">int</span> targetNodeIndex , <span class="keyword">int</span> queryNodeIndex)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		Node targetNode = state.targetGraph.nodes.get(targetNodeIndex);</span><br><span class="line">		Node queryNode = state.queryGraph.nodes.get(queryNodeIndex);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> targetPredCnt = <span class="number">0</span>, targetSucCnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> queryPredCnt = <span class="number">0</span>, querySucCnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// In Rule</span></span><br><span class="line">		<span class="comment">// The number predecessors/successors of the target node that are in T1in</span></span><br><span class="line">		<span class="comment">// must be larger than or equal to those of the query node that are in T2in</span></span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.inEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inN1Tilde(e.source.id))&#123;</span><br><span class="line">				targetPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : targetNode.outEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inN1Tilde(e.target.id))&#123;</span><br><span class="line">				targetSucCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.inEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inN2Tilde(e.source.id))&#123;</span><br><span class="line">				queryPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (Edge e : queryNode.outEdges)&#123;</span><br><span class="line">			<span class="keyword">if</span> (state.inN2Tilde(e.target.id))&#123;</span><br><span class="line">				queryPredCnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (targetPredCnt &lt; queryPredCnt || targetSucCnt &lt; querySucCnt)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-Main"><a href="#4-Main" class="headerlink" title="4.Main"></a>4.Main</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> wip.VF2.runner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> wip.VF2.core.State;</span><br><span class="line"><span class="keyword">import</span> wip.VF2.core.VF2;</span><br><span class="line"><span class="keyword">import</span> wip.VF2.graph.Graph;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line"></span><br><span class="line">		Path graphPath = Paths.get(<span class="string">"/Users/luo123n/Projects/VF2/data/graphDB"</span>, <span class="string">"mygraphdb.data"</span>);</span><br><span class="line">		Path queryPath = Paths.get(<span class="string">"/Users/luo123n/Projects/VF2/data/graphDB"</span>, <span class="string">"Q20.my"</span>);</span><br><span class="line">		Path outPath = Paths.get(<span class="string">"/Users/luo123n/Projects/VF2/data/graphDB"</span>, <span class="string">"res_Q20.my"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (args.length == <span class="number">0</span>) &#123;</span><br><span class="line">			printUsage();</span><br><span class="line">			System.out.println();</span><br><span class="line">			System.out.println(<span class="string">"Warning: no arguments given, using default arguments"</span>);</span><br><span class="line">			System.out.println();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; args.length; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span> (args[i].equals(<span class="string">"-t"</span>)) &#123;</span><br><span class="line">				graphPath = Paths.get(args[i+<span class="number">1</span>]);</span><br><span class="line">				i++;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (args[i].equals(<span class="string">"-q"</span>)) &#123;</span><br><span class="line">				queryPath = Paths.get(args[i+<span class="number">1</span>]);</span><br><span class="line">				i++;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (args[i].equals(<span class="string">"-o"</span>)) &#123;</span><br><span class="line">				outPath = Paths.get(args[i+<span class="number">1</span>]);</span><br><span class="line">				i++;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				printUsage();</span><br><span class="line">				System.exit(<span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"Target Graph Path: "</span> + graphPath.toString());</span><br><span class="line">		System.out.println(<span class="string">"Query Graph Path: "</span> + queryPath.toString());</span><br><span class="line">		System.out.println(<span class="string">"Output Path: "</span> + outPath.toString());</span><br><span class="line">		System.out.println();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">long</span> startMilli = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">		PrintWriter writer = <span class="keyword">new</span> PrintWriter(outPath.toFile());</span><br><span class="line"></span><br><span class="line">		ArrayList&lt;Graph&gt; graphSet = loadGraphSetFromFile(graphPath, <span class="string">"Graph "</span>);</span><br><span class="line">		ArrayList&lt;Graph&gt; querySet = loadGraphSetFromFile(queryPath, <span class="string">"Query "</span>);</span><br><span class="line"></span><br><span class="line">		VF2 vf2= <span class="keyword">new</span> VF2();</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"Loading Done!"</span>);</span><br><span class="line">		printTimeFlapse(startMilli);</span><br><span class="line">		startMilli = System.currentTimeMillis();</span><br><span class="line">		System.out.println();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> queryCnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (Graph queryGraph : querySet)&#123;</span><br><span class="line">			queryCnt++;</span><br><span class="line">			ArrayList&lt;State&gt; stateSet = vf2.matchGraphSetWithQuery(graphSet, queryGraph);</span><br><span class="line">			<span class="keyword">if</span> (stateSet.isEmpty())&#123;</span><br><span class="line">				System.out.println(<span class="string">"Cannot find a map for: "</span> + queryGraph.name);</span><br><span class="line">				printTimeFlapse(startMilli);</span><br><span class="line">				printAverageMatchingTime(startMilli, queryCnt);</span><br><span class="line">				System.out.println();</span><br><span class="line"></span><br><span class="line">				writer.write(<span class="string">"Cannot find a map for: "</span> + queryGraph.name + <span class="string">"\n\n"</span>);</span><br><span class="line">				writer.flush();</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				System.out.println(<span class="string">"Found "</span> + stateSet.size() + <span class="string">" maps for: "</span> + queryGraph.name);</span><br><span class="line">				printTimeFlapse(startMilli);</span><br><span class="line">				printAverageMatchingTime(startMilli, queryCnt);</span><br><span class="line">				System.out.println();</span><br><span class="line"></span><br><span class="line">				writer.write(<span class="string">"Maps for: "</span> + queryGraph.name + <span class="string">"\n"</span>);</span><br><span class="line">				<span class="keyword">for</span> (State state : stateSet)&#123;</span><br><span class="line">					writer.write(<span class="string">"In: "</span> + state.targetGraph.name + <span class="string">"\n"</span>);</span><br><span class="line">					<span class="comment">// state.printMapping();</span></span><br><span class="line">					state.writeMapping(writer);</span><br><span class="line">				&#125;</span><br><span class="line">				writer.write(<span class="string">"\n"</span>);</span><br><span class="line">				writer.flush();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		printTimeFlapse(startMilli);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * Load graph set from file</span><br><span class="line">	 * <span class="doctag">@param</span> inpath	Input path</span><br><span class="line">	 * <span class="doctag">@param</span> namePrefix	The prefix of the names of graphs</span><br><span class="line">	 * <span class="doctag">@return</span>	Graph Set</span><br><span class="line">	 * <span class="doctag">@throws</span> FileNotFoundException</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ArrayList&lt;Graph&gt; <span class="title">loadGraphSetFromFile</span><span class="params">(Path inpath, String namePrefix)</span> <span class="keyword">throws</span> FileNotFoundException</span>&#123;</span><br><span class="line">		ArrayList&lt;Graph&gt; graphSet = <span class="keyword">new</span> ArrayList&lt;Graph&gt;();</span><br><span class="line">		Scanner scanner = <span class="keyword">new</span> Scanner(inpath.toFile());</span><br><span class="line">		Graph graph = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span> (scanner.hasNextLine())&#123;</span><br><span class="line">			String line = scanner.nextLine().trim();</span><br><span class="line">			<span class="keyword">if</span> (line.equals(<span class="string">""</span>))&#123;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.startsWith(<span class="string">"t"</span>)) &#123;</span><br><span class="line">				String graphId = line.split(<span class="string">" "</span>)[<span class="number">2</span>];</span><br><span class="line">				<span class="keyword">if</span> (graph != <span class="keyword">null</span>)&#123;</span><br><span class="line">					graphSet.add(graph);</span><br><span class="line">				&#125;</span><br><span class="line">				graph = <span class="keyword">new</span> Graph(namePrefix + graphId);</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.startsWith(<span class="string">"v"</span>)) &#123;</span><br><span class="line">				String[] lineSplit = line.split(<span class="string">" "</span>);</span><br><span class="line">				<span class="keyword">int</span> nodeId = Integer.parseInt(lineSplit[<span class="number">1</span>]);</span><br><span class="line">				<span class="keyword">int</span> nodeLabel = Integer.parseInt(lineSplit[<span class="number">2</span>]);</span><br><span class="line">				graph.addNode(nodeId, nodeLabel);</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.startsWith(<span class="string">"e"</span>)) &#123;</span><br><span class="line">				String[] lineSplit = line.split(<span class="string">" "</span>);</span><br><span class="line">				<span class="keyword">int</span> sourceId = Integer.parseInt(lineSplit[<span class="number">1</span>]);</span><br><span class="line">				<span class="keyword">int</span> targetId = Integer.parseInt(lineSplit[<span class="number">2</span>]);</span><br><span class="line">				<span class="keyword">int</span> edgeLabel = Integer.parseInt(lineSplit[<span class="number">3</span>]);</span><br><span class="line">				graph.addEdge(sourceId, targetId, edgeLabel);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		scanner.close();</span><br><span class="line">		<span class="keyword">return</span> graphSet;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printTimeFlapse</span><span class="params">(<span class="keyword">long</span> startMilli)</span></span>&#123;</span><br><span class="line">		<span class="keyword">long</span> currentMili=System.currentTimeMillis();</span><br><span class="line">		System.out.println(((currentMili - startMilli) / <span class="number">1000</span>) + <span class="string">" seconds elapsed"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printAverageMatchingTime</span><span class="params">(<span class="keyword">long</span> startMilli, <span class="keyword">int</span> queryCnt)</span></span>&#123;</span><br><span class="line">		<span class="keyword">long</span> currentMili=System.currentTimeMillis();</span><br><span class="line">		System.out.println(((currentMili - startMilli) / queryCnt) + <span class="string">" milliseconds per graph in average."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printUsage</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Usage: -t target_graph_path -q query_graph_path -o output_path"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2015/12/04/Journals/20151204_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-12-01 </div>
			<div class="article-title"><a href="/2015/12/01/Distri_Dev/Installing_Spark_and_Setting_Up_Cluster/" >Installing Spark and Setting Up Cluster</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h3><p>Spark on a single machine is a excellent for testing, but you will also learn to use Spark’s built-in deployment scripts to a dedicated cluster via SSH. This chapter will also cover using Yarn to deploy cluster. The process of installation can be considered as three main steps. First install the Programming languages environment – JAVA and Scala. Second set up the distributed file system. Final configure the spark and test it. Following is all what we need:</p>
<ul>
<li>jdk-1.7</li>
<li>Scala-2.10.4</li>
<li>Hadoop-2.4.1</li>
<li>Spark-1.4.0</li>
</ul>
<p>To interact with <strong>Hadoop Distributed File System (HDFS)</strong>, we need to use a Spark version that is built against the same version of Hadoop as your cluster. We select Spark-1.4.0 with pre-built Hadoop-2.4.0 .</p>
<h3 id="Setting_up_JDK_environment"><a href="#Setting_up_JDK_environment" class="headerlink" title="Setting up JDK environment"></a>Setting up JDK environment</h3><p>1.Download <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html" target="_blank" rel="external">jdk-7u79-linux-x64.tar.gz</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#62; wget http://download.oracle.com/otn-pub/java/jdk/7u79-b15/jdk-7u79-linux-x64.tar.gz</span><br></pre></td></tr></table></figure></p>
<p>2.Extract the file of jdk tarball to <code>/usr/local</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; sudo tar -zxvf  jdk-<span class="number">7</span>u79-linux-x64.tar.gz -C /usr/<span class="built_in">local</span>/</span><br></pre></td></tr></table></figure></p>
<p>3.Add the following variables to <code>/etc/profile</code> .<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/<span class="built_in">local</span>/jdk1.<span class="number">7.0</span>_79</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin</span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</span><br></pre></td></tr></table></figure></p>
<p>Now, fresh the environment variables and we will have the jdk environment.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">source</span> /etc/profile</span><br><span class="line">&gt; java -version</span><br><span class="line"></span><br><span class="line">java version <span class="string">"1.7.0_79"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build <span class="number">1.7</span>.<span class="number">0</span>_79-b15)</span><br><span class="line">Java HotSpot(TM) <span class="number">64</span>-Bit Server VM (build <span class="number">24.79</span>-b02, mixed mode)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Installing_Scala_language"><a href="#Installing_Scala_language" class="headerlink" title="Installing Scala language"></a>Installing Scala language</h3><p>4.Download <a href="http://www.scala-lang.org/download/2.10.4.html" target="_blank" rel="external">scala-2.10.4.tgz</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget http://www.scala-lang.org/files/archive/scala-<span class="number">2.10</span>.<span class="number">4</span>.tgz</span><br></pre></td></tr></table></figure></p>
<p>5.Extract the file of tarball to <code>/usr/local</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf scala-2.10.4.tgz -C /usr/local</span><br></pre></td></tr></table></figure></p>
<p>6.Add the following variables to <code>/etc/profile</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> SCALA_HOME=/usr/<span class="built_in">local</span>/scala-<span class="number">2.10</span>.<span class="number">4</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$&#123;SCALA_HOME&#125;</span>/bin</span><br></pre></td></tr></table></figure></p>
<p>Fresh the environment variable as what we did with jdk and we have scala too.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">source</span> /etc/profile</span><br><span class="line">&gt; scala --version</span><br><span class="line"></span><br><span class="line">Scala code runner version <span class="number">2.10</span>.<span class="number">4</span> -- Copyright <span class="number">2002</span>-<span class="number">2013</span>, LAMP/EPFL</span><br></pre></td></tr></table></figure>
<p>Final, do the same for all other machines.</p>
<hr>
<h3 id="Configure_SSH_Key-Based_Authentication"><a href="#Configure_SSH_Key-Based_Authentication" class="headerlink" title="Configure SSH Key-Based Authentication"></a>Configure SSH Key-Based Authentication</h3><p>The need for SSH Key-Based authentication is required so that the master node can then login (without requiring a password ) to slave nodes to Start/Stop them. Assuming we have 3 machines, all of which have turn firewall ( likes selinux and iptable) off. Assume the followint is the list of IP of three machines, whose IP can be seen by command <code>ifconfig</code></p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>——–IP———</strong></th>
<th style="text-align:center"><strong>——-Hostname———</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">192.168.1.101</td>
<td style="text-align:center">hadoop1</td>
</tr>
<tr>
<td style="text-align:center">192.168.1.102</td>
<td style="text-align:center">hadoop2</td>
</tr>
<tr>
<td style="text-align:center">192.168.1.103</td>
<td style="text-align:center">hadoop3</td>
</tr>
</tbody>
</table>
<p>7.Configure domain resolution to all nodes. We just need add the following lines to <code>/etc/hosts</code> for all three machine.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168</span>.<span class="number">1.101</span>  hadoop1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.102</span>  hadoop2</span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.103</span>  hadoop3</span><br></pre></td></tr></table></figure></p>
<p>8.Generate SSH Key of three machines. Type the following command<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; ssh-keygen</span><br></pre></td></tr></table></figure></p>
<p>then type several <code>Enter</code>, you should have the SSH-Key in <code>~/.ssh/id_rsa.pub</code>. And do the same for other two machines.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#62; ssh user@hadoop2&#10;&#62; ssh-keygen&#10;&#62; exit&#10;&#10;&#62; ssh user@hadoop3&#10;&#62; ssh-keygen&#10;&#62; exit</span><br></pre></td></tr></table></figure></p>
<p>9.Then gather them to one file.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#62; cat ~/.ssh/id_dsa.pub &#62;&#62; ~/.ssh/authorized_keys&#10;&#10;&#62; scp user@hadoop2:.ssh/id_dsa.pub ~/.ssh/hadoop2.pub&#10;&#62; cat ~/.ssh/hadoop2.pub &#62;&#62; ~/.ssh/authorized_keys&#10;&#10;&#62; scp user@hadoop3:.ssh/id_dsa.pub ~/.ssh/hadoop3.pub&#10;&#62; cat ~/.ssh/hadoop2.pub &#62;&#62; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>
<p>10.Final distribute the file to each machine’s authorized key store.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp ~/.ssh/authorized_keys user@hadoop2:.ssh/authorized_keys&#10;scp ~/.ssh/authorized_keys user@hadoop3:.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>
<p>Now you can test it by login in any node. If it will not require password, you have finish this step.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#62; ssh user@hadoop1</span><br></pre></td></tr></table></figure></p>
<hr>
<p>11.Download</p>

	
	</div>
  <a type="button" href="/2015/12/01/Distri_Dev/Installing_Spark_and_Setting_Up_Cluster/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-26 </div>
			<div class="article-title"><a href="/2015/11/26/Journals/20151126_log/" >Log_2015-11-26 -- Hadoop File Manage</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="1-Creat_2C_Copy_2C_Rename_2C_Delete_File_on_HDFS"><a href="#1-Creat_2C_Copy_2C_Rename_2C_Delete_File_on_HDFS" class="headerlink" title="1.Creat, Copy, Rename, Delete File on HDFS"></a>1.Creat, Copy, Rename, Delete File on HDFS</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hadooplearn.test;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FSDataOutputStream;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="comment">//学习HDFS的使用</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HdfsLearn</span> </span>&#123;</span><br><span class="line">	<span class="comment">//复制文件,从本地到HDFS</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">copyFile</span><span class="params">(String src,String dst)</span></span>&#123;</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		conf.set(<span class="string">"mapred.job.tracker"</span>, <span class="string">"localhost:9001"</span>);  </span><br><span class="line">        conf.set(<span class="string">"fs.default.name"</span>, <span class="string">"hdfs://localhost:9000"</span>);</span><br><span class="line">		FileSystem hdfs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			hdfs = FileSystem.get(conf);</span><br><span class="line">			Path srcPath = <span class="keyword">new</span> Path(src);</span><br><span class="line">			Path dstPath = <span class="keyword">new</span> Path(dst);</span><br><span class="line">			hdfs.copyFromLocalFile(srcPath, dstPath);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(hdfs != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					hdfs.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建新文件</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createFile</span><span class="params">(String dst)</span></span>&#123;</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		conf.set(<span class="string">"mapred.job.tracker"</span>,<span class="string">"localhost:9001"</span>);</span><br><span class="line">		conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://localhost:9000"</span>);</span><br><span class="line">		FileSystem fs = <span class="keyword">null</span>;</span><br><span class="line">		FSDataOutputStream out = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			String content = <span class="string">"hello hadoop"</span>;</span><br><span class="line">			Path path = <span class="keyword">new</span> Path(dst);</span><br><span class="line">			fs = FileSystem.get(conf);</span><br><span class="line">			out = fs.create(path);</span><br><span class="line">			out.write(content.getBytes());</span><br><span class="line">			out.flush();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">			ex.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(out != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					out.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(fs != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fs.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">renameFile</span><span class="params">(String str,String dst)</span></span>&#123;</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		conf.set(<span class="string">"mapred.job.tracker"</span>,<span class="string">"localhost:9001"</span>);</span><br><span class="line">		conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://localhost:9000"</span>);</span><br><span class="line">		FileSystem fs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			fs = FileSystem.get(conf);</span><br><span class="line">			Path srcPath = <span class="keyword">new</span> Path(str);</span><br><span class="line">			Path dstPath = <span class="keyword">new</span> Path(dst);</span><br><span class="line">			fs.rename(srcPath, dstPath);</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">			ex.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(fs != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fs.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteFile</span><span class="params">(String src)</span></span>&#123;</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		conf.set(<span class="string">"mapred.job.tracker"</span>,<span class="string">"localhost:9001"</span>);</span><br><span class="line">		conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://localhost:9000"</span>);</span><br><span class="line">		FileSystem fs = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			fs = FileSystem.get(conf);</span><br><span class="line">			fs.delete(<span class="keyword">new</span> Path(src));</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">			ex.printStackTrace();</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(fs != <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fs.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">		System.setProperty(<span class="string">"HADOOP_USER_NAME"</span>, <span class="string">"pijing"</span>);</span><br><span class="line">		String src = <span class="string">"/home/pijing/input/test1"</span>;</span><br><span class="line">		String dst = <span class="string">"/"</span>;</span><br><span class="line">		HdfsLearn learn = <span class="keyword">new</span> HdfsLearn();</span><br><span class="line"><span class="comment">//		learn.copyFile(src, dst);</span></span><br><span class="line"><span class="comment">//		System.out.println("copy file from local file system to HDFS");</span></span><br><span class="line"><span class="comment">//		learn.createFile("/test2");</span></span><br><span class="line"><span class="comment">//		System.out.println("create file test2");</span></span><br><span class="line"><span class="comment">//		String org = "/test2";</span></span><br><span class="line"><span class="comment">//		String lasted = "/test3";</span></span><br><span class="line"><span class="comment">//		learn.renameFile(org, lasted);</span></span><br><span class="line"><span class="comment">//		System.out.println("rename file /test2 to /test3");</span></span><br><span class="line">		learn.deleteFile(<span class="string">"/test3"</span>);</span><br><span class="line">		System.out.println(<span class="string">"delete file /test3"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2015/11/26/Journals/20151126_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-18 </div>
			<div class="article-title"><a href="/2015/11/18/Journals/20151118_log/" >Log_2015-11-18 -- File and Dictionary Authority, Hadoop New/Old API</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="File_and_Dictionary_Authority"><a href="#File_and_Dictionary_Authority" class="headerlink" title="File and Dictionary Authority"></a>File and Dictionary Authority</h3><ol>
<li>chmod 只修改子目录<br>如果只修改子目录（不包括文件）权限，举例：<br>chmod 755 <code>find -type d</code><br>或者：<br>find /目录 -type d -exec chmod 755 {} \;<br>find /目录 -type f -exec chmod 644 {} \; （相反，只改文件）</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.ArrayWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Writable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.JobConf;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.RecordWriter;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.lib.MultipleOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.lib.MultipleTextOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.util.Progressable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StateNumMapper</span></span><br><span class="line">            <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntArrayWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> IntArrayWritable Time = <span class="keyword">new</span> IntArrayWritable();</span><br><span class="line">        <span class="keyword">private</span> Text IPStr = <span class="keyword">new</span> Text();</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context</span><br><span class="line">        )</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            StringTokenizer lines = <span class="keyword">new</span> StringTokenizer(value.toString(),<span class="string">"\n"</span>);</span><br><span class="line">            <span class="keyword">while</span> (lines.hasMoreTokens()) &#123;</span><br><span class="line">                <span class="keyword">int</span> time = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">int</span> stateNum = <span class="number">0</span>;</span><br><span class="line">                String line = lines.nextToken();</span><br><span class="line">                String[] items = line.split(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// To extract Clock of specific log</span></span><br><span class="line">                <span class="keyword">if</span> ( items[<span class="number">1</span>].length() == <span class="number">21</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        time = Integer.parseInt(items[<span class="number">1</span>].substring(<span class="number">13</span>, <span class="number">15</span>));</span><br><span class="line">                    &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                        System.out.println(<span class="string">"Error when parsing time"</span> + e.getMessage());</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// To extract Number of IP Address</span></span><br><span class="line">                IPStr.set(items[<span class="number">0</span>]);</span><br><span class="line">                IntWritable [] timeArray = <span class="keyword">new</span> IntWritable[<span class="number">1</span>];</span><br><span class="line">                timeArray[<span class="number">0</span>] = <span class="keyword">new</span> IntWritable(time);</span><br><span class="line">                Time.set(timeArray);</span><br><span class="line">                context.write(IPStr, Time);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StateNumCombiner</span></span><br><span class="line">            <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>,<span class="title">IntArrayWritable</span>,<span class="title">Text</span>,<span class="title">IntArrayWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> IntArrayWritable IPAllHourStatis = <span class="keyword">new</span> IntArrayWritable();</span><br><span class="line">        <span class="keyword">private</span> IntWritable [] IPAllHourStatisWritableArray = <span class="keyword">new</span> IntWritable[<span class="number">26</span>];</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntArrayWritable&gt; values,</span><br><span class="line">                           Context context )</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> stateNum;</span><br><span class="line">            <span class="keyword">int</span>[] IPAllHourStatisArray = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">            <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++)</span><br><span class="line">                IPAllHourStatisArray[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntArrayWritable valArray : values)&#123;</span><br><span class="line">                Writable[] valWritable = valArray.get();</span><br><span class="line">                IntWritable tempIntWritable = (IntWritable)valWritable[<span class="number">0</span>];</span><br><span class="line">                stateNum = tempIntWritable.get();</span><br><span class="line">                IPAllHourStatisArray[stateNum] ++;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++ )</span><br><span class="line">                IPAllHourStatisWritableArray[i] = <span class="keyword">new</span> IntWritable(IPAllHourStatisArray[i]);</span><br><span class="line"></span><br><span class="line">            IPAllHourStatis.set(IPAllHourStatisWritableArray);</span><br><span class="line">            context.write(<span class="keyword">null</span>,IPAllHourStatis);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MultiOutPut</span> <span class="keyword">extends</span> <span class="title">MultipleOutputFormat</span>&lt;<span class="title">Text</span>, <span class="title">IntArrayWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> TextOutputFormat&lt;Text, IntArrayWritable&gt; outputer = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">protected</span> RecordWriter&lt;Text, IntArrayWritable&gt;</span><br><span class="line">            getBaseRecordWriter(FileSystem fs, JobConf job, String name, Progressable arg3)</span><br><span class="line">                        <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="keyword">if</span> (outputer == <span class="keyword">null</span>) &#123;</span><br><span class="line">                outputer = <span class="keyword">new</span> TextOutputFormat&lt;Text, IntArrayWritable&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> outputer.getRecordWriter(fs, job, name, arg3);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> String <span class="title">generateFileNameForKeyValue</span><span class="params">(Text key, IntArrayWritable value, String name)</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> key.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*</span><br><span class="line">    public static class StateNumReducer</span><br><span class="line">            extends Reducer&lt;IntWritable,IntArrayWritable,Text,IntArrayWritable&gt; &#123;</span><br><span class="line"></span><br><span class="line">        private IntArrayWritable SingleHourStatis = new IntArrayWritable();</span><br><span class="line">        private IntWritable [] SingleHourStatisIntWritableArray = new IntWritable[3];</span><br><span class="line"></span><br><span class="line">        public void reduce(IntWritable key, Iterable&lt;IntArrayWritable&gt; values,</span><br><span class="line">                           Context context ) throws IOException, InterruptedException &#123;</span><br><span class="line">            int stateNum;</span><br><span class="line">            int[] SingleHourStatisIntArray = new int[3];</span><br><span class="line">            for ( int i = 0; i &lt; 3; i ++)</span><br><span class="line">                SingleHourStatisIntArray[i] = 0;</span><br><span class="line">            for (IntArrayWritable valArray : values)&#123;</span><br><span class="line">                Writable[] valWritable = valArray.get();</span><br><span class="line">                for ( int i = 0; i &lt; 3; i++)&#123;</span><br><span class="line">                    IntWritable tempIntWritable = (IntWritable)valWritable[i];</span><br><span class="line">                    stateNum = tempIntWritable.get();</span><br><span class="line">                    SingleHourStatisIntArray[i] += stateNum;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if ( key.get() != -1)&#123;</span><br><span class="line"></span><br><span class="line">                for (int i = 0; i &lt; 3; i++ )</span><br><span class="line">                    SingleHourStatisIntWritableArray[i] = new IntWritable(SingleHourStatisIntArray[i]);</span><br><span class="line"></span><br><span class="line">                SingleHourStatis.set(SingleHourStatisIntWritableArray);</span><br><span class="line">                String keyStr = key.toString() + ":00-"+(key.get() + 1) + ":00";</span><br><span class="line">                context.write(new Text(keyStr), SingleHourStatis);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                String keyStr = "200:"+SingleHourStatisIntArray[0] + "\n" +</span><br><span class="line">                        "404:" + SingleHourStatisIntArray[1] + "\n" +</span><br><span class="line">                        "500:" + SingleHourStatisIntArray[2];</span><br><span class="line">                context.write(new Text(keyStr), null);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntArrayWritable</span></span><br><span class="line">            <span class="keyword">extends</span> <span class="title">ArrayWritable</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">IntArrayWritable</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(IntWritable.class);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">            String str = <span class="string">""</span>;</span><br><span class="line">            Writable[] values = get();</span><br><span class="line">            IntWritable[] Values = <span class="keyword">new</span> IntWritable[<span class="number">26</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i ++)&#123;</span><br><span class="line">                Values[i] = (IntWritable)values[i];</span><br><span class="line">                str += i + <span class="string">" "</span> + Values[i].toString() + <span class="string">"\n"</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        conf.set(<span class="string">"mapreduce.output.textoutputformat.separator"</span>, <span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">"word count"</span>);</span><br><span class="line">        job.setJarByClass(WordCount.class);</span><br><span class="line"></span><br><span class="line">        job.setMapperClass(StateNumMapper.class);</span><br><span class="line">        <span class="comment">//job.setCombinerClass(StateNumCombiner.class);</span></span><br><span class="line">        <span class="comment">//job.setReducerClass(StateNumReducer.class);</span></span><br><span class="line">        job.setReducerClass(StateNumCombiner.class);</span><br><span class="line"></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntArrayWritable.class);</span><br><span class="line"></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntArrayWritable.class);</span><br><span class="line"></span><br><span class="line">        job.setOutputFormatClass(TextOutputFormat.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Hadoop_new_api_is_incompatible_with_old_api"><a href="#Hadoop_new_api_is_incompatible_with_old_api" class="headerlink" title="Hadoop new api is incompatible with old api"></a>Hadoop new api is incompatible with old api</h3><p>New API : org.hadoop.mapreduce.<em><br>Old API : org.hadoop.mapred.</em></p>

	
	</div>
  <a type="button" href="/2015/11/18/Journals/20151118_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-17 </div>
			<div class="article-title"><a href="/2015/11/17/Journals/20151117_log/" >Log_2015-11-17 -- Standard ArrayWritable, Application of Combiner, Mega, YouDao-Dict</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="Standard_ArrayWritable"><a href="#Standard_ArrayWritable" class="headerlink" title="Standard ArrayWritable"></a>Standard ArrayWritable</h3><p>A Writable for arrays containing instances of a class. The elements of this writable must all be instances of the same class. If this writable will be the input for a Reducer, you will need to create a subclass that sets the value to be of the proper type. For example:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntArrayWritable</span> <span class="keyword">extends</span> <span class="title">ArrayWritable</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">IntArrayWritable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(IntWritable.class);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.ArrayWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.FileOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.JobClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.JobConf;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.MapReduceBase;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.OutputCollector;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.Reporter;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.TextInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapred.TextOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TextArrayWritable</span> <span class="keyword">extends</span> <span class="title">ArrayWritable</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TextArrayWritable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(Text.class);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TextArrayWritable</span><span class="params">(String[] strings)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(Text.class);</span><br><span class="line">            Text[] texts = <span class="keyword">new</span> Text[strings.length];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strings.length; i++) &#123;</span><br><span class="line">                texts[i] = <span class="keyword">new</span> Text(strings[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            set(texts);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MapClass</span> <span class="keyword">extends</span> <span class="title">MapReduceBase</span> <span class="keyword">implements</span></span><br><span class="line">            <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">ArrayWritable</span>&gt; </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key, Text value,</span><br><span class="line">                        OutputCollector&lt;Text, ArrayWritable&gt; output, Reporter reporter)</span></span><br><span class="line">                <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">            String[] arr_str = <span class="keyword">new</span> String[] &#123;</span><br><span class="line">                    <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span> &#125;;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">                output.collect(<span class="keyword">new</span> Text(<span class="string">"my_key"</span>), <span class="keyword">new</span> TextArrayWritable(</span><br><span class="line">                        arr_str));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Reduce</span> <span class="keyword">extends</span> <span class="title">MapReduceBase</span> <span class="keyword">implements</span></span><br><span class="line">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">TextArrayWritable</span>, <span class="title">Text</span>, <span class="title">TextArrayWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterator&lt;TextArrayWritable&gt; values,</span><br><span class="line">                           OutputCollector&lt;Text, TextArrayWritable&gt; output,</span><br><span class="line">                           Reporter reporter)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">            TextArrayWritable tmp;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (values.hasNext()) &#123;</span><br><span class="line">                tmp = values.next();</span><br><span class="line">                output.collect(key, tmp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line"></span><br><span class="line">        JobConf job = <span class="keyword">new</span> JobConf(conf, WordCount.class);</span><br><span class="line"></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(TextArrayWritable.class);</span><br><span class="line">        job.setOutputFormat(TextOutputFormat.class);</span><br><span class="line">        job.setInputFormat(TextInputFormat.class);</span><br><span class="line"></span><br><span class="line">        job.setMapperClass(MapClass.class);</span><br><span class="line">        job.setReducerClass(Reduce.class);</span><br><span class="line"></span><br><span class="line">        FileInputFormat.setInputPaths(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        job.setJobName(<span class="string">"TempClass"</span>);</span><br><span class="line"></span><br><span class="line">        JobClient.runJob(job);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Application_of_Combiner"><a href="#Application_of_Combiner" class="headerlink" title="Application of Combiner"></a>Application of Combiner</h3><p><strong>Import</strong>: The output Key/Value format of Combiner has to be same as Mapper’s output format, and the input Key/Value format of Combiner has to be same as Reducer’s input Key/Value format.</p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><strong>map/reduce 下ArrayWritable 的使用</strong></p>
<ul>
<li>1.在map/reduce的开发中经常使用数组类型, 例如DoubleWritable ,当需要使用一组DoubleWritable的时候,<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DoubleWritable[] doublewritable =<span class="keyword">new</span> DoubleWritable[n]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>即可.</p>
<ul>
<li><p>2.但是DoubleWritable[] 这种形式的数组并不能作为value在map和reduce中传递. 实际上,map/reduce 的序列类型为ArrayWritable.<br>当我要使用DoubleWritable类型的数组作为value进行传递时,需要重写一个类继承于ArrayWritable</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewArrayWritable</span> <span class="keyword">extends</span> <span class="title">ArrayWritable</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">NewArrayWritable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	     <span class="keyword">super</span>(DoubleWritable.class);</span><br><span class="line">	   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>3.当要使用时:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NewArrayWritable ntemp=<span class="keyword">new</span> NewArrayWritable();</span><br><span class="line"><span class="comment">//如果我现在有一个DoubleWritable[]  ctemp, 我可以这样赋值:</span></span><br><span class="line">ntemp.set(ctemp);</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.当修改map的输出key类型时,需要对如下语句进行修改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">改为</span><br><span class="line">job.setMapOutputValueClass(NewArrayWritable.class);</span><br></pre></td></tr></table></figure>
</li>
<li><p>5.此时程序可能出现wrong value class: class org.apache.hadoop.io.IntWritable is not class org.apache.hadoop.examples.NewArrayWritable 异常<br>解决方法: 注释掉main函数中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">job.setCombinerClass(IntSumReducer.class);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Key/Value_Separator"><a href="#Key/Value_Separator" class="headerlink" title="Key/Value Separator"></a>Key/Value Separator</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">conf.set(<span class="string">"mapreduce.output.textoutputformat.separator"</span>, <span class="string">"-----"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Java_Integer_Output_Format"><a href="#Java_Integer_Output_Format" class="headerlink" title="Java Integer Output Format"></a>Java Integer Output Format</h3><p>你可以用String的format函数输出，整数3，想要输出两位用0填充，输出03，就可以像下面这样。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FormatTest</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">3</span>;</span><br><span class="line">        System.out.println(String.format(<span class="string">"%02d"</span>, a));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="It_occured_error_which_is__u201CNo_module_named__u2018PyQt5-QtWebKitWidgets_u2019_u201D_when_I_launch_YouDao-Dict"><a href="#It_occured_error_which_is__u201CNo_module_named__u2018PyQt5-QtWebKitWidgets_u2019_u201D_when_I_launch_YouDao-Dict" class="headerlink" title="It occured error which is “No module named ‘PyQt5.QtWebKitWidgets’” when I launch YouDao-Dict"></a>It occured error which is “No module named ‘PyQt5.QtWebKitWidgets’” when I launch YouDao-Dict</h3><p>Though I installed PyQt5 it occured same errors, since my core Qt is Qt4 not Qt5. Moreover, It still lack QtWebKitWidgetsafter I check my python library file <code>/usr/lib64/python3.4/site-packages/PyQt5</code>,  though I have installed it though I have installed all version of QtWebKit and WebKit. So I have planed to compile and install it manually, but failed with no core Qt5. So the right method is update my core Qt version.</p>
<h3 id="Mega_Cloud_Drive"><a href="#Mega_Cloud_Drive" class="headerlink" title="Mega Cloud Drive."></a>Mega Cloud Drive.</h3><p>With command line tool, <code>Mega</code> is very powerful and compatible with Linux. Gentoo have it being masked in default source, we can install it as root by typing :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emerge net-misc/megatools</span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2015/11/17/Journals/20151117_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-15 </div>
			<div class="article-title"><a href="/2015/11/15/Journals/20151115_log/" >Log_2015-11-15 -- Remote Display, Customized ArrayWritable, Type MisMatch</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="Linux_user_view_remote_display_of_Windows"><a href="#Linux_user_view_remote_display_of_Windows" class="headerlink" title="Linux user view remote display of Windows"></a>Linux user view remote display of Windows</h3><ol>
<li><p><strong>Server Port:</strong> Open remote display server on Windows<br>Computer -&gt; Property -&gt; Manager -&gt;Server -&gt; Open all Remote Desktop server and add to auto launch</p>
</li>
<li><p><strong>Client Port:</strong> Installing <code>rdesktop</code> on Linux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emerge rdesktop</span><br></pre></td></tr></table></figure>
</li>
<li><p>Launch <code>rdesktop</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop <span class="number">10.10</span>.<span class="number">64.74</span> -u username -p password -g <span class="number">1400</span>x900 <span class="comment"># Middle of which is character 'x', not symbol '*'</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="ArrayWritable_example"><a href="#ArrayWritable_example" class="headerlink" title="ArrayWritable example"></a>ArrayWritable example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.ArrayWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Initialize Variables</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> IntWritable one = <span class="keyword">new</span> IntWritable(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">private</span> Text word = <span class="keyword">new</span> Text();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Map Method</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Use Tokenizer</span></span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(value.toString());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Select each word</span></span><br><span class="line">            <span class="keyword">while</span> (itr.hasMoreTokens()) &#123;</span><br><span class="line">                word.set(itr.nextToken());</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Output Pair</span></span><br><span class="line">                context.write(word, one);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyReducer</span></span><br><span class="line">            <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntArrayWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Initialize Variables</span></span><br><span class="line">        <span class="keyword">private</span> IntWritable count = <span class="keyword">new</span> IntWritable();</span><br><span class="line">        <span class="keyword">private</span> IntWritable length = <span class="keyword">new</span> IntWritable();</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values,</span><br><span class="line">                           Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Count Words</span></span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) &#123;</span><br><span class="line">                sum += val.get();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            count.set(sum);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Wordlength</span></span><br><span class="line">            length.set(key.getLength());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Define Output</span></span><br><span class="line">            IntWritable[] temp = <span class="keyword">new</span> IntWritable[<span class="number">2</span>];</span><br><span class="line">            temp[<span class="number">0</span>] = count;</span><br><span class="line">            temp[<span class="number">1</span>] = length;</span><br><span class="line"></span><br><span class="line">            context.write(key, <span class="keyword">new</span> IntArrayWritable(temp));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntArrayWritable</span> <span class="keyword">extends</span> <span class="title">ArrayWritable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">IntArrayWritable</span><span class="params">(IntWritable[] values)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(IntWritable.class, values);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="keyword">public</span> IntWritable[] get() &#123;</span><br><span class="line">            <span class="keyword">return</span> (IntWritable[]) <span class="keyword">super</span>.get();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            IntWritable[] values = get();</span><br><span class="line">            <span class="keyword">return</span> values[<span class="number">0</span>].toString() + <span class="string">", "</span> + values[<span class="number">1</span>].toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">"word length V1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set Classes</span></span><br><span class="line">        <span class="comment">//job.setJarByClass(WordLength_V01.class);</span></span><br><span class="line">        job.setMapperClass(MyMapper.class);</span><br><span class="line">        <span class="comment">// job.setCombinerClass(MyReducer.class);</span></span><br><span class="line">        job.setReducerClass(MyReducer.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set Output and Input Parameters</span></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line"></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntArrayWritable.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Number of Reducers</span></span><br><span class="line">        job.setNumReduceTasks(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set FileDestination</span></span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.ArrayWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StateNumMapper</span></span><br><span class="line">            <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">IntWritable</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> IntWritable Time = <span class="keyword">new</span> IntWritable(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">private</span> IntWritable StateNum = <span class="keyword">new</span> IntWritable(<span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context</span><br><span class="line">        )</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            StringTokenizer lines = <span class="keyword">new</span> StringTokenizer(value.toString(),<span class="string">"\n"</span>);</span><br><span class="line">            <span class="keyword">int</span> time = <span class="number">24</span>, stateNum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (lines.hasMoreTokens()) &#123;</span><br><span class="line">                time = <span class="number">24</span>;</span><br><span class="line">                stateNum = <span class="number">0</span>;</span><br><span class="line">                String line = lines.nextToken();</span><br><span class="line">                String[] items = line.split(<span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// To extract Clock of specific log</span></span><br><span class="line">                <span class="keyword">if</span> ( items[<span class="number">1</span>].length() == <span class="number">21</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        time = Integer.parseInt(items[<span class="number">1</span>].substring(<span class="number">13</span>, <span class="number">15</span>));</span><br><span class="line">                    &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                        System.out.println(<span class="string">"Error when parsing time"</span> + e.getMessage());</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                        <span class="keyword">return</span> ;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// To extract Number of Statement</span></span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    stateNum = Integer.parseInt(items[items.length - <span class="number">3</span>]);</span><br><span class="line">                    System.out.println(stateNum);</span><br><span class="line">                &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    System.out.println(<span class="string">" Error when get stateNum!"</span> + e.getMessage());</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="keyword">return</span> ;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Debugging</span></span><br><span class="line">                System.out.println(items[<span class="number">1</span>].substring(<span class="number">13</span>, <span class="number">15</span>) + <span class="string">"  ---   "</span> + time);</span><br><span class="line"></span><br><span class="line">                StateNum.set(stateNum);</span><br><span class="line">                Time.set(time);</span><br><span class="line">                context.write(StateNum, Time);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntSumReducer</span></span><br><span class="line">            <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">IntWritable</span>,<span class="title">IntWritable</span>,<span class="title">IntWritable</span>,<span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(IntWritable key, Iterable&lt;IntWritable&gt; values,</span><br><span class="line">                           Context context</span><br><span class="line">        )</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            <span class="comment">/*</span><br><span class="line">            int[] sum = new int[26];</span><br><span class="line">            for ( int i = 0; i &lt; 26; i ++)</span><br><span class="line">                sum[i] = 0;</span><br><span class="line">            for (IntWritable val : values) &#123;</span><br><span class="line">                sum[val.get()] += 1;</span><br><span class="line">            &#125;</span><br><span class="line">            IntWritable[] Sum = new IntWritable[sum.length];</span><br><span class="line">            for( int i = 0; i &lt; sum.length; i ++)</span><br><span class="line">                Sum[i] = new IntWritable(sum[i]);</span><br><span class="line">            context.write(key, new IntArrayWritable(Sum));</span><br><span class="line">            */</span></span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) &#123;</span><br><span class="line">                sum += val.get();</span><br><span class="line">            &#125;</span><br><span class="line">            context.write(key,<span class="keyword">new</span> IntWritable(sum));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntArrayWritable</span> <span class="keyword">extends</span> <span class="title">ArrayWritable</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">IntArrayWritable</span><span class="params">(IntWritable[] ints)</span></span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(IntWritable.class,ints);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="keyword">public</span> IntWritable[] get()&#123;</span><br><span class="line">            <span class="keyword">return</span> (IntWritable[])<span class="keyword">super</span>.get();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">            IntWritable[] values = get();</span><br><span class="line">            String express = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">for</span>( Integer i = <span class="number">0</span>; i &lt; values.length; i ++)&#123;</span><br><span class="line">                express += i.toString() + <span class="string">" "</span> + values[i].toString() + <span class="string">"\n"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> express;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">printStrings</span><span class="params">()</span></span>&#123;</span><br><span class="line">            IntWritable[] values = get();</span><br><span class="line">            String express = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">for</span>( Integer i = <span class="number">0</span>; i &lt; values.length; i ++)&#123;</span><br><span class="line">                express += i.toString() + <span class="string">" "</span> + values[i].toString() + <span class="string">"\n"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> express;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">"word count"</span>);</span><br><span class="line">        job.setJarByClass(WordCount.class);</span><br><span class="line">        job.setMapperClass(StateNumMapper.class);</span><br><span class="line">        job.setCombinerClass(IntSumReducer.class);</span><br><span class="line">        job.setReducerClass(IntSumReducer.class);</span><br><span class="line">        job.setOutputKeyClass(IntWritable.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Type_MisMatch_Error"><a href="#Type_MisMatch_Error" class="headerlink" title="Type MisMatch Error"></a>Type MisMatch Error</h3><p>We have to specific mapper export type like following:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">job.setMapOutputKeyClass(Text.class);         // Import: We have to specific  key type of mapper out&#10;job.setMapOutputValueClass(IntWritable.class); // Specific the value type of mapper out&#10;&#10;job.setOutputKeyClass(Text.class);&#10;job.setOutputValueClass(IntArrayWritable.class);</span><br></pre></td></tr></table></figure></p>
<h3 id="Custom_OutputFormat"><a href="#Custom_OutputFormat" class="headerlink" title="Custom OutputFormat"></a>Custom OutputFormat</h3><ol>
<li><p>Custom function <code>getRecordWriter</code> of your customized <code>OutputFormat</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>Override function <code>write</code> of your customized <code>RecordWriter</code></p>
<pre><code class="java">
</code></pre>
</li>
</ol>

	
	</div>
  <a type="button" href="/2015/11/15/Journals/20151115_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-13 </div>
			<div class="article-title"><a href="/2015/11/13/Journals/20151113_log/" >Log_2015-11-13 -- Hexo Theme</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="u8C03_u6574_u8BED_u6CD5_u9AD8_u4EAE_u914D_u8272_u548C_u8FB9_u7F18"><a href="#u8C03_u6574_u8BED_u6CD5_u9AD8_u4EAE_u914D_u8272_u548C_u8FB9_u7F18" class="headerlink" title="调整语法高亮配色和边缘"></a>调整语法高亮配色和边缘</h3><p><strong> /themes/freemind/source/css/highlight.css</strong><br>更改了background，margin，padding<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pre, .highlight, .gist &#123;  &#10;  background: #1a1a1a !important;&#10;  margin: 0.1em 2%;&#10;  padding: 0.3em 2%;&#10;  overflow: auto;&#10;  color: #fffafa;  &#10;  font-size: 14px;&#10;  text-shadow: none;&#10;  -webkit-border-radius: 4px;&#10;  -moz-border-radius: 4px;&#10;  border-radius: 4px;  &#10;  border-style: solid;&#10;  border-color: #ddd;&#10;  border-width: 1px 0;&#10;  line-height: 20px;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="u8C03_u6574categories_u6837_u5F0F"><a href="#u8C03_u6574categories_u6837_u5F0F" class="headerlink" title="调整categories样式"></a>调整categories样式</h3><p><strong> /themes/freemind/source/css/style.css</strong><br>添加链接里a下的b样式，主要更改padding右值，margin右值，border宽度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.tag_box a.b &#123;&#10;  padding: 4px 50px 2px 6px;&#10;  margin: 2px 40px 2px 2px;&#10;  background: #e5e5e5;&#10;  color:#555;&#10;  border-radius: 3px;&#10;  text-decoration:none;&#10;  border:0px dashed #bbb;&#10;&#125;&#10;.tag_box a.b span&#123;&#10;  vertical-align:super;&#10;  font-size:0.8em;&#10;&#125;&#10;.tag_box a.b:hover &#123;&#10;  background-color:#397bdd;&#10;  color:#FFF;&#10;&#125;&#10;.tag_box a.b.active &#123;&#10;  background:#57A957;&#10;  border:1px solid #4C964D;&#10;  color:#FFF;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后，在框架设置里使用该设置，即在<a href="...">中添加 class=”b”,确定格式：<br><strong>/themes/freemind/layout/_widget/category.ejs</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;li&#62;&#60;a href=&#34;&#60;%- config.root %&#62;&#60;%- item.path %&#62; class=&#34;b&#34;&#34;&#62;&#60;%= item.name %&#62;&#60;span&#62;&#60;%= item.   posts.length %&#62;&#60;/span&#62;&#60;/a&#62;&#60;/li&#62;</span><br></pre></td></tr></table></figure></a></p>
<h3 id="u66F4_u6539header_u6E10_u53D8_u989C_u8272"><a href="#u66F4_u6539header_u6E10_u53D8_u989C_u8272" class="headerlink" title="更改header渐变颜色"></a>更改header渐变颜色</h3><p><strong> /themes/freemind/source/css/style.css</strong><br>更改background: -moz-linear-gradient(top, #333, #1a1a1a 50%); 即header背景从上到下333到1a1a1a渐变，333同主标题背景，1a1a1a同语法高亮背景。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.page-header &#123;&#10;  -webkit-background-clip: border-box;&#10;  -webkit-background-origin: padding-box;&#10;  -webkit-background-size: cover;&#10;  /* background-color: #f5f5f5; */&#10;  padding: 10px 20px 0px 20px;&#10;  margin: -20px -20px 20px;&#10;  background: #333;&#10;  background: -moz-linear-gradient(top, #333, #1a1a1a 50%);&#10;  background: -webkit-gradient(linear, 0 0, 0 50%, from(#333), to(#000));&#10;  color: #e9e9e9;&#10;  border-bottom-left-radius: 0px;&#10;  border-bottom-right-radius: 0px;&#10;  border-top-left-radius: 6px;&#10;  border-top-right-radius: 6px;  &#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>参考</em> <a href="http://blog.sina.com.cn/s/blog_60f01ce50100ffeo.html" target="_blank" rel="external">CSS &lt; a  href&gt;链接样式冲突解决方法！</a></p>

	
	</div>
  <a type="button" href="/2015/11/13/Journals/20151113_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-11-12 </div>
			<div class="article-title"><a href="/2015/11/12/Journals/20151112_log/" >Log_2015-11-12 -- Atom editor,Git pull</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="How_to_install_Atom_in_Gentoo"><a href="#How_to_install_Atom_in_Gentoo" class="headerlink" title="How to install Atom in Gentoo"></a>How to install Atom in Gentoo</h2><p>The package of atom for Gentoo is not available at Atom office site, but source file of which is available. Unfortunately, we will stuck in the <em>compiling module …</em> when we compile the atom source.</p>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><p>Following is the overlay including atom package called <code>aegyipus</code>, which is personal Gentoo overlay.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># run as root</span></span><br><span class="line">layman -o http://aegypius.github.io/overlay/repositories.xml <span class="operator">-f</span> <span class="operator">-a</span> aegypius</span><br><span class="line">emerge atom-bin <span class="comment"># Not atom, it occurs errors when the source is being compiled too!</span></span><br></pre></td></tr></table></figure></p>
<p>If there is no ebuilds to satisfy “atom-bin”, you should update you layman setup.<br>add <code>source /var/lib/layman/make.conf</code> to <code>/etc/portage/make.conf</code>.</p>
<h3 id="Tweak"><a href="#Tweak" class="headerlink" title="Tweak"></a>Tweak</h3><p>If you want to have a live preview for typing markdown text, the shortcut is <code>CTRL_SHIFT_M</code>. If it doesn’t work, open the package option and download <code>preview</code> plugin.</p>
<h2 id="git_fetch_method"><a href="#git_fetch_method" class="headerlink" title="git fetch method"></a><code>git fetch</code> method</h2><p>If we want to keep local up-to-date with ignoring difference between git and local, we have an alternative approach:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@github.com:cynorr/example.git</span><br><span class="line">git fetch --all</span><br><span class="line">git reset --hard origin/master <span class="comment">#origin is your remote repository</span></span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2015/11/12/Journals/20151112_log/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-07-02 </div>
			<div class="article-title"><a href="/2015/07/02/Linux/Configuring_Vim_Editor/" >Configuring Vim Editor</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="my_vimrc"><a href="#my_vimrc" class="headerlink" title="my vimrc"></a>my vimrc</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">syntax on&#10;set number&#10;set tabstop=4&#10;set shiftwidth=4&#10;&#10;set autoindent #&#33258;&#21160;&#32553;&#36827;&#10;inoremap &#123; &#123;&#60;Enter&#62;&#60;Tab&#62;&#60;Enter&#62;&#60;Backspace&#62;&#125;&#60;Esc&#62;kA     #&#39;&#123;&#39;&#33258;&#21160;&#34917;&#20840;</span><br></pre></td></tr></table></figure>
<p>inoremap { {}kA<br>注:inormap是替换的命令,后面的替换前面,既用{}替换{,中间里面直接用键名字代替.kA是光标撤回的位置,以替换后的最后一排为参照点,k是向上,j是向下,和vim的操作命令一样.A是本行末尾,I是开头.</p>
<hr>
<h3 id="Most_useful_shortcuts"><a href="#Most_useful_shortcuts" class="headerlink" title="Most useful shortcuts"></a>Most useful shortcuts</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#34; -----------------   Author: Ruchee&#10;&#34; -----------------    Email: my@ruchee.com&#10;&#34; -----------------  WebSite: http://www.ruchee.com&#10;&#34; -----------------     Date: 2012-05-01&#10;&#34; Ctrl + H                   --&#20809;&#26631;&#31227;&#24403;&#21069;&#34892;&#34892;&#39318;&#10;&#34; Ctrl + J                   --&#20809;&#26631;&#31227;&#19979;&#19968;&#34892;&#34892;&#39318;&#10;&#34; Ctrl + K                   --&#20809;&#26631;&#31227;&#19978;&#19968;&#34892;&#34892;&#23614;&#10;&#34; Ctrl + L                   --&#20809;&#26631;&#31227;&#24403;&#21069;&#34892;&#34892;&#23614;&#10;&#34; Ctrl + C                   --&#32534;&#35793; [&#25903;&#25345;C/C++&#12289;Java&#12289;Haskell]&#10;&#34; Ctrl + R                   --&#36816;&#34892; [&#25903;&#25345;C/C++&#12289;Java&#12289;Haskell&#12289;Lua&#12289;Perl&#12289;Python&#12289;Ruby]&#10;&#34; Ctrl + ]                   --&#36716;&#21040;&#20989;&#25968;&#23450;&#20041;&#10;&#34; Ctrl + T                   --&#36820;&#22238;&#35843;&#29992;&#20989;&#25968;&#10;&#34; Ctrl + E                   --&#19968;&#27493;&#21152;&#36733;&#35821;&#27861;&#27169;&#26495;&#21644;&#20316;&#32773;&#12289;&#26102;&#38388;&#20449;&#24687;&#10;&#10;&#34; &#60;C-P&#62;                      --&#21333;&#35789;&#34917;&#20840;&#10;&#34; &#60;C-X&#62;&#60;C-L&#62;                 --&#25972;&#34892;&#34917;&#20840;&#10;&#34; Tab&#38190;                      --&#25554;&#20837;&#27169;&#24335;&#19979;&#30340;&#20840;&#21151;&#33021;&#35821;&#27861;&#32467;&#26500;&#34917;&#20840; [snipMate&#25554;&#20214;]&#10;&#34; Shift + Insert             --&#21521;Vim&#20013;&#31896;&#36148;&#20174;&#21035;&#22788;&#22797;&#21046;&#30340;&#20869;&#23481;&#10;&#10;&#34; u [&#23567;&#20889;]                   --&#21333;&#27493;&#22797;&#21407; [&#38750;&#25554;&#20837;&#27169;&#24335;]&#10;&#34; U [&#22823;&#20889;]                   --&#25972;&#34892;&#22797;&#21407; [&#38750;&#25554;&#20837;&#27169;&#24335;]&#10;&#10;&#34; jj                         --&#20445;&#23384;&#25991;&#20214;&#24182;&#30041;&#22312;&#25554;&#20837;&#27169;&#24335; [&#25554;&#20837;&#27169;&#24335;]&#10;&#34; kk                         --&#36820;&#22238;Normal&#27169;&#24335; [&#25554;&#20837;&#27169;&#24335;]&#10;&#34; nt                         --&#25171;&#24320;NERDTree [&#38750;&#25554;&#20837;&#27169;&#24335;]&#10;&#34; tl                         --&#25171;&#24320;TagList [&#38750;&#25554;&#20837;&#27169;&#24335;]&#10;&#10;&#34; za                         --&#25171;&#24320;&#25110;&#20851;&#38381;&#24403;&#21069;&#25240;&#21472;&#10;&#34; zM                         --&#20851;&#38381;&#25152;&#26377;&#25240;&#21472;&#10;&#34; zR                         --&#25171;&#24320;&#25152;&#26377;&#25240;&#21472;&#10;&#10;&#34; :set syntax=cpp            --&#25163;&#21160;&#36873;&#25321;&#35821;&#27861;&#39640;&#20142; [&#25110; :set filetype=cpp]&#10;&#10;&#34; :%!xxd                     --&#36716;&#20648;&#20108;&#36827;&#21046;&#25991;&#20214;&#65292;&#20197;&#21313;&#20845;&#36827;&#21046;&#24418;&#24335;&#26174;&#31034;&#10;&#34; :%!xxd -r                  --&#36824;&#21407;&#20108;&#36827;&#21046;&#25991;&#20214;&#10;&#10;&#10;&#34; ---------- &#20027;&#35201;&#25554;&#20214;&#35814;&#32454;&#29992;&#27861;&#35828;&#26126; ---------------------&#10;&#10;&#34; :Tlist                     --&#21628;&#20986;&#21464;&#37327;&#21644;&#20989;&#25968;&#21015;&#34920; [TagList&#25554;&#20214;]&#10;&#34; :LoadTemplate              --&#21628;&#20986;&#35821;&#27861;&#27169;&#26495; [Load_Template&#25554;&#20214;]&#10;&#34; :AuthorInfoDetect          --&#28155;&#21152;&#20316;&#32773;&#12289;&#26102;&#38388;&#31561;&#20449;&#24687; [NERD_commenter &#38;&#38; authorinfo&#25554;&#20214;]&#10;&#10;&#34; ---------- a.vim [&#33258;&#21160;&#20999;&#25442;C/C++&#21516;&#21517;&#22836;&#25991;&#20214;] ----------&#10;&#34;&#10;&#34; :A                         --&#20999;&#25442;&#21516;&#21517;&#22836;&#25991;&#20214;&#24182;&#29420;&#21344;&#25972;&#20010;&#23631;&#24149;&#10;&#34; :AS                        --&#20999;&#25442;&#21516;&#21517;&#22836;&#25991;&#20214;&#24182;&#22402;&#30452;&#20998;&#23631;&#65292;&#22836;&#25991;&#20214;&#22312;&#19978;&#10;&#34; :AV                        --&#20999;&#25442;&#21516;&#21517;&#22836;&#25991;&#20214;&#24182;&#27700;&#24179;&#20998;&#21106;&#65292;&#22836;&#25991;&#20214;&#22312;&#24038;&#10;&#10;&#34; ---------- NERDTree [&#26234;&#33021;&#25991;&#20214;&#27983;&#35272;&#22120;] ----------------&#10;&#34;&#10;&#34; :NERDTree                  --&#21551;&#21160;NERDTree&#25554;&#20214;&#10;&#34; o [&#23567;&#20889;]                   --&#20999;&#25442;&#24403;&#21069;&#25991;&#20214;&#25110;&#30446;&#24405;&#30340;&#25171;&#24320;&#12289;&#20851;&#38381;&#29366;&#24577;&#10;&#34; u                          --&#25171;&#24320;&#19978;&#23618;&#30446;&#24405;&#10;&#34; p [&#23567;&#20889;]                   --&#36820;&#22238;&#19978;&#23618;&#30446;&#24405;&#10;&#34; P [&#22823;&#20889;]                   --&#36820;&#22238;&#26681;&#30446;&#24405;&#10;&#34; K                          --&#36716;&#21040;&#24403;&#21069;&#30446;&#24405;&#31532;&#19968;&#20010;&#33410;&#28857;&#10;&#34; J                          --&#36716;&#21040;&#24403;&#21069;&#30446;&#24405;&#26368;&#21518;&#30340;&#33410;&#28857;&#10;&#34; m                          --&#26174;&#31034;&#25991;&#20214;&#31995;&#32479;&#33756;&#21333; [&#22686;&#12289;&#21024;&#12289;&#31227;]&#10;&#34; ?                          --&#24377;&#20986;&#24110;&#21161;&#33756;&#21333;&#10;&#34; q                          --&#36864;&#20986;&#35813;&#25554;&#20214;&#10;&#10;&#10;&#34; &#23558;&#25152;&#26377;&#20197;.html&#32467;&#23614;&#30340;&#25991;&#26723;&#20197;Django Template&#35821;&#27861;&#36827;&#34892;&#28210;&#26579;&#10;&#34; &#26412;&#37197;&#32622;&#35821;&#21477;&#24517;&#39035;&#25918;&#22312;&#25152;&#26377;&#37197;&#32622;&#30340;&#26368;&#21069;&#38754;&#10;au BufNewFile,BufRead *.html setf htmldjango&#10;&#10;colorscheme elflord          &#34; &#30528;&#33394;&#27169;&#24335;&#10;set guifont=Monaco:h10       &#34; &#23383;&#20307; &#38;&#38; &#23383;&#21495;&#10;set tabstop=4                &#34; &#35774;&#32622;tab&#38190;&#30340;&#23485;&#24230;&#10;set shiftwidth=4             &#34; &#25442;&#34892;&#26102;&#34892;&#38388;&#20132;&#38169;&#20351;&#29992;4&#20010;&#31354;&#26684;&#10;set autoindent               &#34; &#33258;&#21160;&#23545;&#40784;&#10;set backspace=2              &#34; &#35774;&#32622;&#36864;&#26684;&#38190;&#21487;&#29992;&#10;set cindent shiftwidth=4     &#34; &#33258;&#21160;&#32553;&#36827;4&#31354;&#26684;&#10;set smartindent              &#34; &#26234;&#33021;&#33258;&#21160;&#32553;&#36827;&#10;set ai!                      &#34; &#35774;&#32622;&#33258;&#21160;&#32553;&#36827;&#10;set nu!                      &#34; &#26174;&#31034;&#34892;&#21495;&#10;&#34;set showmatch               &#34; &#26174;&#31034;&#25324;&#21495;&#37197;&#23545;&#24773;&#20917;&#10;set mouse=a                  &#34; &#21551;&#29992;&#40736;&#26631;&#10;set ruler                    &#34; &#21491;&#19979;&#35282;&#26174;&#31034;&#20809;&#26631;&#20301;&#32622;&#30340;&#29366;&#24577;&#34892;&#10;set incsearch                &#34; &#24320;&#21551;&#23454;&#26102;&#25628;&#32034;&#21151;&#33021;&#10;set hlsearch                 &#34; &#24320;&#21551;&#39640;&#20142;&#26174;&#31034;&#32467;&#26524;&#10;set nowrapscan               &#34; &#25628;&#32034;&#21040;&#25991;&#20214;&#20004;&#31471;&#26102;&#19981;&#37325;&#26032;&#25628;&#32034;&#10;set nocompatible             &#34; &#20851;&#38381;&#20860;&#23481;&#27169;&#24335;&#10;set vb t_vb=                 &#34; &#20851;&#38381;&#25552;&#31034;&#38899;&#10;&#34;set cursorline              &#34; &#31361;&#20986;&#26174;&#31034;&#24403;&#21069;&#34892;&#10;set hidden                   &#34; &#20801;&#35768;&#22312;&#26377;&#26410;&#20445;&#23384;&#30340;&#20462;&#25913;&#26102;&#20999;&#25442;&#32531;&#20914;&#21306;&#10;set list                     &#34; &#26174;&#31034;Tab&#31526;&#65292;&#20351;&#29992;&#19968;&#39640;&#20142;&#31446;&#32447;&#20195;&#26367;&#10;set listchars=tab:\|\ ,&#10;&#10;syntax enable                &#34; &#25171;&#24320;&#35821;&#27861;&#39640;&#20142;&#10;syntax on                    &#34; &#24320;&#21551;&#25991;&#20214;&#31867;&#22411;&#20390;&#27979;&#10;filetype indent on           &#34; &#38024;&#23545;&#19981;&#21516;&#30340;&#25991;&#20214;&#31867;&#22411;&#37319;&#29992;&#19981;&#21516;&#30340;&#32553;&#36827;&#26684;&#24335;&#10;filetype plugin on           &#34; &#38024;&#23545;&#19981;&#21516;&#30340;&#25991;&#20214;&#31867;&#22411;&#21152;&#36733;&#23545;&#24212;&#30340;&#25554;&#20214;&#10;filetype plugin indent on    &#34; &#21551;&#29992;&#33258;&#21160;&#34917;&#20840;&#10;&#10;set writebackup              &#34; &#35774;&#32622;&#26080;&#22791;&#20221;&#25991;&#20214;&#10;set nobackup&#10;set autochdir                &#34; &#35774;&#23450;&#25991;&#20214;&#27983;&#35272;&#22120;&#30446;&#24405;&#20026;&#24403;&#21069;&#30446;&#24405;&#10;&#34;set nowrap                  &#34; &#35774;&#32622;&#19981;&#33258;&#21160;&#25442;&#34892;&#10;set foldmethod=syntax        &#34; &#36873;&#25321;&#20195;&#30721;&#25240;&#21472;&#31867;&#22411;&#10;set foldlevel=100            &#34; &#31105;&#27490;&#33258;&#21160;&#25240;&#21472;&#10;&#10;set laststatus=2             &#34; &#24320;&#21551;&#29366;&#24577;&#26639;&#20449;&#24687;&#10;set cmdheight=2              &#34; &#21629;&#20196;&#34892;&#30340;&#39640;&#24230;&#65292;&#40664;&#35748;&#20026;1&#65292;&#36825;&#37324;&#35774;&#20026;2&#10;&#10;&#34; &#27599;&#34892;&#36229;&#36807;80&#20010;&#30340;&#23383;&#31526;&#29992;&#19979;&#21010;&#32447;&#26631;&#31034;&#10;au BufRead,BufNewFile *.s,*.asm,*.h,*.c,*.cpp,*.cc,*.java,*.cs,*.erl,*.hs,*.sh,*.lua,*.pl,*.pm,*.php,*.py,*.rb,*.erb,*.vim,*.js,*.css,*.xml,*.html,*.xhtml 2match Underlined /.\%81v/&#10;&#10;&#10;&#34; &#35774;&#32622;&#32534;&#30721;&#10;set fenc=utf-8&#10;set encoding=utf-8&#10;set fileencodings=utf-8,gbk,cp936,latin-1&#10;&#10;&#10;&#34; For Haskell&#10;:let hs_highlight_delimiters=1            &#34; &#39640;&#20142;&#23450;&#30028;&#31526;&#10;:let hs_highlight_boolean=1               &#34; &#25226;True&#21644;False&#35782;&#21035;&#20026;&#20851;&#38190;&#23383;&#10;:let hs_highlight_types=1                 &#34; &#25226;&#22522;&#26412;&#31867;&#22411;&#30340;&#21517;&#23383;&#35782;&#21035;&#20026;&#20851;&#38190;&#23383;&#10;:let hs_highlight_more_types=1            &#34; &#25226;&#26356;&#22810;&#24120;&#29992;&#31867;&#22411;&#35782;&#21035;&#20026;&#20851;&#38190;&#23383;&#10;:let hs_highlight_debug=1                 &#34; &#39640;&#20142;&#35843;&#35797;&#20989;&#25968;&#30340;&#21517;&#23383;&#10;:let hs_allow_hash_operator=1             &#34; &#38459;&#27490;&#25226;#&#39640;&#20142;&#20026;&#38169;&#35823;&#10;&#10;&#10;&#34; ======= &#24341;&#21495; &#38;&#38; &#25324;&#21495;&#33258;&#21160;&#21305;&#37197; ======= &#34;&#10;&#10;:inoremap ( ()&#60;ESC&#62;i&#10;&#10;:inoremap ) &#60;c-r&#62;=ClosePair(&#39;)&#39;)&#60;CR&#62;&#10;&#10;:inoremap &#123; &#123;&#125;&#60;ESC&#62;i&#10;&#10;:inoremap &#125; &#60;c-r&#62;=ClosePair(&#39;&#125;&#39;)&#60;CR&#62;&#10;&#10;:inoremap [ []&#60;ESC&#62;i&#10;&#10;:inoremap ] &#60;c-r&#62;=ClosePair(&#39;]&#39;)&#60;CR&#62;&#10;&#10;&#34;:inoremap &#60; &#60;&#62;&#60;ESC&#62;i&#10;&#10;&#34;:inoremap &#62; &#60;c-r&#62;=ClosePair(&#39;&#62;&#39;)&#60;CR&#62;&#10;&#10;:inoremap &#34; &#34;&#34;&#60;ESC&#62;i&#10;&#10;:inoremap &#39; &#39;&#39;&#60;ESC&#62;i&#10;&#10;:inoremap ` ``&#60;ESC&#62;i&#10;&#10;function ClosePair(char)&#10;    if getline(&#39;.&#39;)[col(&#39;.&#39;) - 1] == a:char&#10;        return &#34;\&#60;Right&#62;&#34;&#10;    else&#10;        return a:char&#10;    endif&#10;endf&#10;&#10;&#10;&#34; MiniBufExplorer     &#22810;&#20010;&#25991;&#20214;&#20999;&#25442; &#21487;&#20351;&#29992;&#40736;&#26631;&#21452;&#20987;&#30456;&#24212;&#25991;&#20214;&#21517;&#36827;&#34892;&#20999;&#25442;&#10;let g:miniBufExplMapWindowNavVim=1&#10;let g:miniBufExplMapWindowNavArrows=1&#10;let g:miniBufExplMapCTabSwitchBufs=1&#10;let g:miniBufExplModSelTarget=1&#10;&#10;&#34; :Tlist              &#35843;&#29992;TagList&#10;let Tlist_Show_One_File=1                    &#34; &#21482;&#26174;&#31034;&#24403;&#21069;&#25991;&#20214;&#30340;tags&#10;let Tlist_Exit_OnlyWindow=1                  &#34; &#22914;&#26524;Taglist&#31383;&#21475;&#26159;&#26368;&#21518;&#19968;&#20010;&#31383;&#21475;&#21017;&#36864;&#20986;Vim&#10;let Tlist_Use_Right_Window=1                 &#34; &#22312;&#21491;&#20391;&#31383;&#21475;&#20013;&#26174;&#31034;&#10;let Tlist_File_Fold_Auto_Close=1             &#34; &#33258;&#21160;&#25240;&#21472;&#10;&#10;&#34; TxtBrowser          &#39640;&#20142;TXT&#25991;&#26412;&#25991;&#20214;&#10;au BufRead,BufNewFile *.txt setlocal ft=txt&#10;&#10;&#34; :LoadTemplate       &#26681;&#25454;&#25991;&#20214;&#21518;&#32512;&#33258;&#21160;&#21152;&#36733;&#27169;&#26495;&#10;let g:template_path=&#39;/home/ruchee/.vim/template/&#39;&#10;&#10;&#34; :AuthorInfoDetect   &#33258;&#21160;&#28155;&#21152;&#20316;&#32773;&#12289;&#26102;&#38388;&#31561;&#20449;&#24687;&#65292;&#26412;&#36136;&#26159;NERD_commenter &#38;&#38; authorinfo&#30340;&#32467;&#21512;&#10;let g:vimrc_author=&#39;Ruchee&#39;&#10;let g:vimrc_email=&#39;my@ruchee.com&#39;&#10;let g:vimrc_homepage=&#39;http://www.ruchee.com&#39;&#10;&#10;&#34; Ctrl + H            &#23558;&#20809;&#26631;&#31227;&#21040;&#24403;&#21069;&#34892;&#30340;&#34892;&#39318;&#10;imap &#60;c-h&#62; &#60;ESC&#62;I&#10;&#10;&#34; Ctrl + J            &#23558;&#20809;&#26631;&#31227;&#21040;&#19979;&#19968;&#34892;&#30340;&#34892;&#39318;&#10;imap &#60;c-j&#62; &#60;ESC&#62;jI&#10;&#10;&#34; Ctrl + K            &#23558;&#20809;&#26631;&#31227;&#21040;&#19978;&#19968;&#34892;&#30340;&#26411;&#23614;&#10;imap &#60;c-k&#62; &#60;ESC&#62;kA&#10;&#10;&#34; Ctrl + L            &#23558;&#20809;&#26631;&#31227;&#21040;&#24403;&#21069;&#34892;&#30340;&#34892;&#23614;&#10;imap &#60;c-l&#62; &#60;ESC&#62;A&#10;&#10;&#34; Ctrl + E            &#19968;&#27493;&#21152;&#36733;&#35821;&#27861;&#27169;&#26495;&#21644;&#20316;&#32773;&#12289;&#26102;&#38388;&#20449;&#24687;&#10;map &#60;c-e&#62; &#60;ESC&#62;:LoadTemplate&#60;CR&#62;&#60;ESC&#62;:AuthorInfoDetect&#60;CR&#62;&#60;ESC&#62;Gi&#10;imap &#60;c-e&#62; &#60;ESC&#62;:LoadTemplate&#60;CR&#62;&#60;ESC&#62;:AuthorInfoDetect&#60;CR&#62;&#60;ESC&#62;Gi&#10;vmap &#60;c-e&#62; &#60;ESC&#62;:LoadTemplate&#60;CR&#62;&#60;ESC&#62;:AuthorInfoDetect&#60;CR&#62;&#60;ESC&#62;Gi&#10;&#10;&#34; jj                  &#20445;&#23384;&#25991;&#20214;&#24182;&#30041;&#22312;&#25554;&#20837;&#27169;&#24335; [&#25554;&#20837;&#27169;&#24335;]&#10;imap jj &#60;ESC&#62;:w&#60;CR&#62;li&#10;&#10;&#34; kk                  &#36820;&#22238;Normal&#27169;&#24335; [&#25554;&#20837;&#27169;&#24335;]&#10;imap kk &#60;ESC&#62;l&#10;&#10;&#34; nt                  &#25171;&#24320;NERDTree [&#38750;&#25554;&#20837;&#27169;&#24335;]&#10;map nt :NERDTree&#60;CR&#62;&#10;&#10;&#34; tl                  &#25171;&#24320;Taglist [&#38750;&#25554;&#20837;&#27169;&#24335;]&#10;map tl :Tlist&#60;CR&#62;&#60;c-l&#62;&#10;&#10;&#10;&#34; ======= &#32534;&#35793; &#38;&#38; &#36816;&#34892; ======= &#34;&#10;&#10;&#34; &#32534;&#35793;&#28304;&#25991;&#20214;&#10;func! CompileCode()&#10;        exec &#34;w&#34;&#10;        if &#38;filetype == &#34;c&#34;&#10;            exec &#34;!gcc -Wall -std=c99 %&#60;.c -o %&#60;&#34;&#10;        elseif &#38;filetype == &#34;cpp&#34;&#10;            exec &#34;!g++ -Wall -std=c++98 %&#60;.cpp -o %&#60;&#34;&#10;        elseif &#38;filetype == &#34;java&#34;&#10;            exec &#34;!javac %&#60;.java&#34;&#10;        elseif &#38;filetype == &#34;haskell&#34;&#10;            exec &#34;!ghc --make %&#60;.hs -o %&#60;&#34;&#10;        elseif &#38;filetype == &#34;lua&#34;&#10;            exec &#34;!lua %&#60;.lua&#34;&#10;        elseif &#38;filetype == &#34;perl&#34;&#10;            exec &#34;!perl %&#60;.pl&#34;&#10;        elseif &#38;filetype == &#34;python&#34;&#10;            exec &#34;!python %&#60;.py&#34;&#10;        elseif &#38;filetype == &#34;ruby&#34;&#10;            exec &#34;!ruby %&#60;.rb&#34;&#10;        endif&#10;endfunc&#10;&#10;&#34; &#36816;&#34892;&#21487;&#25191;&#34892;&#25991;&#20214;&#10;func! RunCode()&#10;        exec &#34;w&#34;&#10;        if &#38;filetype == &#34;c&#34; || &#38;filetype == &#34;cpp&#34; || &#38;filetype == &#34;haskell&#34;&#10;            exec &#34;! ./%&#60;&#34;&#10;        elseif &#38;filetype == &#34;java&#34;&#10;            exec &#34;!java %&#60;&#34;&#10;        elseif &#38;filetype == &#34;lua&#34;&#10;            exec &#34;!lua %&#60;.lua&#34;&#10;        elseif &#38;filetype == &#34;perl&#34;&#10;            exec &#34;!perl %&#60;.pl&#34;&#10;        elseif &#38;filetype == &#34;python&#34;&#10;            exec &#34;!python %&#60;.py&#34;&#10;        elseif &#38;filetype == &#34;ruby&#34;&#10;            exec &#34;!ruby %&#60;.rb&#34;&#10;        endif&#10;endfunc&#10;&#34;&#19979;&#38754;&#30340;&#35821;&#21477;&#21487;&#20197;&#24456;&#26041;&#20415;&#22320;&#23454;&#29616;&#32534;&#35793;&#21644;&#36816;&#34892;&#10;&#34; Ctrl + C &#19968;&#38190;&#20445;&#23384;&#12289;&#32534;&#35793;&#10;map &#60;c-c&#62; :call CompileCode()&#60;CR&#62;&#10;imap &#60;c-c&#62; &#60;ESC&#62;:call CompileCode()&#60;CR&#62;&#10;vmap &#60;c-c&#62; &#60;ESC&#62;:call CompileCode()&#60;CR&#62;&#10;&#10;&#34; Ctrl + R &#19968;&#38190;&#20445;&#23384;&#12289;&#36816;&#34892;&#10;map &#60;c-r&#62; :call RunCode()&#60;CR&#62;&#10;imap &#60;c-r&#62; &#60;ESC&#62;:call RunCode()&#60;CR&#62;&#10;vmap &#60;c-r&#62; &#60;ESC&#62;:call RunCode()&#60;CR&#62;</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2015/07/02/Linux/Configuring_Vim_Editor/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-07-02 </div>
			<div class="article-title"><a href="/2015/07/02/Linux/Gentoo_Android_SDK/" >Gentoo Develop Tools -- Android SDK</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>This section, we will install an android emulator on Linux. Android platform are based on two components: JDK and SDK. We assumed that JDK has been installed well.</p>
<h5 id="1-Download_the_android-sdk-*_frome_Android_offical_site_2C_here_we_use_the_android-sdk_r24-4-1-linux-tgz_version"><a href="#1-Download_the_android-sdk-*_frome_Android_offical_site_2C_here_we_use_the_android-sdk_r24-4-1-linux-tgz_version" class="headerlink" title="1.Download the android-sdk-* frome Android offical site, here we use the android-sdk_r24.4.1-linux.tgz version."></a>1.Download the <code>android-sdk-*</code> frome <a href="http://developer.android.com/sdk/index.html" target="_blank" rel="external">Android offical site</a>, here we use the <code>android-sdk_r24.4.1-linux.tgz</code> version.</h5><h5 id="2-Unpack_it_and_you_will_see_what_likes_following_3A"><a href="#2-Unpack_it_and_you_will_see_what_likes_following_3A" class="headerlink" title="2.Unpack it and you will see what likes following:"></a>2.Unpack it and you will see what likes following:</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">user $ tar -zxvf android-sdk_r24.<span class="number">4.1</span>-linux.tgz</span><br><span class="line">user $ <span class="built_in">cd</span> android-sdk-linux</span><br><span class="line">user $ ls</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> cyno cyno <span class="number">4096</span> Oct <span class="number">14</span> <span class="number">01</span>:<span class="number">57</span> add-ons</span><br><span class="line">drwxr-xr-x  <span class="number">3</span> cyno cyno <span class="number">4096</span> Dec  <span class="number">8</span> <span class="number">21</span>:<span class="number">20</span> build-tools</span><br><span class="line">drwxr-xr-x <span class="number">25</span> cyno cyno <span class="number">4096</span> Dec  <span class="number">8</span> <span class="number">21</span>:<span class="number">26</span> docs</span><br><span class="line">drwxr-xr-x  <span class="number">7</span> cyno cyno <span class="number">4096</span> Dec  <span class="number">8</span> <span class="number">21</span>:<span class="number">32</span> platforms</span><br><span class="line">drwxr-xr-x  <span class="number">5</span> cyno cyno <span class="number">4096</span> Dec  <span class="number">8</span> <span class="number">21</span>:<span class="number">19</span> platform-tools</span><br><span class="line">-rw-r--r--  <span class="number">1</span> cyno cyno <span class="number">1158</span> Oct <span class="number">14</span> <span class="number">01</span>:<span class="number">57</span> SDK Readme.txt</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> cyno cyno <span class="number">4096</span> Dec  <span class="number">8</span> <span class="number">21</span>:<span class="number">33</span> temp</span><br><span class="line">drwxr-xr-x <span class="number">12</span> cyno cyno <span class="number">4096</span> Oct <span class="number">14</span> <span class="number">08</span>:<span class="number">02</span> tools</span><br></pre></td></tr></table></figure>
<h5 id="3-Update_and_Install_the_APIs_that_you_need"><a href="#3-Update_and_Install_the_APIs_that_you_need" class="headerlink" title="3.Update and Install the APIs that you need."></a>3.Update and Install the APIs that you need.</h5><ul>
<li>3.1 Launch android<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user $ <span class="built_in">cd</span> android-sdk-linux/tools/</span><br><span class="line">user $ ./android</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>then you will see the prompt that checks whether the update is available automatically.</p>
<ul>
<li>3.2 Proxy for Region that can’t access Google server.<br>The update and API is on Google’s serve, which cannot be accessed if you are in China or some other region. We can use proxy to deal with this problem.<br>Select menu <code>Tools</code>  -&gt;  <code>Options</code>, then you will see another <code>Settings</code> windows. Configure the proxy like this:<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP Proxy: Server mirrors.neusoft.edu.cn&#10;Proxy Port: 80</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>And active <code>Force https://... sources to be fetched using http:</code></p>
<ul>
<li><p>3.2.2(Alternative) Change hosts temporarily<br>Add the following text to <code>/etc/hosts</code>, and delete after you update and install all you need.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">203.208.46.146 dl.google.com&#10;203.208.46.146 dl-ssl.google.com127.0.0.1 servserv.generals.ea.com&#10;74.125.237.1 dl-ssl.google.com&#10;203.208.46.146 dl.google.com&#10;74.125.237.1 dl-ssl.google.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.Install <code>Platform</code> and <code>Image</code><br>Since the update will run automatically, so we just need to focus on installation of <code>Platform</code> and <code>Image</code>. The rule is simple, you have to install at least 1 platform and each platform should be with at least 1 image. Following is my choice</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------</span><br><span class="line">[*] Android <span class="number">5.1</span>.<span class="number">1</span></span><br><span class="line">     [*] ARM [*] System Image</span><br><span class="line">     [*] Intel x86 Atom System Image</span><br><span class="line">-----------------------------------     </span><br><span class="line">[*] Android <span class="number">4.4</span>.<span class="number">2</span></span><br><span class="line">     [*] ARM [*] System Image</span><br><span class="line">     [*] Intel x86 Atom System Image</span><br><span class="line">-----------------------------------</span><br></pre></td></tr></table></figure>
<ul>
<li>5.Launch android AVD and enjoy it<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user $ <span class="built_in">cd</span> android-sdk-linux/tools/</span><br><span class="line">user $ ./android avd</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>===</p>
<h3 id="PS1-Make_sure_the_KVM_work_well_which_in_the_Linux_kernel"><a href="#PS1-Make_sure_the_KVM_work_well_which_in_the_Linux_kernel" class="headerlink" title="PS1.Make sure the KVM work well which in the Linux kernel"></a>PS1.Make sure the KVM work well which in the Linux kernel</h3><p><strong>KVM</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[*] Virtualization---&gt;</span><br><span class="line">    &lt;*&gt;   Kernel-based Virtual Machine (KVM) support</span><br><span class="line">    &lt;*&gt;     KVM <span class="keyword">for</span> Intel processors support</span><br><span class="line">    &lt; &gt;     KVM <span class="keyword">for</span> AMD processors support</span><br><span class="line">    &lt;M&gt;   Host kernel accelerator <span class="keyword">for</span> virtio net</span><br></pre></td></tr></table></figure></p>
<p><strong>Others</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">General Setup---&gt;</span><br><span class="line">    [*] Control Group support ---&gt;</span><br><span class="line">        [*]   Freezer cgroup subsystem</span><br><span class="line">        [*]   Device controller <span class="keyword">for</span> cgroups</span><br><span class="line">        [*]   Group CPU scheduler</span><br><span class="line">        [*]   Enable perf_event per-cpu per-container group (cgroup) monitoring</span><br><span class="line">        [*]   Block IO controller</span><br><span class="line">        [*]   Resource counters</span><br><span class="line">        [*]     Memory Resource Controller <span class="keyword">for</span> Control Groups (NEW)</span><br><span class="line">        [*]       Memory Resource Controller Swap Extension (NEW)</span><br><span class="line">        [*]       Memory Resource Controller Kernel Memory accounting (EXPERIMENTAL) (NEW)</span><br><span class="line">-*- Networking support---&gt;</span><br><span class="line">      Networking Options---&gt;</span><br><span class="line">        &lt;M&gt; <span class="number">802.1</span>d Ethernet Bridging</span><br><span class="line">        &lt;*&gt; Network priority cgroup</span><br><span class="line">        [*] QoS and/or fair queueing---&gt;</span><br><span class="line">            &lt;M&gt;   Control Group Classifier</span><br><span class="line">        [*] Network packet filtering framework (Netfilter)---&gt;</span><br><span class="line">            &lt;M&gt;   Ethernet Bridge tables (ebtables) support---&gt;</span><br><span class="line">                &lt;M&gt;   ebt: mark target support (NEW)</span><br><span class="line">Device Drivers---&gt;</span><br><span class="line">    Character devices---&gt;</span><br><span class="line">        -*- Unix98 PTY support</span><br><span class="line">        [*]   Support multiple instances of devpts</span><br><span class="line">    [*] Network device support---&gt;</span><br><span class="line">        -*-   Network core driver support</span><br><span class="line">        &lt;M&gt;     Universal TUN/TAP device driver support</span><br><span class="line">Kernel Hacking---&gt;</span><br><span class="line">    [*] Debug Filesystem</span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2015/07/02/Linux/Gentoo_Android_SDK/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-07-02 </div>
			<div class="article-title"><a href="/2015/07/02/Linux/Gentoo-Network/" >Gentoo II NetWork -- Ethernet, Wireless, Shadowsocks</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>It is easy to config the Network for most desktop with just single Ethernet interface, but not easy for laptop with both Ethernet and Wireless interface. Because Wifi supplicant has some conflict with dhcpcd, we should pay more attention to them.</p>
<h2 id="Ethernet__26amp_3B_26amp_3B_Wireless"><a href="#Ethernet__26amp_3B_26amp_3B_Wireless" class="headerlink" title="Ethernet &amp;&amp; Wireless"></a>Ethernet &amp;&amp; Wireless</h2><p>If no requirement for static IP address, we prefer DHCP that can obtain it automatically. <code>dhcp</code> is a popular client that is capable of handing both IPv4 and IPv6 configurations.<br>Firstly install the <code>dhcp</code>, rather than ‘dhcpcd’, which has conflits with <code>NetWorkManager</code>.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge dhcp</span></span><br></pre></td></tr></table></figure></p>
<p><strong>Important</strong>: Don’t add anything to <code>/etc/conf.d/net</code>, and ‘NetworkManager<code>will set</code>dhcp` default;</p>
<p>Then, set the symbol of ethernet and wireless.<br><strong>This is the necessary step.</strong> Without symbol, the <code>NetworkManager</code> would fail to start.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # cd /etc/ini.t&#10;root # ln -s net.lo net.enp2s0&#10;root # ln -s net.lo net.wlp3s0</span><br></pre></td></tr></table></figure></p>
<p><strong>Important</strong>: Don’t add ethernet and wireless to any runlevel, <code>NetworkManager</code> will call them automatically;</p>
<h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><p>Both Wicd and NetworkManager are greatful graphical client on desktop environment, and we prefer Networkmanager. Though wicd is powerful, it has not plugin for panel. However, Networkmanager has a panel client <code>nm-applet</code> as a button in panel, which looks concise.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge networkmanager</span></span><br><span class="line">root <span class="comment"># emerge nm-applet</span></span><br><span class="line">root <span class="comment"># rc-update add NetworkManager default</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Shadowsocks"><a href="#Shadowsocks" class="headerlink" title="Shadowsocks"></a>Shadowsocks</h2><p>Don’t use the shadowsocks-libev in default gentoo portage, which need specify either Ethernet or Wireless manually. The shadowsocks in <code>pip</code> is prefered one.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># emerge dev-python/pip</span></span><br><span class="line">root <span class="comment"># pip install shadowsocks</span></span><br></pre></td></tr></table></figure></p>
<p>Then set the shadowsocks configuration <code>/etc/shadowsocks.json</code> like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#10;        &#34;server&#34;:&#34;128.199.226.255&#34;,&#10;        &#34;server_port&#34;:8388,&#10;        &#34;local_port&#34;:1080,&#10;        &#34;password&#34;:&#34;262524&#34;,&#10;        &#34;timeout&#34;:600,&#10;        &#34;method&#34;:&#34;aes-256-cfb&#34;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>Launch shadowsocks<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># ssclient -c /etc/shadowsocks.json</span></span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2015/07/02/Linux/Gentoo-Network/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-07-01 </div>
			<div class="article-title"><a href="/2015/07/01/Linux/GentooI/" >Gentoo I :Overview and Quick Installation</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="Intruction"><a href="#Intruction" class="headerlink" title="Intruction"></a>Intruction</h2><p><strong>Overview</strong></p>
<p>Gentoo is a fast, modern mate-distrubution with a clean and flexible design, which is build around free software and doesn’t hide from its user what is beneath the hood. Portage, the package maintance system which the Gentoo use, is written in Python, meaning the user can view and modify the source code. Gentoo packaging system uses source code and configuring Gentoo happens with regular text file. In other words, openness everwhere. Welcome to the world of choice and performance.</p>
<p><strong>Quick Installation</strong></p>
<p>In the process of installation, we are provided with GCC, bash and some specific tools, which makes fresh man daunted. In order to help fresh man build their confidence, this paper provide a quick installing tutorial, following which we can build a light version of Gentoo in 2 hours.</p>
<p>Good Luck!</p>
<h2 id="Installation_Structrue"><a href="#Installation_Structrue" class="headerlink" title="Installation Structrue"></a>Installation Structrue</h2><p><strong>Light Version List</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>——Configure——</strong></th>
<th style="text-align:center"><strong>——Value——</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Boot Media</td>
<td style="text-align:center">Minial installation CD</td>
</tr>
<tr>
<td style="text-align:center">Stage Archives</td>
<td style="text-align:center">stage3</td>
</tr>
<tr>
<td style="text-align:center">Boot</td>
<td style="text-align:center">grub2</td>
</tr>
<tr>
<td style="text-align:center">Partitions</td>
<td style="text-align:center">MBR</td>
</tr>
<tr>
<td style="text-align:center">Init</td>
<td style="text-align:center">openRC</td>
</tr>
<tr>
<td style="text-align:center">Desktop</td>
<td style="text-align:center">xfce</td>
</tr>
</tbody>
</table>
<p><strong>Preparation</strong></p>
<ul>
<li>Bootable CD</li>
<li>U disk with stage3</li>
<li>Ethernet Network</li>
</ul>
<p><strong>Steps</strong></p>
<ul>
<li>1.File System: After step 1, we will have base linux environment and chroot</li>
<li>2.Configure the System: After step 2, most necessary configuration files will have been configured</li>
<li>3.Portage &amp; Kernel: After step 3, the portage is ready to use and the linux kernel is installed</li>
<li>4.Bootloader: After step 4, we can boot the gentoo without the Installation CD</li>
<li>5.Desktop: After step 5, we will have graphical environment and xfce desktop environment</li>
</ul>
<hr>
<h2 id="Step1_3A_File_System"><a href="#Step1_3A_File_System" class="headerlink" title="Step1: File System"></a>Step1: File System</h2><p><strong>Preparing the disk</strong></p>
<p>Firstly, we split the full disk into several partitions using MBR partitioning technology.</p>
<p><code>fdisk</code> is a popular and powerful tool to split the disk into partitions. Fire up <code>fdisk</code> aginst the disk (in our example, we use /dev/sda)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # fdisk /dev/sda</span><br></pre></td></tr></table></figure></p>
<p>type <code>p</code> to display the disks’ current partition configuration<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command (m for help): p&#10;Disk /dev/sda: 240 heads, 63 sectors, 2184 cylinders&#10;Units = cylinders of 15120 * 512 bytes&#10;&#10;   Device Boot    Start       End    Blocks   Id  System&#10;/dev/sda1   *         1        14    105808+  83  Linux&#10;/dev/sda2            15        49    264600   82  Linux swap&#10;/dev/sda3            50        70    158760   83  Linux&#10;/dev/sda4            71      2184  15981840    5  Extended</span><br></pre></td></tr></table></figure></p>
<p>First remove all existing partitions from the disk. Type <code>d</code> to delete a partition. For instance, to delete an existing /dev/sda1:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command (m for help): d&#10;Partition number (1-4): 1</span><br></pre></td></tr></table></figure></p>
<p>First create a very small BIOS boot partition. Type <code>n</code> to create a new partition, then <code>p</code> to select a primary partition, followed <code>1</code> to select the first primary partition. Make sure it starts from 2048 and hit <code>enter</code>. When prompted for the last sector , type <code>+128M</code> to create a partion 128 Mbyte in size:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command (m for help): n&#10;Command action&#10;  e   extended&#10;  p   primary partition (1-4)&#10;p&#10;Partition number (1-4): 1&#10;First sector (64-10486533532, default 64): 2048&#10;Last sector, +sectors +size&#123;M,K,G&#125; (4096-10486533532, default 10486533532): +128M</span><br></pre></td></tr></table></figure></p>
<p>Type <code>a</code> to toggle the bootable flag on a partition and select <code>1</code>. After pressing <code>p</code>, notice that an <strong>*</strong> is placed in <strong>Boot</strong> column.</p>
<p>Then, create the root partition. To create root partition, type <code>n</code> to create a new partition, then <code>p</code> to tell <code>fdisk</code> to create a primary partition. Then type <code>2</code> to create the second primary partition, <strong>/dev/sda2</strong>. When prompted for the first sector, hit <code>Enter</code>. When prompted for the last sector, hit <code>Enter</code> to create a partition that takes up the rest of the remaining space on the disk. After completing these steps, type <code>p</code> should display a partition table that looks similar to this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command (m for help): p&#10;Disk /dev/sda: 30.0 GB, 30005821440 bytes&#10;240 heads, 63 sectors/track, 3876 cylinders&#10;Units = cylinders of 15120 * 512 = 7741440 bytes&#10;&#10;   Device Boot    Start       End    Blocks   Id  System&#10;/dev/sda1   *          1       14    105808+  83  Linux&#10;/dev/sda2            15      3876  28690200   83  Linux</span><br></pre></td></tr></table></figure></p>
<p>To save the partition loyout and exit <code>fdisk</code>, type <code>w</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command (m for help): w</span><br></pre></td></tr></table></figure></p>
<p>Finally, make the boot partition (/dev/sda1) in ext2 and root partition (/dev/sda2) in ext4:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # make.ext2 /dev/sda1&#10;root # make.ext4 /dev/sda2</span><br></pre></td></tr></table></figure></p>
<p><strong>Installing the Stage3</strong><br>First mount the disk and U disk with stage3, type <code>fdisk -l</code> to check the U disk partition( our example is /dev/sdb1)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/sda2 /mnt/gentoo&#10;&#10;mkdir /mnt/gentoo/boot&#10;mount /dev/sda1 /mnt/gentoo/boot&#10;&#10;mkdir /mnt/gentoo/usb&#10;mount /dev/sdb1 /mnt/gentoo/usb</span><br></pre></td></tr></table></figure></p>
<p>Then copy the stage3 file to root directory and unpack in root directory<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # cd /mnt/gentoo/&#10;root # cp usb/stage3-*.tar.bz2 ./&#10;root # tar xvjpf starge3-*.tar.bz2</span><br></pre></td></tr></table></figure></p>
<p><strong>Chroot</strong><br>We need to copy the network configuration file and mount some specfic system partition before chrooting.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # cp -L /etc/resolv.conf /mnt/gentoo/etc/&#10;root # mount -t proc proc /mnt/gentoo/proc&#10;root # mount --rbind /sys /mnt/gentoo/sys&#10;root # mount --rbind /dev /mnt/gentoo/dev</span><br></pre></td></tr></table></figure></p>
<p>Then chroot and reload the system environment variables<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # chroot /mnt/gentoo /bin/bash&#10;root # source /etc/profile</span><br></pre></td></tr></table></figure></p>
<h2 id="Step2_Configuring_the_System"><a href="#Step2_Configuring_the_System" class="headerlink" title="Step2 Configuring the System"></a>Step2 Configuring the System</h2><p>Set the password<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root <span class="comment"># passwd</span></span><br></pre></td></tr></table></figure></p>
<p>To optimize Gentoo, it is possible to set a couple of variables which impact Portage behavior. All those variables can be set as environment variables. To keep the settings, Portage reads in the <strong>/etc/portage/make.conf</strong> file, a configuration file for Portage.</p>
<p>Fire up an editor (without <code>vim</code> here, we use <code>nano</code>) to alter the optimization variables.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # nano -w /etc/portage/make.conf</span><br></pre></td></tr></table></figure></p>
<p><strong>Configuring the compile options</strong></p>
<p>A first setting <code>-march=</code> flag, which specifies the name of the target architecture. A common used value is <code>native</code> as that tell the compiler to select the target architecture of current system.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFLAGS=&#34;-march=native -O2 -pipe&#34;&#10;CXXFLAGS=&#34;$&#123;CFLAGS&#125;&#34;</span><br></pre></td></tr></table></figure></p>
<p>The <code>MAKEOPTS</code> variable defines how many parallel compilations should occur when installing a package. A good choice is the number threads in the system plus one. For instance, the hyperthread i5-3230M with 4 threads( 2 cores), should set <code>5</code> parallel compilations.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MAKEOPTS=&#34;-j5&#34;</span><br></pre></td></tr></table></figure></p>
<p><strong>Configuring the USE flag</strong><br><code>USE</code> is one of the most powerful variables Gentoo provides to its users. Several programmes can be compiled with or without optional support for certain items. Most of <code>xfce</code> desktop users will want to set the following:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE=&#34;X dbus jpeg lock session startup-notification thunar udev -gnome -kde -minimal -qt4</span><br></pre></td></tr></table></figure></p>
<p><strong>Graphic Configuration</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VIDEO_CARDS=&#34;intel nvidia&#34; # Don&#39;t add i915 or i965, which would cause issue on slim&#10;INPUT_DEVICES=&#34;evdev&#34;</span><br></pre></td></tr></table></figure></p>
<p><strong>Selecting mirrors</strong><br>In order to download source code quickly it is recommended to select a fast mirror. we should surf Gentoo mirror list and search for a mirror that is close to the system’s physical location.<br>First back to boot installing CD environment, which provided a nice tool called <code>mirrorselect</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # exit</span><br></pre></td></tr></table></figure></p>
<p>then select the fast mirror by <code>direction key</code> and <code>Enter</code>.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # mirror -i -o &#62;&#62; /mnt/gentoo/etc/portage/make.conf&#10;root # mirror -i -r -o &#62;&#62; /mnt/gentoo/etc/portage/make.conf</span><br></pre></td></tr></table></figure></p>
<p>Final chroot again<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # chroot /mnt/gentoo /bin/bash&#10;root # source /etc/profile</span><br></pre></td></tr></table></figure></p>
<p><strong>Select Profile &amp; Locale</strong><br>We select <code>default/linux/amd64/13.0/desktop</code> without <code>gnome</code> or <code>kde</code>, since we will use <code>xfce</code> desktop.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # eselect profile list&#10;root # eselect profile set 3</span><br></pre></td></tr></table></figure></p>
<p>It is now time to set the system-wide locale settings. We Strongly suggest to use at least one UTF-8 locale because some applications may require it. Here, we use <code>en_US.utf-8</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # eselect locale list&#10;root # eselect locale set 239</span><br></pre></td></tr></table></figure></p>
<p><strong>Configuring the Network</strong><br>In this tutorial, we use <code>dhcp</code>. We specfic the dhcp settings right now and install <code>dhcp</code> after syncing the portage tree.<br>First check the net port by typing <code>ifconfig</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # ifconfig&#10;&#10;enp2s0: flags=4163&#60;UP,BROADCAST,RUNNING,MULTICAST&#62;  mtu 1500&#10;        inet 192.168.1.101  netmask 255.255.255.0  broadcast 192.168.1.255&#10;        inet6 fe80::fabc:12ff:fe80:ada3  prefixlen 64  scopeid 0x20&#60;link&#62;&#10;        ether f8:bc:12:80:ad:a3  txqueuelen 1000  (Ethernet)&#10;        RX packets 81407  bytes 116649996 (111.2 MiB)&#10;        RX errors 0  dropped 0  overruns 0  frame 0&#10;        TX packets 46215  bytes 3370975 (3.2 MiB)&#10;        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0&#10;&#10;lo: flags=73&#60;UP,LOOPBACK,RUNNING&#62;  mtu 65536&#10;        inet 127.0.0.1  netmask 255.0.0.0&#10;        inet6 ::1  prefixlen 128  scopeid 0x10&#60;host&#62;&#10;        loop  txqueuelen 0  (Local Loopback)&#10;        RX packets 3144  bytes 1874421 (1.7 MiB)&#10;        RX errors 0  dropped 0  overruns 0  frame 0&#10;        TX packets 3144  bytes 1874421 (1.7 MiB)&#10;        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure></p>
<p>The <code>enp2s0</code> is the Ethernet port flag, set the connecting method as <code>dhcp</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # echo &#34;config_enp2s0=`dhcp`&#34; &#62; /etc/conf.d/net</span><br></pre></td></tr></table></figure></p>
<p>To have the network interfaces activated at boot, they need to be added to the default runlevel.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # cd /etc/init.d/&#10;root # ln -s net.lo net.enp2s0&#10;root # rc-update add net.enp2s0 default</span><br></pre></td></tr></table></figure></p>
<p><strong>Configuring the fstab</strong><br>Under Linux, all partitions used by the system must be listed in <strong>/etc/fstab</strong>, the <strong>/boot</strong> and <strong>/root</strong> partitions must be mounted automatically.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano -w /etc/fstab</span><br></pre></td></tr></table></figure></p>
<p>Below is a example of an <strong>/etc/fstab</strong> file:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/dev/sda1   /boot        ext2    defaults,noatime     0 2&#10;/dev/sda2   /            ext4    noatime              0 1&#10;&#10;/dev/cdrom  /mnt/cdrom   auto    noauto,user          0 0</span><br></pre></td></tr></table></figure></p>
<h2 id="Step3_3A_Portage__26amp_3B_Kernel"><a href="#Step3_3A_Portage__26amp_3B_Kernel" class="headerlink" title="Step3: Portage &amp; Kernel"></a>Step3: Portage &amp; Kernel</h2><p><strong>Installing a portage snapshot</strong><br>A Portage snapshot is a collection file that inform portage what software title are availabe to use, which profiles the adminintractor can select, etc.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge-webrsync&#10;root # emerge --sync</span><br></pre></td></tr></table></figure></p>
<p><strong>Configuring the Kernel</strong><br>First installing the source:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge gentoo-sources</span><br></pre></td></tr></table></figure></p>
<p>We use <code>genkernel</code> to configure the kernel to automatically build the kernel right here, and more information and knowledge about kernel will be following chapter.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge genkernel&#10;root # genkernel all</span><br></pre></td></tr></table></figure></p>
<h2 id="Step4_3A_Bootloader"><a href="#Step4_3A_Bootloader" class="headerlink" title="Step4: Bootloader"></a>Step4: Bootloader</h2><p>The bootloader is responsible for firing up the Linux Kernel upon boot-without it, the system would not know how to proceed when the power button has been pressed.</p>
<p>GRUB2 is provided through the <code>sys-boot/grub</code> package:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge grub</span><br></pre></td></tr></table></figure></p>
<p>Next, install the necessary GRUB2 files in <strong>/boot/grub</strong>. Assuming the first disk is <strong>/dev/sda</strong>, the following command will do this :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # grub2-install /dev/sda</span><br></pre></td></tr></table></figure></p>
<p>(Optional) To generate the final GRUB2 configuration, run the <code>grub2-mkconfig</code> command:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # grub2-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure></p>
<p>Reboot directly, and the installing CD will umount all mounted partitions automatically.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # reboot</span><br></pre></td></tr></table></figure></p>
<h2 id="Step5_3A_Desktop"><a href="#Step5_3A_Desktop" class="headerlink" title="Step5: Desktop"></a>Step5: Desktop</h2><p>At first, we should install X-server. Xorg is the X Window server which allows users to have a graphical environment.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge xorg-drivers&#10;root # emerge xorg-x11</span><br></pre></td></tr></table></figure></p>
<p><code>Xfce</code> is a fast lightweight but full-featured desktop environment.<br><strong>xfce</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge xfce4-meta xfce4-notifyd xfce4-panel xfce4-terminal</span><br></pre></td></tr></table></figure></p>
<p><strong>lxdm loginer</strong><br><code>lxdm</code> is one of the login manager, Simple Login Managert.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge lxde-base/lxdm</span><br></pre></td></tr></table></figure></p>
<p><strong>Making lxdm / xfce autoboot</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # vim /etc/conf.d/xdm</span><br></pre></td></tr></table></figure></p>
<p>Set <code>DISPLAYMANAGER</code> as <code>lxdm</code>, and add xdm to autoboot list:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # rc-update add xdm default</span><br></pre></td></tr></table></figure></p>
<p>Install <code>dbus</code> and set it autoboot, otherwise slim can’t wake xfce up.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # emerge dbus&#10;root # rc-update add dbus default&#10;root # /etc/init.d/dbus start</span><br></pre></td></tr></table></figure></p>
<p>Final make lxdm launch xfce, specify the configurations file of lxdm.<br>Following are some necessary settings of <code>/etc/lxdm/lxdm.conf</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session=/usr/bin/startxfce4&#10;autologin=cyno</span><br></pre></td></tr></table></figure></p>
<h2 id="Step6_3A_Add_non-root_user"><a href="#Step6_3A_Add_non-root_user" class="headerlink" title="Step6: Add non-root user"></a>Step6: Add non-root user</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root # useradd -d /home/cyno -m cyno&#10;root # passwd cyno&#10;root # usermod -G wheel,audio cyno&#10;root # gpasswd -a cyno wheel&#10;root # chmod +s /bin/su</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2015/07/01/Linux/GentooI/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-06-26 </div>
			<div class="article-title"><a href="/2015/06/26/Linux/sync/" >Rsync+Sersync实现服务器数据单向触发式同步</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>##简介<br>触发式同步也称为实时同步,即当源端文件改变时,监控工具立刻触发同步程序,精确快速的将改变的文件推送到目标端,保证最小运行消耗的前提下实现目标端与源端统一.搭建实时同步架构是搭建多人协作平台的主要途径,也是数据备份避免无法补救灾难的重要措施.本文介绍基于rsync同步算法的触发实时同步组合Rsync+Sersync,实现大数量级多文件层数据高速灵敏实时同步.</p>
<p>Rsync 是用于取代rcp的一个工具，使用Rsync 算法来使本地和远程两个主机之间的文件统一，该算法只传送源端与目标端的不同部分，而不是每次都整份传送，因此提高了同步速度。sersync是基于inotify的监听工具,可以记录下被监听目录中发生变化的（包括增加、删除、修改）具体文件或目录，源端数据发生改变时触发推送,达到实时同步。除本文介绍的组合,还有另一种主流同步组合Rsync+Inotify,两个组合主要区别在于监控触发工具Inotify和Sersync,下面阐述两个监控触发工具的不同点:</p>
<ul>
<li>1.Inotify只能记录下被监听的目录变化,sersync可以记录下被监听目录下具体文件变化,Inotify是对被修改的文件直属文件夹整个重新备份,造成资源浪费,而Sersync能精确到具体文夹.</li>
<li>2.sersync是使用c++编写，Inotify为脚本语言,两者相比sersync具有更高的规范性和执行效率.</li>
<li>3.sersync支持同时向多个服务器(vps)实时同步.<br>综上,在性能,速度,功能上Rsync+Sersync组合都优于Rsync+Inotify.</li>
</ul>
<p>##主要步骤<br><strong>源端:</strong>源端不需要ip地址,所以其应用范围比较广,即可以实现静态ip的服务器,也可以实现动态ip的个人主机.<br><strong>目标端:</strong>务必具备局域网和公网的IP,目标端可以是本地服务器也可以是vps.<br><strong>同步方式</strong>:支持一个源端向多个目标端同步,也支持多个源端向一个目标端同步.<br><strong>权限:</strong>源端和目标端均没有强制root权限要求,但是为了保证安全性,优先使用root权限.</p>
<p>下面用下列配置进行方法说明:</p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:center">源端</th>
<th style="text-align:right">目标端</th>
</tr>
</thead>
<tbody>
<tr>
<td>系统</td>
<td style="text-align:center">Fedora21</td>
<td style="text-align:right">CentOS</td>
</tr>
<tr>
<td>性质</td>
<td style="text-align:center">个人主机/服务器</td>
<td style="text-align:right">服务器/VPS</td>
</tr>
<tr>
<td>权限</td>
<td style="text-align:center">Root</td>
<td style="text-align:right">普通用户/root</td>
</tr>
<tr>
<td>IP</td>
<td style="text-align:center">动态/静态</td>
<td style="text-align:right">107.170.213.95</td>
</tr>
<tr>
<td>路径</td>
<td style="text-align:center">/home/user1/source/</td>
<td style="text-align:right">/home/user2/target/</td>
</tr>
</tbody>
</table>
<ul>
<li>Step1:建立源端向目标端的SSH信任,实现单向免密码直连</li>
<li>Step2:在目标端设立监听与接收端口</li>
<li>Step3:在源端建立实时推送</li>
</ul>
<h2 id="u5177_u4F53_u5B9E_u73B0"><a href="#u5177_u4F53_u5B9E_u73B0" class="headerlink" title="具体实现"></a>具体实现</h2><p>###Step1:建立源端到目标端SSH信任</p>
<p>源端:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span></span><br><span class="line">rm -rf .ssh</span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/user1/.ssh/id_rsa):   <span class="comment">#回车</span></span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):    <span class="comment">#回车</span></span><br><span class="line"><span class="built_in">eval</span> `ssh-agent`  <span class="comment">#是～键上的那个`</span></span><br><span class="line">ssh-add</span><br><span class="line"></span><br><span class="line"><span class="comment">#此时本机SSH Key已经生成,默认公钥位置: .ssh/id_rsa.pub,将其拷贝至目标端</span></span><br><span class="line">scp .ssh/id_rsa.pub user2@<span class="number">107.170</span>.<span class="number">213.95</span>:.ssh/authorized_keys  <span class="comment">#如果目标端无.ssh目录,自行在目标端建立在执行此命令</span></span><br></pre></td></tr></table></figure>
<p>本文使用DigitalOcean虚拟机作目标端,因此除了向系统里添加公钥,还需向DigitalOcean官网设置里添加公钥,此公钥也可用于Github.</p>
<p>###Step2:在目标端设立监听与接收端口<br>登录至目标端:</p>
<ul>
<li>2.1关闭SELINUX</li>
<li>2.2关闭ip防火墙</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">su  <span class="comment">#需要借用root权限</span></span><br><span class="line">vim /etc/selinux/config  </span><br><span class="line"></span><br><span class="line"><span class="comment">#找到以下两行并注释掉:</span></span><br><span class="line">SELINUX=enforcing</span><br><span class="line">SELINUXTYPE=targeted</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加下列一行:</span></span><br><span class="line">SELINUX=disabled</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭ip防火墙</span></span><br><span class="line">systemctl stop firewalld.service (暂时关闭)</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service(永久关闭)</span><br></pre></td></tr></table></figure>
<ul>
<li>2.3安装Rsync</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install rsync -y  #&#23433;&#35013;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>2.4配置rsync文件<br>配置参数是关键步骤,务必仔细.</strong>rsync的配置文件分全局参数和模块参数,其中模块就是指仓库,一个库只允许一个源端同步,但是rsync可以建立多个库,实现多个源端同时向一个目标端同步.每个库主要由库名,存放路径,库管理员组成.全局参数决定rsync运行的维护者和性能.参数文件具体如下:<br>文件存放位置: <strong>/etc/rsyncd.conf</strong>,如果没自动生成,请手动创建</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#全局参数</span></span><br><span class="line"> uid = root</span><br><span class="line"> gid = root</span><br><span class="line"> use chroot = yes</span><br><span class="line"> max connections = <span class="number">4</span></span><br><span class="line"> <span class="built_in">log</span> file = /home/user2/<span class="built_in">log</span>       <span class="comment"># &lt;-----日志文件,用于调试,路径自设</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#模块,可以设置多个</span></span><br><span class="line"> [myhub1]                         <span class="comment"># &lt;-----(重要)库名,作源端参数</span></span><br><span class="line"> path = /home/cyno/target/        <span class="comment"># &lt;-----库位置,打开读写权限</span></span><br><span class="line"> comment = PC back up             <span class="comment"># &lt;-----库说明</span></span><br><span class="line"> ignore errors = yes                </span><br><span class="line"> <span class="built_in">read</span> only = no                   <span class="comment"># &lt;-----(重要)关闭只读</span></span><br><span class="line"> auth users = admin1              <span class="comment"># &lt;-----(重要)管理员姓名,下一步为管理员设置密码,作源端参数</span></span><br><span class="line"> secrets file = /etc/rsyncd.secret<span class="comment"># &lt;-----(重要)存储管理员和密码,做源端参数</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>2.5设置库管理员密码</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#34;admin1:1234&#34;  &#62;&#62; /etc/rsyncd.secret # &#60;-----&#36335;&#24452;&#20026;&#37197;&#32622;&#25991;&#20214;&#37324;&#30340;secrets file&#10;                                          # &#60;-----&#26684;&#24335;&#20026;&#34;name:key&#34;,&#20013;&#38388;&#29992;&#20882;&#21495;&#38548;&#24320;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>2.6配置文件设置权限</strong><br>否则rsync会因安全问题启动失败.两个配置文件的读写权只属于uid和gid用户,本次uid和gid用户设为root所以配置文件的读写权管理者为root,如果uid和gid用户为某个普通用户,则读写权限只属于该普通用户.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 600 rsyncd.conf rsyncd.secret</span><br></pre></td></tr></table></figure>
<ul>
<li>2.7启动目标端rsync监听</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su&#10;rsync --daemon --config=/etc/rsyncd.conf   #&#21487;&#20197;&#28155;&#21152;&#30340;&#24320;&#26426;&#33258;&#21551;&#21160;</span><br></pre></td></tr></table></figure>
<p>###Step3:在源端建立实时推送</p>
<ul>
<li>3.1安装rsync和配置文件:<br>源端安装rsync与目标端不同,目标端安装rsync是为了建立仓库和传送,需要配置仓库参数,而源端安装rsync只为传送,只需配置全局变量.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#23433;&#35013;&#10;sudo yum install rsync -y</span><br></pre></td></tr></table></figure>
<pre><code>配置文件路径(/etc/rsyncd.conf),内容如下:
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#20840;&#23616;&#21442;&#25968;&#10; uid = root       &#10; gid = root&#10; use chroot = yes&#10; max connections = 4&#10; log file = /home/user2/log  #&#26085;&#24535;&#25991;&#20214;,&#29992;&#20110;&#35843;&#35797;,&#36335;&#24452;&#33258;&#35774;</span><br></pre></td></tr></table></figure>
<ul>
<li>3.2安装Sersync:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://sersync.googlecode.com/files/sersync2.<span class="number">5.4</span>_64bit_binary_stable_final.tar.gz <span class="comment">#需要翻墙</span></span><br><span class="line">tar -zxvf sersync2.<span class="number">5.4</span>_64bit_binary_stable_final.tar.gz   </span><br><span class="line"></span><br><span class="line"><span class="comment">#得到GUN-linux-x86文件夹(很奇怪的命名),文件夹里只有两个文件,参数文件*confxml.xml*和可执行文件*sersync2*.</span></span><br><span class="line"></span><br><span class="line">mv GUN-Linux-x86 /uer/<span class="built_in">local</span>/sersync</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>3.3配置Sersync参数文件<br>配置参数是关键步骤,务必仔细.</strong>参数文件很长,但是需要设置的地方却很少,主要实现和Step2的目标仓库端口进行对接.为了方便观看,本文只列出需要修改的地方,内容如下:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;sersync&gt;</span><br><span class="line">	&lt;localpath watch=<span class="string">"/home/user1/source/"</span>&gt;    <span class="comment"># &lt;---源端需要同步的文件夹</span></span><br><span class="line">	    &lt;remote ip=<span class="string">"107.170.213.95"</span> name=<span class="string">"myhub1"</span>/&gt; <span class="comment"># &lt;---目标端Ip,目标端模块name,与Step2.4模块名统一</span></span><br><span class="line">	    &lt;!--&lt;remote ip=<span class="string">"192.168.8.39"</span> name=<span class="string">"tongbu"</span>/&gt;--&gt;  <span class="comment"># &lt;---可以设置多个目标端,多份备份,</span></span><br><span class="line">	    &lt;!--&lt;remote ip=<span class="string">"192.168.8.40"</span> name=<span class="string">"tongbu"</span>/&gt;--&gt;</span><br><span class="line">	&lt;/localpath&gt;</span><br><span class="line">	&lt;rsync&gt;</span><br><span class="line">	    &lt;commonParams params=<span class="string">"-artuz"</span>/&gt;</span><br><span class="line">	    &lt;auth start=<span class="string">"true"</span> users=<span class="string">"admin1"</span> passwordfile=<span class="string">"/etc/rsync.pas"</span>/&gt;  <span class="comment"># &lt;---users为库管理员,与Step2.4库管理员统一,passwordfile为该管理员的密码,每个密码一个文件,详见Step3.4</span></span><br><span class="line">	    &lt;userDefinedPort start=<span class="string">"false"</span> port=<span class="string">"874"</span>/&gt;&lt;!-- port=<span class="number">874</span> --&gt;</span><br><span class="line">	    &lt;timeout start=<span class="string">"false"</span> time=<span class="string">"100"</span>/&gt;&lt;!-- timeout=<span class="number">100</span> --&gt;</span><br><span class="line">	    &lt;ssh start=<span class="string">"false"</span>/&gt;</span><br><span class="line">	&lt;/rsync&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>3.4配置库管理员密码文件</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#34;1234&#34; &#62;&#62; /etc/rsync.pas  # &#60;-----&#23494;&#30721;&#19982;Step2.5&#32479;&#19968;&#10;                               # &#60;-----&#23494;&#30721;&#25991;&#20214;&#36335;&#24452;&#19982;Step2.4 passwordfile&#32479;&#19968;&#10;&#10;chmod 600 /etc/rsync.pas       # &#60;-----(&#37325;&#35201;)&#35774;&#32622;&#26435;&#38480;,&#21542;&#21017;sersync&#20250;&#22240;&#23433;&#20840;&#38382;&#39064;&#26080;&#27861;&#21551;&#21160;</span><br></pre></td></tr></table></figure>
<ul>
<li>3.5启动Sersync</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可以添加到开机自启动</span></span><br><span class="line">sudo /usr/<span class="built_in">local</span>/sersync/sersync2 -r <span class="operator">-d</span> -o  /usr/<span class="built_in">local</span>/sersync/confxml.xml</span><br></pre></td></tr></table></figure>
<p>###Step4:测试<br>在源端向source文件夹下,添加或修改文件,观察目标端target文件夹内容变化.</p>
<p>##参考</p>
<ul>
<li>1.rsync参数:<a href="http://www.cnblogs.com/mchina/p/2829944.html" target="_blank" rel="external">CentOS 6.3下rsync服务器的安装与配置</a></li>
<li>2.sersync应用:<a href="http://code.google.com/p/sersync/" target="_blank" rel="external">sersync - Google Code</a></li>
</ul>

	
	</div>
  <a type="button" href="/2015/06/26/Linux/sync/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2015-06-16 </div>
			<div class="article-title"><a href="/2015/06/16/Linux/VMware/" >VMware WorkStation for linux</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>##简介<br>Linux系统是程序员主要开发环境,但是linux在办公应用方面做的并不完美,比如部分打印机不支持和QQ版本不稳定.为避免双系统频繁切换问题,有必要在linux下安装虚拟街.VMware是目前最优秀的虚拟机,内存读取速度,网速,硬盘读取速度等各个参数完胜VirtualBox,本文介绍Fedora下VMware虚拟机的安装.</p>
<p>##准备工作</p>
<ul>
<li>安装文件:VMware-Workstation-Full-11.1.2-2780323.x86_64.bundle</li>
<li>VMware11永久序列号:1F04Z-6D111-7Z029-AV0Q4-3AEH8</li>
<li><p>配置gtk-2.0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su&#10;#&#23433;&#35013;gtk&#10;yum install gtk* -y&#10;locate pk-gtk-module.so&#10;&#62; /usr/lib/gtk-2.0/modules/pk-gtk-module.so #&#26681;&#25454;&#26597;&#25214;,&#30830;&#23450;gtk-2.0&#30446;&#24405;&#10;&#10;#&#28155;&#21152;modules&#36335;&#24452;&#10;vim /etc/ld.so.conf.d/gtk-2.0.conf #&#26032;&#24314;gtk-2.0-conf&#25991;&#20214;&#10;/usr/lib/gtk-2.0/modules               #&#28155;&#21152;modules&#30446;&#24405;&#10;ldconfig</span><br></pre></td></tr></table></figure>
</li>
<li><p>链接kernel headers</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su&#10;#&#26597;&#25214;linux version&#30446;&#24405;&#10;locate version.h | more&#10;&#62; /usr/include/linux/version.h&#10;&#10;ln -s /usr/include/linux/version.h /lib/modules/3.17.04.fc21.x86_64/build/include/linux/&#10;#&#19978;&#25991;build&#26159;/usr/src/kernel/3.17.04.fc21.x86_64&#30340;&#38142;&#25509;,&#22914;&#26524;&#22833;&#25928;&#38738;&#37325;&#24314;&#38142;&#25509;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>##安装VMware<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod u+x VMware-Workstation-Full-11.1.2-2780323.x86_64.bundle&#10;su&#10;./VMware-Workstation-Full-11.1.2-2780323.x86_64.bundle</span><br></pre></td></tr></table></figure></p>
<p>##安装Win8.1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#26032;&#24314;&#34394;&#25311;&#26426;&#10;&#37197;&#32622;&#31867;&#22411;:&#33258;&#23450;&#20041;(&#39640;&#32423;)&#10;&#30828;&#20214;&#20860;&#23481;&#24615;:workstation11&#10;&#23433;&#35013;&#23458;&#25143;&#26426;&#25805;&#20316;&#31995;&#32479;:&#31245;&#21518;&#23433;&#35013;&#31995;&#32479;&#10;&#36873;&#25321;&#23458;&#25143;&#26426;&#25805;&#20316;&#31995;&#32479;:Win8.1&#36873;windows8&#10;&#21629;&#21517;&#34394;&#25311;&#26426;:&#40664;&#35748;&#10;&#22788;&#29702;&#22120;&#37197;&#32622;:&#22788;&#29702;&#22120;&#25968;&#37327;1,&#27599;&#20010;&#22788;&#29702;&#22120;&#26680;&#24515;&#25968;&#37327;2(&#20010;&#20154;&#20027;&#26426;&#20960;&#20046;&#37117;&#21482;&#26377;1&#21508;&#22788;&#29702;&#22120;,&#26680;&#24515;2&#20010;&#25110;4&#20010;,&#21306;&#26680;&#24515;&#25968;&#37327;&#19968;&#21322;&#21363;&#21487;)&#10;&#20869;&#23384;:3G&#10;&#32593;&#32476;&#31867;&#22411;:NAT(&#31532;&#20108;&#20010;)&#10;I/O&#25511;&#21046;&#22120;:&#40664;&#35748;&#10;&#30913;&#30424;&#31867;&#22411;:SATA(A)&#10;&#36873;&#25321;&#30913;&#30424;:&#21019;&#24314;&#26032;&#30340;&#34394;&#25311;&#30913;&#30424;&#10;&#23481;&#37327;:&#33258;&#23450;,&#25171;&#21246;&#31435;&#21363;&#20998;&#37197;&#30913;&#30424;,&#36873;&#25321;&#23384;&#20648;&#20026;&#21333;&#20010;&#25991;&#20214;&#10;&#33258;&#23450;&#20041;&#30828;&#20214; -&#62; &#26032;CD/DVD -&#62; &#20351;&#29992;ISO&#38236;&#20687;&#25991;&#20214; -&#62; &#36873;&#25321;win8&#38236;&#20687;</span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2015/06/16/Linux/VMware/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2014-10-10 </div>
			<div class="article-title"><a href="/2014/10/10/Linux/GithubPages/" >用Hexo部署GithubPages</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="Hexo_u7B80_u4ECB"><a href="#Hexo_u7B80_u4ECB" class="headerlink" title="Hexo简介"></a>Hexo简介</h3><p>Hexo是一个基于Node.js的静态博客程序，以闪电版的生成速度博得个人博主喜爱。其工作原理非常简单，首先在本地编写博客，然后将博客转化成静态网页，最后将静态网页上传到所需平台。Hexo采用极为高效的markdown格式，避免了排版的繁琐，让作者专注于内容。所生成的静态网页风格支持各个种类的主题提供选择，无论成熟高端黑还是清新小萝莉，都能找到属于自已的主题，当然也可自行修改CSS。更重要的是其生成速度，其编译上百篇文字只需要几秒。除此外，Hexo还可以通过引用成熟的插件库，如评论系统,和Latex公式的扩展。综合其闪电般的生成速度和强大的插件支持，Hexo无疑是静态博客搭建的不二选择。</p>
<h3 id="u5B89_u88C5_u548C_u914D_u7F6EHexo"><a href="#u5B89_u88C5_u548C_u914D_u7F6EHexo" class="headerlink" title="安装和配置Hexo"></a>安装和配置Hexo</h3><h4 id="1-Node-js"><a href="#1-Node-js" class="headerlink" title="1.Node.js"></a>1.Node.js</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#安装GCC编译环境</span></span><br><span class="line">sudo  yum install g++ curl openssl openssl-devel make gcc-c++ glibc-devel -y</span><br><span class="line"></span><br><span class="line"><span class="comment">#下载并安装NodeJs</span></span><br><span class="line">wget http://nodejs.org/dist/node-latest.tar.gz</span><br><span class="line">tar -xvpzf node-latest.tar.gz</span><br><span class="line"><span class="built_in">cd</span> node-v*</span><br><span class="line"></span><br><span class="line">./configure  </span><br><span class="line">make</span><br><span class="line">sudo make install <span class="comment">#编译与安装</span></span><br></pre></td></tr></table></figure>
<h4 id="2-npm_u73AF_u5883"><a href="#2-npm_u73AF_u5883" class="headerlink" title="2.npm环境"></a>2.npm环境</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo curl http://npmjs.org/install.sh | sh&#10;node --version #&#26597;&#30475;NodeJS&#29256;&#26412;</span><br></pre></td></tr></table></figure>
<h4 id="3-_u672C_u5730_u642D_u5EFAhexo"><a href="#3-_u672C_u5730_u642D_u5EFAhexo" class="headerlink" title="3.本地搭建hexo"></a>3.本地搭建hexo</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># as root</span></span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">mkdir blog</span><br><span class="line">hexo init blog</span><br><span class="line"><span class="built_in">cd</span> blog</span><br><span class="line">npm install</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<h4 id="4-_u914D_u7F6E_u5230GithubPages"><a href="#4-_u914D_u7F6E_u5230GithubPages" class="headerlink" title="4.配置到GithubPages"></a>4.配置到GithubPages</h4><ul>
<li>4.1创建仓库<strong>username.github.io</strong>(username必须为github应用名,不能用其他字符串,否则网页打不开)</li>
<li><p>4.2安装Hexo git插件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.3配置<strong>_config.yml</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#1.&#20882;&#21495;&#21518;&#38754;&#26377;&#19968;&#20010;&#31354;&#26684;&#10;#2.repository &#29992;&#20179;&#24211;&#30340;ssh&#10;deploy:&#10;  type: git&#10;  repository: git@github.com:username/username.github.io.git (username&#20026;&#20320;github&#29992;&#25143;&#21517;)&#10;  branch: master</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5-_u8BBE_u7F6E_u57DF_u540D_uFF08optional_uFF09"><a href="#5-_u8BBE_u7F6E_u57DF_u540D_uFF08optional_uFF09" class="headerlink" title="5.设置域名（optional）"></a>5.设置域名（optional）</h4><ul>
<li>在namecheap网站购买域名,用途设置GithubPages(免域名解析的麻烦)</li>
<li>本地source文件夹下创建CNAME文件,内容为购买的域名,去掉www,例如:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyno.me</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="6-Enjoy_it"><a href="#6-Enjoy_it" class="headerlink" title="6.Enjoy it"></a>6.Enjoy it</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>
<h4 id="7-_u66F4_u6362_u76AE_u80A4"><a href="#7-_u66F4_u6362_u76AE_u80A4" class="headerlink" title="7.更换皮肤"></a>7.更换皮肤</h4><ul>
<li>1.下载Theme包,hexo官网或其他论坛</li>
<li>2.解压到 /blog/themes文件夹下</li>
<li>3.更改 blog/_config.yml 中theme:name (name为theme包的文件夹名)</li>
</ul>
<p><strong>安装过程结束，以下是博主主题CSS备份，无关安装</strong></p>
<h3 id="CSS_u5907_u4EFD"><a href="#CSS_u5907_u4EFD" class="headerlink" title="CSS备份"></a>CSS备份</h3><hr>
<h4 id="1-_u8C03_u6574_u8BED_u6CD5_u9AD8_u4EAE_u914D_u8272_u548C_u8FB9_u7F18"><a href="#1-_u8C03_u6574_u8BED_u6CD5_u9AD8_u4EAE_u914D_u8272_u548C_u8FB9_u7F18" class="headerlink" title="1.调整语法高亮配色和边缘"></a>1.调整语法高亮配色和边缘</h4><p><strong> /themes/freemind/source/css/highlight.css</strong><br>更改了background，margin，padding<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pre, .highlight, .gist &#123;  &#10;  background: #1a1a1a !important;&#10;  margin: 0.1em 2%;&#10;  padding: 0.3em 2%;&#10;  overflow: auto;&#10;  color: #fffafa;  &#10;  font-size: 14px;&#10;  text-shadow: none;&#10;  -webkit-border-radius: 4px;&#10;  -moz-border-radius: 4px;&#10;  border-radius: 4px;  &#10;  border-style: solid;&#10;  border-color: #ddd;&#10;  border-width: 1px 0;&#10;  line-height: 20px;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="2-_u8C03_u6574categories_u6837_u5F0F"><a href="#2-_u8C03_u6574categories_u6837_u5F0F" class="headerlink" title="2.调整categories样式"></a>2.调整categories样式</h4><p><strong> /themes/freemind/source/css/style.css</strong><br>添加链接里a下的b样式，主要更改padding右值，margin右值，border宽度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.tag_box a.b &#123;&#10;  padding: 4px 50px 2px 6px;&#10;  margin: 2px 40px 2px 2px;&#10;  background: #e5e5e5;&#10;  color:#555;&#10;  border-radius: 3px;&#10;  text-decoration:none;&#10;  border:0px dashed #bbb;&#10;&#125;&#10;.tag_box a.b span&#123;&#10;  vertical-align:super;&#10;  font-size:0.8em;&#10;&#125;&#10;.tag_box a.b:hover &#123;&#10;  background-color:#397bdd;&#10;  color:#FFF;&#10;&#125;&#10;.tag_box a.b.active &#123;&#10;  background:#57A957;&#10;  border:1px solid #4C964D;&#10;  color:#FFF;&#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后，在框架设置里使用该设置，即在<a href="...">中添加 class=”b”,确定格式：<br><strong>/themes/freemind/layout/_widget/category.ejs</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#60;li&#62;&#60;a href=&#34;&#60;%- config.root %&#62;&#60;%- item.path %&#62; class=&#34;b&#34;&#34;&#62;&#60;%= item.name %&#62;&#60;span&#62;&#60;%= item.   posts.length %&#62;&#60;/span&#62;&#60;/a&#62;&#60;/li&#62;</span><br></pre></td></tr></table></figure></a></p>
<h4 id="3-_u66F4_u6539header_u6E10_u53D8_u989C_u8272"><a href="#3-_u66F4_u6539header_u6E10_u53D8_u989C_u8272" class="headerlink" title="3.更改header渐变颜色"></a>3.更改header渐变颜色</h4><p><strong> /themes/freemind/source/css/style.css</strong><br>更改background: -moz-linear-gradient(top, #333, #1a1a1a 50%); 即header背景从上到下333到1a1a1a渐变，333同主标题背景，1a1a1a同语法高亮背景。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.page-header &#123;&#10;  -webkit-background-clip: border-box;&#10;  -webkit-background-origin: padding-box;&#10;  -webkit-background-size: cover;&#10;  /* background-color: #f5f5f5; */&#10;  padding: 10px 20px 0px 20px;&#10;  margin: -20px -20px 20px;&#10;  background: #333;&#10;  background: -moz-linear-gradient(top, #333, #1a1a1a 50%);&#10;  background: -webkit-gradient(linear, 0 0, 0 50%, from(#333), to(#000));&#10;  color: #e9e9e9;&#10;  border-bottom-left-radius: 0px;&#10;  border-bottom-right-radius: 0px;&#10;  border-top-left-radius: 6px;&#10;  border-top-right-radius: 6px;  &#10;&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>参考</em> <a href="http://blog.sina.com.cn/s/blog_60f01ce50100ffeo.html" target="_blank" rel="external">CSS &lt; a  href&gt;链接样式冲突解决方法！</a></p>

	
	</div>
  <a type="button" href="/2014/10/10/Linux/GithubPages/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2014-06-15 </div>
			<div class="article-title"><a href="/2014/06/15/C/polymorphism_vitualfunction/" >从地址角度看C++多态性</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="u7B80_u4ECB"><a href="#u7B80_u4ECB" class="headerlink" title="简介"></a>简介</h3><p>&#160;&#160; &#160; &#160;<br>多态性可以简单地概括为“一个接口，多种方法”，程序在运行时才决定调用的函数，它是面向对象编程领域的核心概念。多态与非多态的实质区别就是函数地址是早绑定还是晚绑定。为了方便理解，我们将早绑定看作编译时绑定，晚绑定是运行时绑定。<br>
	
	</div>
  <a type="button" href="/2014/06/15/C/polymorphism_vitualfunction/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2014-05-02 </div>
			<div class="article-title"><a href="/2014/05/02/TopicModel/TopicModel1/" >TopicModel(1):主题模型概述</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h3 id="u7B80_u4ECB"><a href="#u7B80_u4ECB" class="headerlink" title="简介"></a>简介</h3><p>&#160;&#160; &#160; &#160; 主题模型，顾名思义，就是对文字中隐含主题的一种建模方法。还是上面的例子，“苹果”这个词的背后既包含是苹果公司这样一个主题，也包括了水果的主题。当我们和第一句进行比较时，苹果公司这个主题就和“乔布斯”所代表的主题匹配上了，因而我们认为它们是相关的。<br>
	
	</div>
  <a type="button" href="/2014/05/02/TopicModel/TopicModel1/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2014-02-01 </div>
			<div class="article-title"><a href="/2014/02/01/Linux/Github2/" >Github使用详解</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>##Git简介<br>Git 是 Linus 在开发 Linux 内核时用于替换 Bitkeeper 版本控制工具而写的一个开源的分布式版本控制软件。而Github 是一个代码托管网站。而代码托管的意思是允许人们把代码放到 Github ，并为团队开发提供一种比较简单的代码同步方法。在git里，每个代码库在相互独立的同时，又可以相互交换代码（通过push/pull）进行代码的交换。</p>
<p>##文件状态与实例<br>在Git中，文件只有三种状态，已修改，已暂存和已提交。这三个文件分别放在工作区，暂存区域和git目录。当一个文件修改完毕之后，它仍然在工作目录；只有当它被add之后，才会进入暂存区域，文件状态变为已暂存；最后，当文件被 commit之后，它就会进去git目录区域。下面我们举一个具体实例:</p>
<blockquote>
<p>假设工作区中有main.cpp和ReadMe两个文件,需要把工作区同步到Git,并且新建模块function.cpp.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add -A #&#28155;&#21152;&#25152;&#26377;&#25991;&#20214;&#21040;&#26242;&#23384;&#21306;&#10;git commit -m &#39;Main Function&#39; #&#25552;&#20132;&#25991;&#20214;&#21040;Git&#30446;&#24405;&#10;git status #&#26597;&#30475;&#23558;&#35201;&#25552;&#20132;&#30340;&#25805;&#20316;&#10;&#10;git remote add origin git@github.com:cynorr/Test.git #Test.git&#30340;&#36828;&#31243;&#31471;&#10;git push -u origin master #&#25512;&#36865;&#21040;Test&#25152;&#26377;&#20998;&#25903;,-u&#21442;&#25968;&#30340;&#20316;&#29992;&#26159;&#21516;&#26102;&#26356;&#26032;&#20027;&#20998;&#25903;&#21644;&#32487;&#25215;&#20027;&#20998;&#25903;&#30340;&#25152;&#26377;&#20998;&#25903;</span><br></pre></td></tr></table></figure>
<p>至此,主函数的同步已经完成,下面添加模块function.cpp<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim function.cpp #&#22312;&#24037;&#20316;&#21306;&#21019;&#24314;&#27169;&#22359;function.cpp,&#27169;&#22359;&#20869;&#23481;&#33258;&#23450;,&#26412;&#25991;&#21482;&#20316;&#28436;&#31034;&#10;git checkout -b func #&#26032;&#24314;&#26412;&#22320;func&#20998;&#25903;,&#24182;&#20999;&#25442;&#21040;func&#20998;&#25903;&#10;git remote origin func #&#26032;&#24314;Git func&#20998;&#25903;&#10;&#10;git add function.cpp  &#10;git commit -m &#39;New Function&#39;&#10;git push origin func #&#23558;&#26032;&#24314;&#27169;&#22359;&#25512;&#36865;&#21040;func&#20998;&#25903;&#10;&#10;git checkout master&#10;git merge func #&#21512;&#24182;func&#20998;&#25903;&#21040;&#20027;&#20998;&#25903;&#10;git push origin master #&#25226;&#21512;&#24182;&#30340;&#20998;&#25903;&#25512;&#36865;&#21040;&#20113;&#10;&#10;git branch -D func&#10;git push origin :func #&#21024;&#38500;&#26412;&#22320;&#21644;Git&#19978;&#30340;func&#20998;&#25903;</span><br></pre></td></tr></table></figure></p>
<p>##操作解析</p>
<p>###工作区状态<br>查看工作区操作和文件状态用命令<strong>git status</strong>.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;Untracked files: #Git&#26080;&#22788;&#29702;&#25805;&#20316;&#30340;&#25991;&#20214;&#10;&#9;&#25991;&#20214;&#21015;&#34920;:&#10;&#9;helloworld.cpp&#10;&#9;...&#10;&#10;Changes to be committed #Git&#24050;&#22788;&#29702;&#20294;&#26410;&#25552;&#20132;&#30340;&#22788;&#29702;&#25805;&#20316;&#10;&#9;&#25805;&#20316;&#21015;&#34920;:&#10;&#9;new file:   .gitignore   #&#22686;&#21152;&#25805;&#20316;&#10;&#9;new file:   Firefox_wallpaper.png&#10;&#9;deleted:    nohup.out    #&#21024;&#38500;&#25805;&#20316;&#10;&#10;nothing to commit, working directory clean #&#22788;&#29702;&#24182;&#25552;&#20132;&#23436;&#25104;,&#31561;&#24453;&#25512;&#36865;&#29366;&#24577;</span><br></pre></td></tr></table></figure></p>
<p>###筛选<br>在与.git文件夹同级的目录中新建<strong>.gitignore</strong>文件,内容自定:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.gitignore   #&#21516;&#27493;&#26102;&#24573;&#30053;.gitignore&#25991;&#20214;&#10;bin/         #&#21516;&#27493;&#26102;&#24573;&#30053;&#30446;&#24405;&#19979;&#25152;&#26377;bin&#25991;&#20214;&#22841;&#21450;&#23376;&#25991;&#20214;(&#22841;)&#10;*.class   &#9; #&#21516;&#27493;&#26102;&#24573;&#30053;&#25152;&#26377;&#21518;&#32512;&#20026;.class&#30340;&#25991;&#20214;</span><br></pre></td></tr></table></figure></p>
<p>###增<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git add -A   <span class="comment">#stages All  </span></span><br><span class="line">			 <span class="comment">#本地和Git完全同步</span></span><br><span class="line"></span><br><span class="line">git add .    <span class="comment">#stages new and modified, without deleted</span></span><br><span class="line">    		 <span class="comment">#Git只增不减,本地修改/增加文件Git同步,本地删除文件git不删除</span></span><br><span class="line"></span><br><span class="line">git add -u   <span class="comment">#stages modified and deleted, without new</span></span><br><span class="line">			 <span class="comment">#Git只减不增,本地修改/删除文件Git同步,本地新建文件Git不新建</span></span><br></pre></td></tr></table></figure></p>
<p>###删<br>主要区别在于参数<strong>–cached</strong>,本参数决定是否将本地的文件随Git一同删除<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#git rm file/path 前提是git里存在file/path</span></span><br><span class="line"></span><br><span class="line">git rm --cached  readme.txt  <span class="comment">#只删除git里的readme.txt</span></span><br><span class="line">git rm readme.txt <span class="comment">#删除本地和git里的readme.txt</span></span><br></pre></td></tr></table></figure></p>
<p>###提交<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m  &#39;This is my second modified&#39;  &#9;#-m&#21442;&#25968;&#21518;&#38754;&#26159;&#26412;&#27425;&#25552;&#20132;&#30340;&#35299;&#37322;&#20449;&#24687;,&#19981;&#38480;&#26684;&#24335;&#21487;&#26377;&#31354;&#26684;&#10;git commit -am  = git add u + git commit -m     #&#20004;&#27493;&#21512;&#24182;&#25104;&#19968;&#27493;,&#21482;&#20943;&#19981;&#22686;</span><br></pre></td></tr></table></figure></p>
<p>###对比<br>本地与Git的对比主要用<strong>git diff</strong>,该命令的使用方法非常灵活,我们只要记住原始命令,即可以查看目前本地与Git的不同处.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff&#10;git diff --stat</span><br></pre></td></tr></table></figure></p>
<p>###分支与合并<br>为保证工程的安全性和可扩展性,我们需要保持工程架构不变.Git的分支满足了这个需求,我们将工程架构放在主分支上,每调试或添加新的特性,我们都为其开辟一个分支,分支对主分支是继承关系,把主分支所有文件pull过去并添加新的特性.创建新分支的基本规则:</p>
<pre><code>* 1.创建新分支前确保主分支已经完整最新,满足新分支的基础需求.
* 2.新分支尽量减少对pull过来的主分支部分进行删改(否则合并时会处问题).
* 3.逐个添加新分支与合并,同时建多个新分支合并时容易发生冲突.
</code></pre><p>新建分支:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#26465;&#20214;:&#36828;&#31243;&#31471;test&#23384;&#22312;(&#36828;&#31243;&#31471;&#26159;&#26412;&#22320;&#21644;Git&#20132;&#20114;&#30340;&#26725;&#26753;,&#19968;&#33324;&#19968;&#20010;Git&#21482;&#38656;&#35201;&#19968;&#20010;&#36828;&#31243;&#31471;)&#10;git remote add test git@github.com/cynorr:Test.git&#10;&#10;&#10;git branch host #&#26032;&#24314;host&#20998;&#25903;&#10;git push test host #host&#20998;&#25903;&#21516;&#27493;&#21040;Git&#10;&#10;git checkout host #&#20999;&#25442;&#21040;host&#20998;&#25903;&#10;git branch    #&#26597;&#30475;&#25152;&#22312;&#20998;&#25903;&#10;&#10;git push test host #&#23545;&#26032;&#20998;&#25903;&#36827;&#34892;&#20462;&#25913;&#25805;&#20316;&#10;git branch -D host #&#21024;&#38500;&#26412;&#22320;host&#20998;&#25903;&#10;git push test :host #&#21024;&#38500;Git host&#20998;&#25903;</span><br></pre></td></tr></table></figure></p>
<p>合并:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout master #&#20999;&#25442;&#21040;&#20027;&#20998;&#25903;&#21518;&#25165;&#33021;&#36827;&#34892;&#21512;&#24182;&#10;git merge host&#10;&#10;#&#26032;&#21512;&#24182;&#21040;&#20027;&#20998;&#25903;&#21518;,&#26032;&#21518;&#20998;&#25903;&#24050;&#27809;&#29992;,&#23558;&#20854;&#21024;&#38500;&#10;git push test :host</span><br></pre></td></tr></table></figure></p>
<p>###远程库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@github.com/cynorr:Test.git #&#28155;&#21152;&#36828;&#31243;&#24211;&#10;git remote rename origin test #&#37325;&#21629;&#21517;&#36828;&#31243;&#24211;&#10;git remote -v #&#36828;&#31243;&#24211;&#35814;&#32454;&#20449;&#24687;&#10;git remote rm test #&#21024;&#38500;&#36828;&#31243;&#24211;</span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2014/02/01/Linux/Github2/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2014-01-21 </div>
			<div class="article-title"><a href="/2014/01/21/Linux/Github/" >Linux下Github的配置与使用</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="u7B80_u4ECB"><a href="#u7B80_u4ECB" class="headerlink" title="简介"></a>简介</h2><p>github是备份代码首选工具，工作机制如下:<br><img src="http://7xjfxk.com1.z0.glb.clouddn.com/github.png" alt=""></p>
<p>working dir是本地目录，HEAD是云目录，中间的index是缓存区。若要实现本地与github上同步，首先把要同步或要修改的文件或代码在缓存区（index）整理，最后统一提交（commit）到云。</p>
<h2 id="u51C6_u5907_u5DE5_u4F5C"><a href="#u51C6_u5907_u5DE5_u4F5C" class="headerlink" title="准备工作"></a>准备工作</h2><p>准备工作比较麻烦，但一劳永逸.<br><strong>1.申请帐号：<a href="https://github.com/" target="_blank" rel="external">Click Here</a></strong></p>
<ul>
<li>邮箱：cynorr@sina.com</li>
<li>用户名：sinorr</li>
</ul>
<p><strong>2.创建Repository</strong></p>
<ul>
<li>点击 <strong>New Repository</strong>  </li>
<li>创建一个名为HelloWorld的Repository。</li>
</ul>
<p><strong>3.配置SSH keys</strong><br>在本地终端下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &#34;cynorr@sina.com&#34;    #&#24341;&#21495;&#37324;&#38754;&#22635;&#20889;&#20320;&#30340;github&#37038;&#31665;&#10;&#10;Creates a new ssh key using the provided email&#10;Generating public/private rsa key pair.&#10;Enter file in which to save the key (/home/.ssh/id_rsa): #&#30452;&#25509;&#28857;&#22238;&#36710;&#10;&#10;$ Enter passphrase (empty for no passphrase):            #&#35774;&#32622;&#23494;&#30721;&#65292;&#36825;&#26159;&#20197;&#21518;&#22312;&#32456;&#31471;&#19979;&#38142;&#25509;github&#30340;&#23494;&#30721;&#10;$ Enter same passphrase again:                              &#10;&#10;$ eval  &#34;$(ssh-agent -s)&#34;           &#10;Agetn pid xxxxx   &#10;$ ssh-add ~/.ssh/id_rsa&#10;$ gedit ~/.ssh/id_rsa.pub  #&#28982;&#21518;&#25226;&#37324;&#38754;&#30340;&#20869;&#23481;&#20840;&#36873;&#65292;&#22797;&#21046;&#21040;&#21098;&#20999;&#26495;</span><br></pre></td></tr></table></figure></p>
<p>进入你的github主页,依次进入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#35774;&#32622; -&#62; SSH keys -&#62; Add SSH key</span><br></pre></td></tr></table></figure></p>
<p>标题自定，将剪切板上内容粘贴进去。</p>
<p><strong>4.全局配置</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &#34;sinorr&#34;         #&#24341;&#21495;&#37324;&#22635;&#33258;&#24049;github&#30340;&#29992;&#25143;&#21517;&#10;git config --global user.email cynorr@sina.com #&#30000;&#20889;github&#37038;&#31665;</span><br></pre></td></tr></table></figure></p>
<p>##上传文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd workspace/&#10;$ git init        #&#21021;&#22987;&#21270;&#26412;&#22320;&#25991;&#20214;&#22841;&#10;$ git add HelloWorld/      #&#23558;&#25991;&#20214;&#25918;&#21040;&#32531;&#23384;&#21306;&#12290;&#10;$ git commit -m &#39;all file&#39;  #commit&#26159;&#20174;&#32531;&#23384;&#21306;&#21040;github&#19978;&#30340;&#25805;&#20316;&#38598;&#21512;&#65292;&#20363;&#22914;&#26412;&#27425;&#30340;&#25805;&#20316;&#21482;&#26159;add HelloWorld/&#10;$ git remote add test git@github.com:sinorr/HelloWorld.git   #&#25351;&#23450;&#35201;&#23384;&#30340;Repository&#10;$ git push -u test master # &#26368;&#21518;&#19968;&#27493;&#65292;&#25191;&#34892;&#21516;&#27493;&#21629;&#20196;&#12290;</span><br></pre></td></tr></table></figure>
<p>##下载文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone git@github.com:sinorr/spider.git</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2014/01/21/Linux/Github/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2014-01-07 </div>
			<div class="article-title"><a href="/2014/01/07/Distri_Dev/HashMap/" >Java中HashMap容量与内存解析</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>##运行方式<br>首先建立默认容量大小的数组,然后对对象key哈希值做运算,映射到数组中的位置上.从key到数组位置分两步计算.第一步对key的hashcode计算得到hash,第二步将hash进一步运算得到数组位置.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int hash = hash(key.hashCode());</span><br><span class="line">static int hash(int h) &#123;</span><br><span class="line">    return useNewHash ? newHash(h) : oldHash(h);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">#newHash的只始终为false,其实上面的newHash的判断结果是oldHash.</span><br><span class="line">private static final boolean useNewHash;</span><br><span class="line">    static &#123; useNewHash = false; &#125;</span><br></pre></td></tr></table></figure></p>
<p>##扩容方式</p>
<ul>
<li>默认容量:16 (Hash最大能存储的尺寸,并不是实际数据大小)</li>
<li>最大容量:约5亿(1&lt;&lt;30)</li>
<li>默认加载因子:0.75</li>
<li>容量极限:容量x加载因子</li>
</ul>
<p>因为Hash是一种散列,所以HashMap的并不能将容量完全应用,实际的容量极限与默认容量成比例,这个比例即加载因子.当put进去的对象数量达到容量极限时,HashMap自动进行扩容.扩容首先新建原用量2倍的数组,然后对所有元素重新Hash,重新Hash所有元素非常消耗CPU资源,并且会引起线程安全问题.所以新建HashMap时必须初始化容量.</p>
<p>##初始化方法</p>
<ul>
<li><p>初始化函数:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//构造函数1</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> capacity = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (capacity &lt; initialCapacity)</span><br><span class="line">            capacity &lt;&lt;= <span class="number">1</span>;                                 <span class="comment">//容量以2的倍数增加</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.loadFactor = loadFactor;</span><br><span class="line">        threshold = (<span class="keyword">int</span>)(capacity * loadFactor); <span class="comment">//阈值</span></span><br><span class="line">        table = <span class="keyword">new</span> Entry[capacity];</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造函数2</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);  <span class="comment">//用默认的加载加载因子调用构造函数1,默认加载因子为.0.75</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>例子:<br>假设对象实际大小为size,则初始化函数为:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;...&gt; hashmap = <span class="keyword">new</span> HashMap&lt;...&gt;(size/<span class="number">0.75</span>); <span class="comment">//0.75为默认加载因子</span></span><br></pre></td></tr></table></figure>
</li>
</ul>

	
	</div>
  <a type="button" href="/2014/01/07/Distri_Dev/HashMap/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2013-09-10 </div>
			<div class="article-title"><a href="/2013/09/10/Linux/UserInLinux/" >Linux下用户管理</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>##用户增删&amp;密码管理</p>
<ul>
<li><p>root权限下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#增加用户</span></span><br><span class="line">useradd guest</span><br><span class="line">passwd guest</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除用户</span></span><br><span class="line">userdel guest</span><br></pre></td></tr></table></figure>
</li>
<li><p>普通用户权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#更改密码</span></span><br><span class="line">passwd</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>##权限管理<br><strong>赋予普通用户root权限</strong></p>
<ul>
<li><p>方法1:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">usermod -g root guest</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法2:<br>修改/etc/sudoers文件,先打开该文件,找到如下一行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root       ALL=(ALL)            ALL</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>在root下一行添加需要root权限的用户<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root       ALL=(ALL)            ALL</span><br><span class="line">guest       ALL=(ALL)            ALL</span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2013/09/10/Linux/UserInLinux/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">
<ul class="pagination">
	 
</ul>
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/catetories/Gentoo-Linux-Server/">Gentoo &amp; Linux Server<span>12</span></a></li>
		
			<li><a href="/catetories/Journal/">Journal<span>9</span></a></li>
		
			<li><a href="/catetories/主题模型/">主题模型<span>1</span></a></li>
		
			<li><a href="/catetories/云计算/">云计算<span>2</span></a></li>
		
			<li><a href="/catetories/数据结构-算法/">数据结构&amp;算法<span>2</span></a></li>
		
		</ul>
	</div>


		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/HashMap原理/" class="b">HashMap原理<span>1</span>
			</a></li>
		
			<li><a href="/tags/rsync-sersync/" class="b">rsync + sersync<span>1</span>
			</a></li>
		
			<li><a href="/tags/多态性/" class="b">多态性<span>1</span>
			</a></li>
		
			<li><a href="/tags/Gentoo-Tutorial/" class="b">Gentoo Tutorial<span>1</span>
			</a></li>
		
			<li><a href="/tags/Network/" class="b">Network<span>4</span>
			</a></li>
		
			<li><a href="/tags/Fedora/" class="b">Fedora<span>1</span>
			</a></li>
		
			<li><a href="/tags/VMware虚拟机/" class="b">VMware虚拟机<span>1</span>
			</a></li>
		
			<li><a href="/tags/hexo/" class="b">hexo<span>1</span>
			</a></li>
		
			<li><a href="/tags/用户管理/" class="b">用户管理<span>1</span>
			</a></li>
		
			<li><a href="/tags/Github/" class="b">Github<span>2</span>
			</a></li>
		
			<li><a href="/tags/GithubPages/" class="b">GithubPages<span>1</span>
			</a></li>
		
			<li><a href="/tags/ACM/" class="b">ACM<span>1</span>
			</a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2016/02/15/C/WordLadder/" ><i class="fa fa-file-o"></i>LeetCode127——WordLadder题解...</a>
      </li>
    
      <li>
        <a href="/2015/12/30/Linux/Gentoo-Troubleshooting/" ><i class="fa fa-file-o"></i>A branch of Gentoo troubles...</a>
      </li>
    
      <li>
        <a href="/2015/12/30/Journals/20151230_log/" ><i class="fa fa-file-o"></i>...</a>
      </li>
    
      <li>
        <a href="/2015/12/24/Linux/Introduction_To_Linux/" ><i class="fa fa-file-o"></i>...</a>
      </li>
    
      <li>
        <a href="/2015/12/10/Linux/Gentoo_Backup_Strategy/" ><i class="fa fa-file-o"></i>Gentoo Backup Strategy...</a>
      </li>
    
  </ul>
</div>

		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2016 张端风
  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
